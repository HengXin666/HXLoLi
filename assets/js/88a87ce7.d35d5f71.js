"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[58489],{28453:(n,t,e)=>{e.d(t,{R:()=>s,x:()=>c});var i=e(96540);const r={},d=i.createContext(r);function s(n){const t=i.useContext(d);return i.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function c(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),i.createElement(d.Provider,{value:t},n.children)}},31153:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"\u7a0b\u5e8f\u8bed\u8a00/C++/\u73b0\u4ee3C++/\u73b0\u4ee3\u6a21\u7248/CRTP-\u9759\u6001\u591a\u6001/index","title":"CRTP (\u5947\u5f02\u9012\u5f52\u6a21\u7248)","description":"\u6211\u4eec\u5e38\u8bf4\u7684\u7f16\u8bd1\u671f\u591a\u6001(\u65e0\u9700\u865a\u51fd\u6570\u8868\u3001\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u786e\u5b9a\u51fd\u6570\u8c03\u7528\u8def\u5f84\u7684\u591a\u6001\u673a\u5236), \u5b9e\u9645\u4e0a\u5c31\u662f\u57fa\u4e8eCRTP\u5b9e\u73b0\u7684, \u4e0b\u9762\u662f\u5e38\u89c1\u7684\u7f16\u8bd1\u671f\u591a\u6001\u7684\u5b9e\u73b0:","source":"@site/docs/002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/003-\u73b0\u4ee3C++/004-\u73b0\u4ee3\u6a21\u7248/001-CRTP-\u9759\u6001\u591a\u6001/index.md","sourceDirName":"002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/003-\u73b0\u4ee3C++/004-\u73b0\u4ee3\u6a21\u7248/001-CRTP-\u9759\u6001\u591a\u6001","slug":"/\u7a0b\u5e8f\u8bed\u8a00/C++/\u73b0\u4ee3C++/\u73b0\u4ee3\u6a21\u7248/CRTP-\u9759\u6001\u591a\u6001/","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/\u73b0\u4ee3C++/\u73b0\u4ee3\u6a21\u7248/CRTP-\u9759\u6001\u591a\u6001/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/003-\u73b0\u4ee3C++/004-\u73b0\u4ee3\u6a21\u7248/001-CRTP-\u9759\u6001\u591a\u6001/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1747379049000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u4f2a\u968f\u673a\u6570\u751f\u6210","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/\u73b0\u4ee3C++/\u73b0\u4ee3C++\u9879\u76ee\u5b9e\u6218/\u4f2a\u968f\u673a\u6570\u751f\u6210/"},"next":{"title":"io\u4e36uring","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/\u73b0\u4ee3C++/\u73b0\u4ee3C++\u7f51\u7edc\u7f16\u7a0b/io\u4e36uring/"}}');var r=e(74848),d=e(28453);const s={},c="CRTP (\u5947\u5f02\u9012\u5f52\u6a21\u7248)",l={},o=[];function h(n){const t={blockquote:"blockquote",code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"crtp-\u5947\u5f02\u9012\u5f52\u6a21\u7248",children:"CRTP (\u5947\u5f02\u9012\u5f52\u6a21\u7248)"})}),"\n",(0,r.jsx)(t.p,{children:"\u6211\u4eec\u5e38\u8bf4\u7684\u7f16\u8bd1\u671f\u591a\u6001(\u65e0\u9700\u865a\u51fd\u6570\u8868\u3001\u5728\u7f16\u8bd1\u9636\u6bb5\u5c31\u786e\u5b9a\u51fd\u6570\u8c03\u7528\u8def\u5f84\u7684\u591a\u6001\u673a\u5236), \u5b9e\u9645\u4e0a\u5c31\u662f\u57fa\u4e8eCRTP\u5b9e\u73b0\u7684, \u4e0b\u9762\u662f\u5e38\u89c1\u7684\u7f16\u8bd1\u671f\u591a\u6001\u7684\u5b9e\u73b0:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{style:{textAlign:"center"},children:"\u6280\u672f\u624b\u6bb5"}),(0,r.jsx)(t.th,{children:"\u9759\u6001\u591a\u6001"}),(0,r.jsx)(t.th,{children:"\u53ef\u7ec4\u5408\u5bb9\u5668"}),(0,r.jsx)(t.th,{children:"\u53ef\u5185\u8054"}),(0,r.jsx)(t.th,{children:"\u7c7b\u578b\u5b89\u5168"}),(0,r.jsx)(t.th,{children:"\u6613\u7528\u6027"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:"CRTP"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u274c(\u9700\u5c01\u88c5)"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u4e2d"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:"\u6a21\u677f\u53c2\u6570 / Duck Typing"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u274c"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u274c"}),(0,r.jsx)(t.td,{children:"\u2705"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:"Concepts"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u274c"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705(C++20)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:"std::variant + visit"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u4e2d"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:(0,r.jsx)(t.code,{children:"if constexpr"})}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u274c"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u2705"}),(0,r.jsx)(t.td,{children:"\u9ad8"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"\u5176\u4e2d, \u57fa\u4e8e\u81ea\u5b9a\u4e49\u7c7b\u7684, \u5c31\u662fCRTP:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:'#include <HXprint/print.h>\n\n/**\n * @brief \u5947\u5f02\u9012\u5f52\u6a21\u7248 (CRTF)\n * \u7528\u4e8e\u5b9e\u73b0\u9759\u6001\u591a\u6001\n */\n\ntemplate <typename T>\nstruct Man {\n    void oi() {\n        static_cast<T*>(this)->oi();\n    }\n\n    void kawaii() {\n        static_cast<T*>(this)->kawaii();\n    }\n\n    // \u94fe\u5f0f\u8c03\u7528\n    T& zzz() {\n        HX::print::print("zzz... -> ");\n        return static_cast<T&>(*this);\n    }\n};\n\nstruct LoLi : public Man<LoLi> {\n    void oi() {\n        HX::print::println("LoLi: o... o ha yo~");\n    }\n\nprivate:\n    friend struct Man<LoLi>; // \u5982\u679c\u57fa\u7c7b\u8bbf\u95ee\u7684\u4e0d\u662f\u516c\u6709\u7684, \u90a3\u4e48\u9700\u8981\u58f0\u660e\u4e3a\u53cb\u5143\n\n    void kawaii() {\n        HX::print::println("LoLi: hei hei hei~");\n    }\n};\n\nstruct Imouto : public Man<Imouto> {\n    void oi() {\n        HX::print::println("Imouto: o ha yo~ o ni tya~");\n    }\n\nprivate:\n    friend struct Man<Imouto>;\n\n    void kawaii() {\n        HX::print::println("Imouto: mu kyu~");\n    }\n};\n\n/**\n * @brief \u4f7f\u7528\u793a\u4f8b: \u9759\u6001\u591a\u6001\n * @tparam T \n * @param man \n */\ntemplate <typename T>\nvoid greet(Man<T>& man) {\n    man.zzz().oi();\n    man.kawaii();\n}\n\nint main() {\n    LoLi loli{};\n    Imouto imouto{};\n    greet(loli);\n    greet(imouto);\n    return 0;\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"\u4e0a\u9762\u5c55\u73b0\u4e86\u4e09\u79cd\u60c5\u51b5,"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"\u666e\u901a\u591a\u6001\u8c03\u7528"}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"\u5bf9\u4e8e\u975e\u516c\u6709\u7684\u65b9\u6cd5\u591a\u6001\u8c03\u7528"}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsx)(t.p,{children:"\u94fe\u5f0f\u8c03\u7528"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["\u574f\u5904\u5c31\u662f\u5982\u679c\u4f60\u5e0c\u671b\u7edf\u4e00\u5b58\u50a8\u4e3a ",(0,r.jsx)(t.code,{children:"std::vector<T>"})," \u8fd9\u79cd, \u5176\u4e2d ",(0,r.jsx)(t.code,{children:"[T = \u57fa\u7c7b]"}),", \u662f\u4e0d\u884c\u7684..."]}),"\n",(0,r.jsxs)(t.p,{children:["\u8981\u4e48\u5c31\u7528 ",(0,r.jsx)(t.code,{children:"std::variant"})," (\u4f46\u662f\u7834\u574f\u4e86\u5f00\u95ed\u539f\u5219), \u8981\u4e48\u5c31\u53ea\u80fd\u641e\u8fd0\u884c\u65f6\u591a\u6001\u4e86 (\u518d\u641e\u4e2a\u865a\u57fa\u7c7b\u3001\u7528 ",(0,r.jsx)(t.code,{children:"std::Any"})," \u4ec0\u4e48\u7684)"]}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"\u603b\u4e4b\u5c31\u662f\u8fd8\u662f\u6709\u70b9\u5c40\u9650\u7684~"}),"\n"]})]})}function a(n={}){const{wrapper:t}={...(0,d.R)(),...n.components};return t?(0,r.jsx)(t,{...n,children:(0,r.jsx)(h,{...n})}):h(n)}}}]);