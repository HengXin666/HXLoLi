"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[40623],{28453:(n,e,i)=>{i.d(e,{R:()=>t,x:()=>l});var s=i(96540);const d={},a=s.createContext(d);function t(n){const e=s.useContext(a);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:t(n.components),s.createElement(a.Provider,{value:e},n.children)}},77010:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>r,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"\u5237\u9898\u65e5\u5fd7/MySQL\u5237\u9898/\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf/index","title":"601. \u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf","description":"\u539f\u9898: 601. \u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf","source":"@site/docs/007-\u5237\u9898\u65e5\u5fd7/006-MySQL\u5237\u9898/005-\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf/index.md","sourceDirName":"007-\u5237\u9898\u65e5\u5fd7/006-MySQL\u5237\u9898/005-\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf","slug":"/\u5237\u9898\u65e5\u5fd7/MySQL\u5237\u9898/\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf/","permalink":"/HXLoLi/docs/\u5237\u9898\u65e5\u5fd7/MySQL\u5237\u9898/\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/007-\u5237\u9898\u65e5\u5fd7/006-MySQL\u5237\u9898/005-\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1745851959000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u6e38\u620f\u73a9\u6cd5\u5206\u6790IV","permalink":"/HXLoLi/docs/\u5237\u9898\u65e5\u5fd7/MySQL\u5237\u9898/\u6e38\u620f\u73a9\u6cd5\u5206\u6790IV/"},"next":{"title":"\u597d\u53cb\u7533\u8bf7II\uff1a\u8c01\u6709\u6700\u591a\u7684\u597d\u53cb","permalink":"/HXLoLi/docs/\u5237\u9898\u65e5\u5fd7/MySQL\u5237\u9898/\u597d\u53cb\u7533\u8bf7II\uff1a\u8c01\u6709\u6700\u591a\u7684\u597d\u53cb/"}}');var d=i(74848),a=i(28453);const t={},l="601. \u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf",r={},c=[{value:"\u6211\u7684\u516b\u560e\u4ee3\u7801",id:"\u6211\u7684\u516b\u560e\u4ee3\u7801",level:2},{value:"\u6b63\u89e3",id:"\u6b63\u89e3",level:2}];function o(n){const e={a:"a",code:"code",del:"del",div:"div",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"601-\u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf",children:"601. \u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf"})}),"\n",(0,d.jsxs)(e.p,{children:["\u539f\u9898: ",(0,d.jsx)(e.a,{href:"https://leetcode.cn/problems/human-traffic-of-stadium/description/",children:"601. \u4f53\u80b2\u9986\u7684\u4eba\u6d41\u91cf"})]}),"\n",(0,d.jsx)(e.p,{children:"\u56f0\u96be"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"\u8868\uff1aStadium\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| id            | int     |\n| visit_date    | date    |\n| people        | int     |\n+---------------+---------+\nvisit_date \u662f\u8be5\u8868\u4e2d\u5177\u6709\u552f\u4e00\u503c\u7684\u5217\u3002\n\u6bcf\u65e5\u4eba\u6d41\u91cf\u4fe1\u606f\u88ab\u8bb0\u5f55\u5728\u8fd9\u4e09\u5217\u4fe1\u606f\u4e2d\uff1a\u5e8f\u53f7 (id)\u3001\u65e5\u671f (visit_date)\u3001 \u4eba\u6d41\u91cf (people)\n\u6bcf\u5929\u53ea\u6709\u4e00\u884c\u8bb0\u5f55\uff0c\u65e5\u671f\u968f\u7740 id \u7684\u589e\u52a0\u800c\u589e\u52a0\n \n\n\u7f16\u5199\u89e3\u51b3\u65b9\u6848\u627e\u51fa\u6bcf\u884c\u7684\u4eba\u6570\u5927\u4e8e\u6216\u7b49\u4e8e 100 \u4e14 id \u8fde\u7eed\u7684\u4e09\u884c\u6216\u66f4\u591a\u884c\u8bb0\u5f55\u3002\n\n\u8fd4\u56de\u6309 visit_date \u5347\u5e8f\u6392\u5217 \u7684\u7ed3\u679c\u8868\u3002\n\n\u67e5\u8be2\u7ed3\u679c\u683c\u5f0f\u5982\u4e0b\u6240\u793a\u3002\n\n \n\n\u793a\u4f8b 1:\n\n\u8f93\u5165\uff1a\nStadium \u8868:\n+------+------------+-----------+\n| id   | visit_date | people    |\n+------+------------+-----------+\n| 1    | 2017-01-01 | 10        |\n| 2    | 2017-01-02 | 109       |\n| 3    | 2017-01-03 | 150       |\n| 4    | 2017-01-04 | 99        |\n| 5    | 2017-01-05 | 145       |\n| 6    | 2017-01-06 | 1455      |\n| 7    | 2017-01-07 | 199       |\n| 8    | 2017-01-09 | 188       |\n+------+------------+-----------+\n\u8f93\u51fa\uff1a\n+------+------------+-----------+\n| id   | visit_date | people    |\n+------+------------+-----------+\n| 5    | 2017-01-05 | 145       |\n| 6    | 2017-01-06 | 1455      |\n| 7    | 2017-01-07 | 199       |\n| 8    | 2017-01-09 | 188       |\n+------+------------+-----------+\n\u89e3\u91ca\uff1a\nid \u4e3a 5\u30016\u30017\u30018 \u7684\u56db\u884c id \u8fde\u7eed\uff0c\u5e76\u4e14\u6bcf\u884c\u90fd\u6709 >= 100 \u7684\u4eba\u6570\u8bb0\u5f55\u3002\n\u8bf7\u6ce8\u610f\uff0c\u5373\u4f7f\u7b2c 7 \u884c\u548c\u7b2c 8 \u884c\u7684 visit_date \u4e0d\u662f\u8fde\u7eed\u7684\uff0c\u8f93\u51fa\u4e5f\u5e94\u5f53\u5305\u542b\u7b2c 8 \u884c\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651 id \u8fde\u7eed\u7684\u8bb0\u5f55\u3002\n\u4e0d\u8f93\u51fa id \u4e3a 2 \u548c 3 \u7684\u884c\uff0c\u56e0\u4e3a\u81f3\u5c11\u9700\u8981\u4e09\u6761 id \u8fde\u7eed\u7684\u8bb0\u5f55\u3002\n"})}),"\n",(0,d.jsx)(e.h1,{id:"\u9898\u89e3",children:"\u9898\u89e3"}),"\n",(0,d.jsx)(e.h2,{id:"\u6211\u7684\u516b\u560e\u4ee3\u7801",children:"\u6211\u7684\u516b\u560e\u4ee3\u7801"}),"\n",(0,d.jsxs)(e.p,{children:["\u76f4\u63a5\u66b4\u529b \u5217\u8f6c\u884c(\u6ee1\u8db3\u4eba\u6570 \u4e14 id - 1 == id(\u4e3b) == id + 1), \u884c\u53c8\u8f6c\u5217(",(0,d.jsx)(e.del,{children:"\u4e00\u884cmysql\u5440~\u76f4\u63a5\u5f00\u9664!"}),")"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["\u5b66\u5230\u4e86: ",(0,d.jsx)(e.a,{href:"https://blog.csdn.net/weter_drop/article/details/105899362",children:"\u4e00\u7bc7\u6587\u7ae0\u89e3\u6790mysql\u7684 \u884c\u8f6c\u5217\uff087\u79cd\u65b9\u6cd5\uff09 \u548c \u5217\u8f6c\u884c"})]}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"SELECT \n    aa.aid as id,\n    aa.avisit_date AS visit_date,\n    aa.apeople AS people \nFROM \n    (\n    select\n        b.id as aid,\n        b.visit_date as avisit_date,\n        b.people as apeople,\n        c.id as bid,\n        c.visit_date as bvisit_date,\n        c.people as bpeople,\n        d.id as cid,\n        d.visit_date as cvisit_date,\n        d.people as cpeople\n    from\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as b\n    join\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as c\n    on\n        b.id + 1 = c.id\n    join\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as d\n    on\n        c.id + 1 = d.id\n) as aa\nUNION \nSELECT\n    bb.bid as id,\n    bb.bvisit_date AS visit_date,\n    bb.bpeople AS people \nFROM \n    (\n    select\n        b.id as aid,\n        b.visit_date as avisit_date,\n        b.people as apeople,\n        c.id as bid,\n        c.visit_date as bvisit_date,\n        c.people as bpeople,\n        d.id as cid,\n        d.visit_date as cvisit_date,\n        d.people as cpeople\n    from\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as b\n    join\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as c\n    on\n        b.id + 1 = c.id\n    join\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as d\n    on\n        c.id + 1 = d.id\n    ) as bb\nUNION \nSELECT\n    cc.cid as id,\n    cc.cvisit_date AS visit_date,\n    cc.cpeople AS people \nFROM \n    (\n    select\n        b.id as aid,\n        b.visit_date as avisit_date,\n        b.people as apeople,\n        c.id as bid,\n        c.visit_date as bvisit_date,\n        c.people as bpeople,\n        d.id as cid,\n        d.visit_date as cvisit_date,\n        d.people as cpeople\n    from\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as b\n    join\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as c\n    on\n        b.id + 1 = c.id\n    join\n        (\n        select\n            a.*\n        from\n            Stadium as a\n        where\n            a.people >= 100\n        ) as d\n    on\n        c.id + 1 = d.id\n) as cc\nORDER BY id;\n"})}),"\n",(0,d.jsxs)(e.div,{style:{marginTop:"80px"},children:["\n",(0,d.jsx)(e.hr,{}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"\u6b63\u89e3",children:"\u6b63\u89e3"}),"\n",(0,d.jsxs)(e.p,{children:["\u94fe\u63a5 ",(0,d.jsx)(e.a,{href:"https://leetcode.cn/problems/human-traffic-of-stadium/solutions/701681/tu-jie-lian-xu-ri-qi-ji-nan-dian-fen-xi-xnj58/",children:"\u56fe\u89e3\u2014\u2014\u8fde\u7eed\u65e5\u671f\u53ca\u96be\u70b9\u5206\u6790"})]}),"\n",(0,d.jsxs)(e.p,{children:["\u5728\u516c\u53f8\u7528",(0,d.jsx)(e.code,{children:"hive"}),"\u5e38\u4f1a\u7528\u5230\u8fd9\u89e3\u6cd5\uff0c\u6709\u65f6\u5019\u4f1a\u5728\u4e34\u65f6\u8868\u91cc\u518d\u591a\u91cd\u5d4c\u5957"]}),"\n",(0,d.jsxs)(e.p,{children:["\u8fd9\u9053\u9898\u9700\u8981\u63d0\u524d\u7528",(0,d.jsx)(e.code,{children:"With"}),"\u4e34\u65f6\u7a7a\u95f4\uff0c\u662f\u56e0\u4e3a",(0,d.jsx)(e.code,{children:"where"}),"\u5b50\u53e5\u4e2d\u9700\u8981\u518d\u6b21\u8c03\u7528",(0,d.jsx)(e.code,{children:"from"}),"\u4e2d\u9009\u53d6\u7684\u8868"]}),"\n",(0,d.jsx)(e.p,{children:"\u8fd9\u91cc\u518d\u804a\u4e00\u4e0bsql\u7684\u8fd0\u884c\u987a\u5e8f\uff1a"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"from -> where -> group by -> select -> order by -> limit"}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5373\u4e34\u65f6\u8868",(0,d.jsx)(e.code,{children:"t1"}),"\u9700\u8981\u518d",(0,d.jsx)(e.code,{children:"from"}),"\u548c",(0,d.jsx)(e.code,{children:"where"}),"\u4e2d\u90fd\u7528\u5230\u56e0\u6b64\u9700\u8981\u63d0\u524d\u5b9a\u4e49"]}),"\n",(0,d.jsx)(e.p,{children:"\u5929\u624d!:"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"with t1 as(\n    select\n        *,\n        id - row_number() over(order by id) as rk -- \u5148\u6ee1\u8db3people >= 100\u518d\u6807\u4e0a\u5e8f\u53f7\n    from stadium\n    where people >= 100\n)\n\nselect id,visit_date,people\nfrom t1\nwhere rk in(\n    select rk\n    from t1\n    group by rk -- \u6309\u7167\u5e8f\u53f7\u5206\u7ec4, (\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u5206\u7ec4, \u56e0\u4e3a\u76f8\u5dee\u76f8\u540c(\u89c1\u4e0b\u9762))\n    having count(rk) >= 3 -- \u5927\u4e8e\u4e09\u4e2a\n)\n\n-- \u4f5c\u8005\uff1a\u5b87\u822a\u5458\n-- \u94fe\u63a5\uff1ahttps://leetcode.cn/problems/human-traffic-of-stadium/solutions/701681/tu-jie-lian-xu-ri-qi-ji-nan-dian-fen-xi-xnj58/\n-- \u6765\u6e90\uff1a\u529b\u6263\uff08LeetCode\uff09\n-- \u8457\u4f5c\u6743\u5f52\u4f5c\u8005\u6240\u6709\u3002\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005\u83b7\u5f97\u6388\u6743\uff0c\u975e\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\u3002\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u793a\u4f8b"}),"\n",(0,d.jsx)(e.p,{children:"\u8f93\u5165:"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"| id | visit_date | people |\n| -- | ---------- | ------ |\n| 1  | 2017-01-01 | 10     |\n| 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    |\n| 4  | 2017-01-04 | 999    |\n| 5  | 2017-01-05 | 0      |\n| 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-09 | 188    |\n| 9  | 2024-03-14 | 100    |\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u4ee3\u7801:"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"select \n    *, \n    id as `|`, \n    row_number() over(order by id) as c ,\n    id - row_number() over(order by id) as rk\nfrom stadium\nwhere people >= 100\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u5f97:"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-sql",children:"| id | visit_date | people | | | c | rk |\n| -- | ---------- | ------ | - | - | -- |\n| 2  | 2017-01-02 | 109    | 2 | 1 | 1  |\n| 3  | 2017-01-03 | 150    | 3 | 2 | 1  |\n| 4  | 2017-01-04 | 999    | 4 | 3 | 1  |\n| 6  | 2017-01-06 | 1455   | 6 | 4 | 2  |\n| 7  | 2017-01-07 | 199    | 7 | 5 | 2  |\n| 8  | 2017-01-09 | 188    | 8 | 6 | 2  |\n| 9  | 2024-03-14 | 100    | 9 | 7 | 2  |\n"})})]})}function p(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(o,{...n})}):o(n)}}}]);