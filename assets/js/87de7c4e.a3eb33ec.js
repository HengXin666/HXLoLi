"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[5606],{28453:(n,e,i)=>{i.d(e,{R:()=>s,x:()=>o});var t=i(96540);const r={},a=t.createContext(r);function s(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),t.createElement(a.Provider,{value:e},n.children)}},36723:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"\u5237\u9898\u65e5\u5fd7/\u84dd\u6865\u676f/\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/I\u9898\u666f\u533a\u5bfc\u6e38/index","title":"\u666f\u533a\u5bfc\u6e38","description":"\u9898\u76ee: \u666f\u533a\u5bfc\u6e38","source":"@site/docs/007-\u5237\u9898\u65e5\u5fd7/004-\u84dd\u6865\u676f/003-\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/006-I\u9898\u666f\u533a\u5bfc\u6e38/index.md","sourceDirName":"007-\u5237\u9898\u65e5\u5fd7/004-\u84dd\u6865\u676f/003-\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/006-I\u9898\u666f\u533a\u5bfc\u6e38","slug":"/\u5237\u9898\u65e5\u5fd7/\u84dd\u6865\u676f/\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/I\u9898\u666f\u533a\u5bfc\u6e38/","permalink":"/HXLoLi/docs/\u5237\u9898\u65e5\u5fd7/\u84dd\u6865\u676f/\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/I\u9898\u666f\u533a\u5bfc\u6e38/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/007-\u5237\u9898\u65e5\u5fd7/004-\u84dd\u6865\u676f/003-\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/006-I\u9898\u666f\u533a\u5bfc\u6e38/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1745851959000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"G\u9898\u5b50\u4e32\u7b80\u5199","permalink":"/HXLoLi/docs/\u5237\u9898\u65e5\u5fd7/\u84dd\u6865\u676f/\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/G\u9898\u5b50\u4e32\u7b80\u5199/"},"next":{"title":"E\u9898X\u8fdb\u5236\u51cf\u6cd5","permalink":"/HXLoLi/docs/\u5237\u9898\u65e5\u5fd7/\u84dd\u6865\u676f/\u84dd\u6865\u676f\u7701\u8d5bB\u7ec4/E\u9898X\u8fdb\u5236\u51cf\u6cd5/"}}');var r=i(74848),a=i(28453);const s={},o="\u666f\u533a\u5bfc\u6e38",c={},d=[];function l(n){const e={a:"a",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u666f\u533a\u5bfc\u6e38",children:"\u666f\u533a\u5bfc\u6e38"})}),"\n",(0,r.jsxs)(e.p,{children:["\u9898\u76ee: ",(0,r.jsx)(e.a,{href:"https://dashoj.com/d/lqbproblem/p/68",children:"\u666f\u533a\u5bfc\u6e38"})]}),"\n",(0,r.jsxs)(e.p,{children:["\u6811\u4e0a\u500d\u589e (\u6700\u8fd1\u516c\u5171\u7956\u5148\u95ee\u9898 ",(0,r.jsx)(e.code,{children:"pa[][]"}),"\u7684\u63a8\u5bfc\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u9898: ",(0,r.jsx)(e.a,{href:"https://leetcode.cn/problems/kth-ancestor-of-a-tree-node/description/",children:"1483. \u6811\u8282\u70b9\u7684\u7b2c K \u4e2a\u7956\u5148 - \u529b\u6263\uff08LeetCode\uff09"})," (\u518d\u4e0d\u6d4e\u53ef\u4ee5\u770b\u770b",(0,r.jsx)(e.a,{href:"https://leetcode.cn/problems/kth-ancestor-of-a-tree-node/solutions/2305895/mo-ban-jiang-jie-shu-shang-bei-zeng-suan-v3rw/",children:"\u3010\u6a21\u677f\u8bb2\u89e3\u3011\u6811\u4e0a\u500d\u589e\u7b97\u6cd5\uff08\u4ee5\u53ca\u6700\u8fd1\u516c\u5171\u7956\u5148\uff09Python/Java/C++/Go"}),"))"]}),"\n",(0,r.jsxs)(e.p,{children:["\u7136\u540e\u5c31\u662f\u628a \u5355\u7eaf\u7684 ",(0,r.jsx)(e.code,{children:"(\u7956\u5148)"})," \u62d3\u5c55\u4e3a ",(0,r.jsx)(e.code,{children:"(\u7956\u5148, \u672c\u8282\u70b9\u5230\u7956\u5148\u7684\u8ddd\u79bb)"}),"\u5373\u53ef"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8fd9\u91cc\u63d0\u4ea4\u4e0d\u8fc7, \u6211\u5728",(0,r.jsx)(e.a,{href:"https://www.dotcpp.com/oj/problem3156.html",children:"\u84dd\u6865\u676f2023\u5e74\u7b2c\u5341\u56db\u5c4a\u7701\u8d5b\u771f\u9898-\u666f\u533a\u5bfc\u6e38 - C\u8bed\u8a00\u7f51 (dotcpp.com)"}),"\u63d0\u4ea4\u662f\u6ca1\u95ee\u9898\u7684!\ud83d\ude04"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-cpp",children:'#include <cstdio>\n#include <vector>\n#include <tuple>\n#include <queue>\n#include <utility>\n#include <functional>\n\nusing namespace std;\n\nusing ll = long long;\n\n// \u83b7\u53d6\u4e8c\u8fdb\u5236\u4f4d\u6570 \nint getBit(int x) {\n    int res = 0;\n    while (x) {\n        ++res;\n        x >>= 1;\n    }\n    return res;\n}\n\nint main() {\n    int n, k;\n    scanf("%d %d", &n, &k);\n    int nBit = getBit(n);\n    vector<vector<pair<int, int>>> pa(n, vector<pair<int, int>>(nBit, make_pair(-1, -1)));\n    vector<int> hArr(n, 0); // \u6df1\u5ea6 \n    vector<vector<pair<int, int>>> G(n); // [u][v, w]\n    for (int i = 1; i < n; ++i) {\n        int u, v, w;\n        scanf("%d %d %d", &u, &v, &w);\n        --u, --v; // \u6620\u5c04\u5230\u7d22\u5f15 \n        G[u].push_back(make_pair(v, w));\n        G[v].push_back(make_pair(u, w));\n    }\n    \n    // \u9884\u5904\u7406\n    function<void(int, int, int)> dfs = [&](int i, int p, int pw) {\n        pa[i][0] = make_pair(p, pw);\n        \n        for (auto& it : G[i]) {\n            int v, w;\n            tie(v, w) = it;\n            if (v != p) {\n                hArr[v] = hArr[i] + 1;\n                dfs(v, i, w);\n            }\n        }\n    };\n    \n    // tmd \u6839\u662ftm\u7684\u8ab0?! (\u5148\u5047\u8bbe\u662f0) (\u597d\u50cf\u662f\u8ab0\u65e0\u6240\u8c13?)\n    dfs(0, -1, -1);\n    \n    // dp \u8ba1\u7b97\u6240\u6709\u8282\u70b9\u76842^b\u4e2a\u7956\u5148\u7ed3\u70b9 \u4ee5\u53ca\u5230\u8fbe\u4ed6\u4eec\u7684\u6743 \n    for (int b = 1; b < nBit; ++b) {\n        for (int i = 0; i < n; ++i) {\n            int v1, v2, w1, w2;\n            tie(v1, w1) = pa[i][b - 1];\n            if (v1 != -1) {\n                tie(v2, w2) = pa[v1][b - 1];\n                pa[i][b] = make_pair(v2, w1 + w2);\n            }\n        }\n    }\n    \n    function<ll(int, int)> lac = [&](int a, int b) {\n        if (hArr[a] < hArr[b]) { // \u4fdd\u8bc1 a \u662f\u6839\u6df1\u7684\u7ed3\u70b9 \n            int tmp = a;\n            a = b;\n            b = tmp;\n        }\n        \n        ll res = 0;\n        int h = hArr[a] - hArr[b], bitH = 0;\n\n        // \u73b0\u5728 \u628a a \u5411\u4e0a\u79fb\u52a8 hArr[a] - hArr[b] \u4e2a\u8ddd\u79bb, \u4fdd\u8bc1 ab \u5904\u4e8e\u540c\u4e00\u5c42\n        while (h) {\n            if (h & 1) {\n                int new_a, new_w;\n                tie(new_a, new_w) = pa[a][bitH];\n                if (new_a == -1)\n                    break;\n                res += new_w;\n                a = new_a;\n            }\n            ++bitH;\n            h >>= 1;\n        }\n\n        if (a == b) { // a \u7684\u6700\u8fd1\u7956\u5148\u662f b ! \n            return res;\n        }\n        \n        // \u4e8c\u5206\u8df3\n        for (int t = pa[a].size() - 1; t >= 0; --t) {\n            int av, aw, bv, bw;\n            tie(av, aw) = pa[a][t];\n            tie(bv, bw) = pa[b][t];\n            if (av != bv) {\n                a = av;\n                b = bv;\n                res += (aw + bw);\n            }\n        }\n        int av, aw, bv, bw;\n        tie(av, aw) = pa[a][0];\n        tie(bv, bw) = pa[b][0];\n        return res + aw + bw;\n    };\n    \n    // \u6211\u8fdb\u884c\u8be2\u95ee\n    ll sum = 0; // \u603b\u8ddd\u79bb \n    vector<int> arr(k);\n    \n    for (int i = 0; i < k; ++i) {\n        scanf("%d", &arr[i]);\n        --arr[i];\n        if (i > 0)\n            sum += lac(arr[i - 1], arr[i]);\n    }\n    \n    for (int i = 0; i < k; ++i) {\n        if (i == 0) {\n            printf("%lld ", sum - lac(arr[0], arr[1]));\n        } else if (i == k - 1) {\n            printf("%lld ", sum - lac(arr[i - 1], arr[i]));\n        } else { \n            // a -> b -> c -> d\n            // a -> c -> d (\u51cf\u53bb\u4e86-> b ->, \u52a0\u4e0a\u4e86 a->c)\n            printf("%lld ", sum - lac(arr[i - 1], arr[i]) \n                                - lac(arr[i], arr[i + 1]) \n                                + lac(arr[i - 1], arr[i + 1])\n            );\n        }\n    }\n    \n    return 0;\n}\n'})})]})}function p(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}}}]);