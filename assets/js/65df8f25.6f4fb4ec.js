"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[36883],{8213:(t,a,e)=>{e.r(a),e.d(a,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"\u7a0b\u5e8f\u8bed\u8a00/Java/Java\u57fa\u7840/\u7f51\u7edc\u7f16\u7a0b/\u6570\u636e\u62a5Datagram/index","title":"\u6570\u636e\u62a5Datagram","description":"\u4ec0\u4e48\u662f\u6570\u636e\u62a5","source":"@site/docs/002-\u7a0b\u5e8f\u8bed\u8a00/002-Java/002-Java\u57fa\u7840/014-\u7f51\u7edc\u7f16\u7a0b/003-\u6570\u636e\u62a5Datagram/index.md","sourceDirName":"002-\u7a0b\u5e8f\u8bed\u8a00/002-Java/002-Java\u57fa\u7840/014-\u7f51\u7edc\u7f16\u7a0b/003-\u6570\u636e\u62a5Datagram","slug":"/\u7a0b\u5e8f\u8bed\u8a00/Java/Java\u57fa\u7840/\u7f51\u7edc\u7f16\u7a0b/\u6570\u636e\u62a5Datagram/","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/Java/Java\u57fa\u7840/\u7f51\u7edc\u7f16\u7a0b/\u6570\u636e\u62a5Datagram/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/002-\u7a0b\u5e8f\u8bed\u8a00/002-Java/002-Java\u57fa\u7840/014-\u7f51\u7edc\u7f16\u7a0b/003-\u6570\u636e\u62a5Datagram/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1745851959000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u5957\u63a5\u5b57Socket","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/Java/Java\u57fa\u7840/\u7f51\u7edc\u7f16\u7a0b/\u5957\u63a5\u5b57Socket/"},"next":{"title":"\u7ec3\u4e60","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/Java/Java\u57fa\u7840/\u7f51\u7edc\u7f16\u7a0b/\u7ec3\u4e60/"}}');var r=e(74848),c=e(28453);const i={},o="\u6570\u636e\u62a5Datagram",s={},d=[{value:"\u4ec0\u4e48\u662f\u6570\u636e\u62a5",id:"\u4ec0\u4e48\u662f\u6570\u636e\u62a5",level:2},{value:"\u5982\u4f55\u4f7f\u7528Datagram",id:"\u5982\u4f55\u4f7f\u7528datagram",level:2},{value:"DatagramSocket\u5e38\u7528\u6784\u9020\u65b9\u6cd5",id:"datagramsocket\u5e38\u7528\u6784\u9020\u65b9\u6cd5",level:3},{value:"DatagramSocket\u5e38\u7528\u65b9\u6cd5",id:"datagramsocket\u5e38\u7528\u65b9\u6cd5",level:3},{value:"DatagramPacket\u5e38\u7528\u6784\u9020\u65b9\u6cd5",id:"datagrampacket\u5e38\u7528\u6784\u9020\u65b9\u6cd5",level:3},{value:"DatagramPacket\u5e38\u7528\u65b9\u6cd5",id:"datagrampacket\u5e38\u7528\u65b9\u6cd5",level:3}];function l(t){const a={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,c.R)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"\u6570\u636e\u62a5datagram",children:"\u6570\u636e\u62a5Datagram"})}),"\n",(0,r.jsx)(a.h2,{id:"\u4ec0\u4e48\u662f\u6570\u636e\u62a5",children:"\u4ec0\u4e48\u662f\u6570\u636e\u62a5"}),"\n",(0,r.jsxs)(a.blockquote,{children:["\n",(0,r.jsx)(a.p,{children:"\u6570\u636e\u62a5\u662f\u901a\u8fc7\u7f51\u7edc\u53d1\u9001\u7684\u72ec\u7acb\u7684\u81ea\u5305\u542b\u7684\u6d88\u606f\uff0c\u5176\u662f\u5426\u5230\u8fbe\u3001\u5230\u8fbe\u65f6\u95f4\u548c\u5185\u5bb9\u65e0\u6cd5\u5f97\u5230\u4fdd\u8bc1\u3002"}),"\n",(0,r.jsxs)(a.p,{children:["\u5373",(0,r.jsx)(a.code,{children:"UDP"})]}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"\u5982\u4f55\u4f7f\u7528datagram",children:"\u5982\u4f55\u4f7f\u7528Datagram"}),"\n",(0,r.jsx)(a.h3,{id:"datagramsocket\u5e38\u7528\u6784\u9020\u65b9\u6cd5",children:"DatagramSocket\u5e38\u7528\u6784\u9020\u65b9\u6cd5"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"// \u6784\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u5728\u4efb\u610f\u7aef\u53e3\u7684\u6536\u53d1\u6570\u636e\u62a5\u7684\u5957\u63a5\u5b57\npublic DatagramSocket() throws SocketException;\n// \u6784\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u5728\u7ed9\u5b9a\u7aef\u53e3\u7684\u6536\u53d1\u6570\u636e\u62a5\u7684\u5957\u63a5\u5b57\npublic DatagramSocket(int port) throws SocketException;\n"})}),"\n",(0,r.jsx)(a.h3,{id:"datagramsocket\u5e38\u7528\u65b9\u6cd5",children:"DatagramSocket\u5e38\u7528\u65b9\u6cd5"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"// \u53d1\u9001\u7ed9\u5b9a\u7684\u6570\u636e\u5305\npublic void send(DatagramPacket p) throws IOException;\n// \u63a5\u6536\u6570\u636e\u81f3\u7ed9\u5b9a\u7684\u6570\u636e\u5305\npublic synchronized void receive(DatagramPacket p) throws IOException;\n// \u8bbe\u7f6e\u94fe\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c0\u8868\u793a\u4e0d\u4f1a\u8d85\u65f6\npublic synchronized void setSoTimeout(int timeout) throws SocketException;\n"})}),"\n",(0,r.jsx)(a.h3,{id:"datagrampacket\u5e38\u7528\u6784\u9020\u65b9\u6cd5",children:"DatagramPacket\u5e38\u7528\u6784\u9020\u65b9\u6cd5"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"// \u6784\u5efa\u4e00\u4e2a\u63a5\u6536\u6570\u636e\u7684\u6570\u636e\u5305\npublic DatagramPacket(byte buf[], int length);\n// \u6784\u5efa\u4e00\u4e2a\u53d1\u9001\u6570\u636e\u7684\u6570\u636e\u5305\npublic DatagramPacket(byte buf[], int offset, int length,InetAddress address, int port);\n"})}),"\n",(0,r.jsx)(a.h3,{id:"datagrampacket\u5e38\u7528\u65b9\u6cd5",children:"DatagramPacket\u5e38\u7528\u65b9\u6cd5"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"// \u83b7\u53d6\u53d1\u9001\u6570\u636e\u7684\u4e3b\u673aIP\u5730\u5740\npublic synchronized InetAddress getAddress();\n// \u83b7\u53d6\u53d1\u9001\u6570\u636e\u7684\u4e3b\u673a\u4f7f\u7528\u7684\u7aef\u53e3\npublic synchronized int getPort();\n// \u83b7\u53d6\u6570\u636e\u5305\u4e2d\u6570\u636e\u7684\u957f\u5ea6\npublic synchronized int getLength();\n"})}),"\n",(0,r.jsx)(a.p,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'package datagram;\n\nimport java.io.IOException;\nimport java.net.*;\n\n/**\n * UDP\u5de5\u5177\u7c7b\n */\npublic class DatagtamUtil {\n    private static final int PACKET_MAX_SIZE = 8192;\n\n    /**\n     * \u63a5\u6536\u6570\u636e\u5305\n     * @param socket \u63a5\u6536\u7684\u5957\u63a5\u5b57\n     * @return UDP\u6570\u636e\u5305\n     */\n    public static DatagramPacket recv(DatagramSocket socket) {\n        byte[] data = new byte[DatagtamUtil.PACKET_MAX_SIZE];\n        DatagramPacket packet = new DatagramPacket(data, data.length);\n        try {\n            socket.receive(packet);\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n        return packet;\n    }\n\n    /**\n     * \u53d1\u9001\u6570\u636e\u5305\n     * @param socket \u6570\u636e\u62a5\u5957\u63a5\u5b57\n     * @param msg \u6d88\u606f\n     * @param ip \u76ee\u6807ip\n     * @param port \u76ee\u6807\u7aef\u53e3\n     */\n    public static void send(DatagramSocket socket, String msg, String ip, int port) throws IOException {\n        byte[] data = msg.getBytes();\n        InetAddress address = InetAddress.getByName(ip);\n        // \u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5305\u7528\u4e8e\u53d1\u9001\n        DatagramPacket packet = new DatagramPacket(data, 0, data.length, address, port);\n        socket.send(packet);\n    }\n}\n\npackage datagram;\n\nimport java.io.IOException;\nimport java.net.DatagramPacket;\nimport java.net.DatagramSocket;\nimport java.net.SocketException;\n\npublic class Ser {\n    public static void main(String[] args) { // \u6d4b\u8bd5\u4f7f\u7528\n        try {\n            Ser ser = new Ser(6666);\n            ser.run();\n        } catch (SocketException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    private DatagramSocket serSocket;\n\n    Ser(int port) throws SocketException {\n        this.serSocket = new DatagramSocket(port);\n    }\n\n    public void run() {\n        while (true) {\n            // \u63a5\u6536\n            DatagramPacket packet = DatagtamUtil.recv(this.serSocket);\n            System.out.println("\u6536\u5230\u6765\u81ea " + packet.getAddress().toString() + " \u7684\u6570\u636e: " + (new String(packet.getData(), 0, packet.getLength())));\n\n            // \u56de\u58f0\n            try {\n                DatagtamUtil.send(this.serSocket, "\u60a8\u597d, \u6211\u5df2\u7ecf\u6536\u5230\u4e86: " + (new String(packet.getData(), 0, packet.getLength())), packet.getAddress().getHostAddress(), packet.getPort());\n            } catch (IOException e) {\n                throw new RuntimeException(e);\n            }\n        }\n    }\n}\n\npackage datagram;\n\nimport java.io.IOException;\nimport java.net.DatagramPacket;\nimport java.net.DatagramSocket;\nimport java.net.SocketException;\n\npublic class Cli {\n    public static void main(String[] args) {\n        try {\n            Cli cli = new Cli();\n            cli.run("127.0.0.1", 6666);\n        } catch (SocketException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    private DatagramSocket cliSocket;\n\n    Cli() throws SocketException {\n        this.cliSocket = new DatagramSocket(); // \u7ed1\u5b9a\u4efb\u610f\u7aef\u53e3\n    }\n\n    public void run(String host, int port) {\n        // \u5bf9\u76ee\u6807\u5206\u522b\u53d1\u9001\u4e24\u6b21\u6d88\u606f\n        try {\n            DatagtamUtil.send(this.cliSocket, "Hello My Ser SaMa ?", host, port);\n\n            DatagramPacket recv = DatagtamUtil.recv(this.cliSocket);\n            System.out.println("\u6536\u5230\u6d88\u606f: " + (new String(recv.getData(), 0, recv.getLength())));\n\n            DatagtamUtil.send(this.cliSocket, "So Fxxk Easy ka?", host, port);\n            recv = DatagtamUtil.recv(this.cliSocket);\n            System.out.println("\u6536\u5230\u6d88\u606f: " + (new String(recv.getData(), 0, recv.getLength())));\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n'})})]})}function p(t={}){const{wrapper:a}={...(0,c.R)(),...t.components};return a?(0,r.jsx)(a,{...t,children:(0,r.jsx)(l,{...t})}):l(t)}},28453:(t,a,e)=>{e.d(a,{R:()=>i,x:()=>o});var n=e(96540);const r={},c=n.createContext(r);function i(t){const a=n.useContext(c);return n.useMemo((function(){return"function"==typeof t?t(a):{...a,...t}}),[a,t])}function o(t){let a;return a=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:i(t.components),n.createElement(c.Provider,{value:a},t.children)}}}]);