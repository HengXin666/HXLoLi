"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[7673],{3454:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"\u7a0b\u5e8f\u8bed\u8a00/C++/C++\u7b2c\u4e09\u65b9\u5e93/QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/\u5957\u63a5\u5b57\u901a\u4fe1/\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1/index","title":"index","description":"\u9644. \u914d\u7f6eCMake","source":"@site/docs/002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/005-C++\u7b2c\u4e09\u65b9\u5e93/003-QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/006-\u5957\u63a5\u5b57\u901a\u4fe1/001-\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1/index.md","sourceDirName":"002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/005-C++\u7b2c\u4e09\u65b9\u5e93/003-QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/006-\u5957\u63a5\u5b57\u901a\u4fe1/001-\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1","slug":"/\u7a0b\u5e8f\u8bed\u8a00/C++/C++\u7b2c\u4e09\u65b9\u5e93/QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/\u5957\u63a5\u5b57\u901a\u4fe1/\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1/","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/C++\u7b2c\u4e09\u65b9\u5e93/QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/\u5957\u63a5\u5b57\u901a\u4fe1/\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/005-C++\u7b2c\u4e09\u65b9\u5e93/003-QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/006-\u5957\u63a5\u5b57\u901a\u4fe1/001-\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1745851959000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u4e8b\u4ef6\u8fc7\u6ee4\u5668","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/C++\u7b2c\u4e09\u65b9\u5e93/QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/QT\u4e8b\u4ef6/\u4e8b\u4ef6\u8fc7\u6ee4\u5668/"},"next":{"title":"Qt\u4e2d\u591a\u7ebf\u7a0b\u7684\u4f7f\u7528","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/C++\u7b2c\u4e09\u65b9\u5e93/QT\u3010\u5b66\u4e60\u81ea\u5927\u4e19\u3011/QT\u591a\u7ebf\u7a0b/Qt\u4e2d\u591a\u7ebf\u7a0b\u7684\u4f7f\u7528/"}}');var s=c(74848),r=c(28453);const d={},t=void 0,l={},o=[{value:"\u9644. \u914d\u7f6eCMake",id:"\u9644-\u914d\u7f6ecmake",level:2},{value:"1. QTcpServer",id:"1-qtcpserver",level:2},{value:"1.1 \u516c\u5171\u6210\u5458\u51fd\u6570",id:"11-\u516c\u5171\u6210\u5458\u51fd\u6570",level:3},{value:"1.2 \u4fe1\u53f7",id:"12-\u4fe1\u53f7",level:3},{value:"2. QTcpSocket",id:"2-qtcpsocket",level:2},{value:"2.1 \u516c\u5171\u6210\u5458\u51fd\u6570",id:"21-\u516c\u5171\u6210\u5458\u51fd\u6570",level:3},{value:"2.2 \u4fe1\u53f7",id:"22-\u4fe1\u53f7",level:3},{value:"3. \u901a\u4fe1\u6d41\u7a0b",id:"3-\u901a\u4fe1\u6d41\u7a0b",level:2},{value:"3.1 \u670d\u52a1\u5668\u7aef",id:"31-\u670d\u52a1\u5668\u7aef",level:3},{value:"3.1.1 \u901a\u4fe1\u6d41\u7a0b",id:"311-\u901a\u4fe1\u6d41\u7a0b",level:4},{value:"3.1.2 \u4ee3\u7801\u7247\u6bb5",id:"312-\u4ee3\u7801\u7247\u6bb5",level:4},{value:"3.2 \u5ba2\u6237\u7aef",id:"32-\u5ba2\u6237\u7aef",level:3},{value:"3.2.1 \u901a\u4fe1\u6d41\u7a0b",id:"321-\u901a\u4fe1\u6d41\u7a0b",level:4},{value:"3.2.2 \u4ee3\u7801\u7247\u6bb5",id:"322-\u4ee3\u7801\u7247\u6bb5",level:4}];function a(e){const n={a:"a",code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u9644-\u914d\u7f6ecmake",children:"\u9644. \u914d\u7f6eCMake"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-CMake",children:"find_package(Qt6 COMPONENTS Network REQUIRED) \ntarget_link_libraries(\u4f60\u7684\u5de5\u7a0b\u540d\u79f0 PRIVATE Qt6::Network)\n"})}),"\n",(0,s.jsxs)(n.div,{className:"markdown-alert markdown-alert-tip",children:["\n",(0,s.jsxs)(n.p,{className:"markdown-alert-title",children:[(0,s.jsx)(n.span,{className:"octicon octicon-tip",style:{"--oct-icon":"url(\"data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' class='octicon octicon-light-bulb mr-2' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z'%3E%3C/path%3E%3C/svg%3E\")"}}),"Tip"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6ce8\u610f, ",(0,s.jsx)(n.code,{children:"target_link_libraries"}),"\u9700\u8981\u653e\u5728\u4e0b\u9762\u4e00\u4e9b(\u627e\u5230",(0,s.jsx)(n.code,{children:"target_link_libraries"}),"\u7684\u4f4d\u7f6e)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8: QMake"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-QMake",children:"QT += network\n"})}),"\n",(0,s.jsx)(n.h1,{id:"\u57fa\u4e8etcp\u7684qt\u7f51\u7edc\u901a\u4fe1",children:"\u57fa\u4e8eTCP\u7684Qt\u7f51\u7edc\u901a\u4fe1"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6807\u51c6C++\u6ca1\u6709\u63d0\u4f9b\u4e13\u95e8\u7528\u4e8e\u5957\u63a5\u5b57\u901a\u4fe1\u7684\u7c7b\uff0c\u6240\u4ee5\u53ea\u80fd\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u57fa\u4e8eC\u7684API\u51fd\u6570\uff0c\u57fa\u4e8e\u8fd9\u4e9bC\u7684API\u51fd\u6570\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c01\u88c5\u81ea\u5df1\u7684C++\u7c7b(",(0,s.jsx)(n.a,{href:"/HXLoLi/docs/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/C++/tmp%E4%B8%B6C++%E4%B8%B6memo/C++%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E5%AE%9E%E8%B7%B5%E7%89%88%E6%9C%AC/%E5%AF%B9%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E8%BF%9B%E8%A1%8C%E7%B1%BB%E5%B0%81%E8%A3%85/",children:"\u5bf9\u5e38\u7528\u64cd\u4f5c\u8fdb\u884c\u7c7b\u5c01\u88c5"}),")\u3002\u4f46\u662fQt\u5c31\u4e0d\u4e00\u6837\u4e86\uff0c\u5b83\u662fC++\u7684\u4e00\u4e2a\u6846\u67b6\u5e76\u4e14\u91cc\u8fb9\u63d0\u4f9b\u4e86\u7528\u4e8e\u5957\u63a5\u5b57\u901a\u4fe1\u7684\u7c7b\uff08TCP\u3001UDP\uff09\u8fd9\u6837\u5c31\u4f7f\u5f97\u6211\u4eec\u7684\u64cd\u4f5c\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u4e86\uff08\u5f53\u7136\uff0c\u5728Qt\u4e2d\u4f7f\u7528\u6807\u51c6C\u7684API\u8fdb\u884c\u5957\u63a5\u5b57\u901a\u4fe1\u4e5f\u662f\u5b8c\u5168\u6ca1\u6709\u95ee\u9898\u7684\uff09\u3002\u4e0b\u9762\uff0c\u7ed9\u5927\u5bb6\u8bb2\u4e00\u4e0b\u5982\u679c\u4f7f\u7528\u76f8\u5173\u7c7b\u7684\u8fdb\u884cTCP\u901a\u4fe1\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528Qt\u63d0\u4f9b\u7684\u7c7b\u8fdb\u884c\u57fa\u4e8eTCP\u7684\u5957\u63a5\u5b57\u901a\u4fe1\u9700\u8981\u7528\u5230\u4e24\u4e2a\u7c7b:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.span,{style:{color:"red"},children:[(0,s.jsx)(n.code,{children:"QTcpServer"}),": \u670d\u52a1\u5668\u7c7b\uff0c\u7528\u4e8e\u76d1\u542c\u5ba2\u6237\u7aef\u8fde\u63a5\u4ee5\u53ca\u548c\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\u3002"]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.span,{style:{color:"red"},children:[(0,s.jsx)(n.code,{children:"QTcpSocket"}),": \u901a\u4fe1\u7684\u5957\u63a5\u5b57\u7c7b\uff0c\u5ba2\u6237\u7aef\u3001\u670d\u52a1\u5668\u7aef\u90fd\u9700\u8981\u4f7f\u7528\u3002"]})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u4e24\u4e2a\u5957\u63a5\u5b57\u901a\u4fe1\u7c7b\u90fd\u5c5e\u4e8e\u7f51\u7edc\u6a21\u5757",(0,s.jsx)(n.code,{children:"network"}),"\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"1-qtcpserver",children:"1. QTcpServer"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"QTcpServer"}),"\u7c7b\u7528\u4e8e\u76d1\u542c\u5ba2\u6237\u7aef\u8fde\u63a5\u4ee5\u53ca\u548c\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\uff0c\u5728\u4f7f\u7528\u4e4b\u524d\u5148\u4ecb\u7ecd\u4e00\u4e0b\u8fd9\u4e2a\u7c7b\u63d0\u4f9b\u7684\u4e00\u4e9b\u5e38\u7528API\u51fd\u6570:"]}),"\n",(0,s.jsx)(n.h3,{id:"11-\u516c\u5171\u6210\u5458\u51fd\u6570",children:"1.1 \u516c\u5171\u6210\u5458\u51fd\u6570"}),"\n",(0,s.jsx)(n.p,{children:"\u6784\u9020\u51fd\u6570"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"QTcpServer::QTcpServer(QObject *parent = Q_NULLPTR);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7ed9\u76d1\u542c\u7684\u5957\u63a5\u5b57\u8bbe\u7f6e\u76d1\u542c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"bool QTcpServer::listen(const QHostAddress &address = QHostAddress::Any, quint16 port = 0);\n// \u5224\u65ad\u5f53\u524d\u5bf9\u8c61\u662f\u5426\u5728\u76d1\u542c, \u662f\u8fd4\u56detrue\uff0c\u6ca1\u6709\u76d1\u542c\u8fd4\u56defalse\nbool QTcpServer::isListening() const;\n// \u5982\u679c\u5f53\u524d\u5bf9\u8c61\u6b63\u5728\u76d1\u542c\u8fd4\u56de\u76d1\u542c\u7684\u670d\u52a1\u5668\u5730\u5740\u4fe1\u606f, \u5426\u5219\u8fd4\u56de QHostAddress::Null\nQHostAddress QTcpServer::serverAddress() const;\n// \u5982\u679c\u670d\u52a1\u5668\u6b63\u5728\u4fa6\u542c\u8fde\u63a5\uff0c\u5219\u8fd4\u56de\u670d\u52a1\u5668\u7684\u7aef\u53e3; \u5426\u5219\u8fd4\u56de0\nquint16 QTcpServer::serverPort() const\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u53c2\u6570\uff1a\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"address"}),"\uff1a\u901a\u8fc7\u7c7b",(0,s.jsx)(n.code,{children:"QHostAddress"}),"\u53ef\u4ee5\u5c01\u88c5",(0,s.jsx)(n.code,{children:"IPv4"}),"\u3001",(0,s.jsx)(n.code,{children:"IPv6"}),"\u683c\u5f0f\u7684IP\u5730\u5740\uff0c",(0,s.jsx)(n.code,{children:"QHostAddress::Any"}),"\u8868\u793a\u81ea\u52a8\u7ed1\u5b9a"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"port"}),"\uff1a\u5982\u679c\u6307\u5b9a\u4e3a0\u8868\u793a\u968f\u673a\u7ed1\u5b9a\u4e00\u4e2a\u53ef\u7528\u7aef\u53e3\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u8fd4\u56de\u503c\uff1a\u7ed1\u5b9a\u6210\u529f\u8fd4\u56detrue\uff0c\u5931\u8d25\u8fd4\u56defalse"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5f97\u5230\u548c\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\u4e4b\u540e\u7528\u4e8e\u901a\u4fe1\u7684",(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u5957\u63a5\u5b57\u5bf9\u8c61\uff0c\u5b83\u662f",(0,s.jsx)(n.code,{children:"QTcpServer"}),"\u7684\u4e00\u4e2a\u5b50\u5bf9\u8c61\uff0c\u5f53",(0,s.jsx)(n.code,{children:"QTcpServer"}),"\u5bf9\u8c61\u6790\u6784\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u6790\u6784\u8fd9\u4e2a\u5b50\u5bf9\u8c61\uff0c\u5f53\u7136\u4e5f\u53ef\u81ea\u5df1\u624b\u52a8\u6790\u6784\uff0c\u5efa\u8bae\u7528\u5b8c\u4e4b\u540e\u81ea\u5df1\u624b\u52a8\u6790\u6784\u8fd9\u4e2a\u901a\u4fe1\u7684",(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u5bf9\u8c61\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"QTcpSocket *QTcpServer::nextPendingConnection();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u963b\u585e\u7b49\u5f85\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c",(0,s.jsxs)(n.span,{style:{color:"red"},children:["\u4e0d\u63a8\u8350\u5728\u5355\u7ebf\u7a0b\u7a0b\u5e8f\u4e2d\u4f7f\u7528\uff0c\u5efa\u8bae\u4f7f\u7528\u975e\u963b\u585e\u65b9\u5f0f\u5904\u7406\u65b0\u8fde\u63a5\uff0c\u5373\u4f7f\u7528\u4fe1\u53f7",(0,s.jsx)(n.code,{children:"newConnection()"}),"\u3002"]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"bool QTcpServer::waitForNewConnection(int msec = 0, bool *timedOut = Q_NULLPTR);\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u53c2\u6570\uff1a\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"msec"}),"\uff1a\u6307\u5b9a\u963b\u585e\u7684\u6700\u5927\u65f6\u957f\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2\uff08ms\uff09"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"timeout"}),"\uff1a\u4f20\u51fa\u53c2\u6570\uff0c\u5982\u679c\u64cd\u4f5c\u8d85\u65f6",(0,s.jsx)(n.code,{children:"timeout"}),"\u4e3atrue\uff0c\u6ca1\u6709\u8d85\u65f6",(0,s.jsx)(n.code,{children:"timeout"}),"\u4e3afalse"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"12-\u4fe1\u53f7",children:"1.2 \u4fe1\u53f7"}),"\n",(0,s.jsxs)(n.p,{children:["\u5f53\u63a5\u53d7\u65b0\u8fde\u63a5\u5bfc\u81f4\u9519\u8bef\u65f6\uff0c\u5c06\u53d1\u5c04\u5982\u4e0b\u4fe1\u53f7\u3002",(0,s.jsx)(n.code,{children:"socketError"}),"\u53c2\u6570\u63cf\u8ff0\u4e86\u53d1\u751f\u7684\u9519\u8bef\u76f8\u5173\u7684\u4fe1\u606f\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"[signal] void QTcpServer::acceptError(QAbstractSocket::SocketError socketError);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6bcf\u6b21\u6709\u65b0\u8fde\u63a5\u53ef\u7528\u65f6\u90fd\u4f1a\u53d1\u51fa",(0,s.jsx)(n.code,{children:"newConnection()"}),"\u4fe1\u53f7\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"[signal] void QTcpServer::newConnection();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"2-qtcpsocket",children:"2. QTcpSocket"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u662f\u4e00\u4e2a\u5957\u63a5\u5b57\u901a\u4fe1\u7c7b\uff0c\u4e0d\u7ba1\u662f\u5ba2\u6237\u7aef\u8fd8\u662f\u670d\u52a1\u5668\u7aef\u90fd\u9700\u8981\u4f7f\u7528\u3002\u5728Qt\u4e2d\u53d1\u9001\u548c\u63a5\u6536\u6570\u636e\u4e5f\u5c5e\u4e8eIO\u64cd\u4f5c\uff08\u7f51\u7edcIO\uff09\uff0c\u5148\u6765\u770b\u4e00\u4e0b\u8fd9\u4e2a\u7c7b\u7684\u7ee7\u627f\u5173\u7cfb:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsx)(n.tr,{children:(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"##container##"})})}),(0,s.jsx)(n.tbody,{children:(0,s.jsx)(n.tr,{children:(0,s.jsx)(n.td,{style:{textAlign:"center"},children:(0,s.jsx)(n.img,{alt:"Clip_2024-09-29_22-18-45.png ##w700##",src:c(39352).A+"",width:"1246",height:"164"})})})})]}),"\n",(0,s.jsx)(n.h3,{id:"21-\u516c\u5171\u6210\u5458\u51fd\u6570",children:"2.1 \u516c\u5171\u6210\u5458\u51fd\u6570"}),"\n",(0,s.jsx)(n.p,{children:"\u6784\u9020\u51fd\u6570"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"QTcpSocket::QTcpSocket(QObject *parent = Q_NULLPTR);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fde\u63a5\u670d\u52a1\u5668"}),"\uff0c\u9700\u8981\u6307\u5b9a\u670d\u52a1\u5668\u7aef\u7ed1\u5b9a\u7684IP\u548c\u7aef\u53e3\u4fe1\u606f\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"[virtual] void QAbstractSocket::connectToHost(const QString &hostName, quint16 port, OpenMode openMode = ReadWrite, NetworkLayerProtocol protocol = AnyIPProtocol);\n\n[virtual] void QAbstractSocket::connectToHost(const QHostAddress &address, quint16 port, OpenMode openMode = ReadWrite);\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.span,{style:{color:"red"},children:"\u5728Qt\u4e2d\u4e0d\u7ba1\u8c03\u7528\u8bfb\u64cd\u4f5c\u51fd\u6570\u63a5\u6536\u6570\u636e\uff0c\u8fd8\u662f\u8c03\u7528\u5199\u51fd\u6570\u53d1\u9001\u6570\u636e\uff0c\u64cd\u4f5c\u7684\u5bf9\u8c61\u90fd\u662f\u672c\u5730\u7684\u7531Qt\u6846\u67b6\u7ef4\u62a4\u7684\u4e00\u5757\u5185\u5b58\u3002\u56e0\u6b64\uff0c\u8c03\u7528\u4e86\u53d1\u9001\u51fd\u6570\u6570\u636e\u4e0d\u4e00\u5b9a\u4f1a\u9a6c\u4e0a\u88ab\u53d1\u9001\u5230\u7f51\u7edc\u4e2d\uff0c\u8c03\u7528\u4e86\u63a5\u6536\u51fd\u6570\u4e5f\u4e0d\u662f\u76f4\u63a5\u4ece\u7f51\u7edc\u4e2d\u63a5\u6536\u6570\u636e\uff0c\u5173\u4e8e\u5e95\u5c42\u7684\u76f8\u5173\u64cd\u4f5c\u662f\u4e0d\u9700\u8981\u4f7f\u7528\u8005\u6765\u7ef4\u62a4\u7684\u3002"})}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u6536\u6570\u636e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"// \u6307\u5b9a\u53ef\u63a5\u6536\u7684\u6700\u5927\u5b57\u8282\u6570 maxSize \u7684\u6570\u636e\u5230\u6307\u9488 data \u6307\u5411\u7684\u5185\u5b58\u4e2d\nqint64 QIODevice::read(char *data, qint64 maxSize);\n// \u6307\u5b9a\u53ef\u63a5\u6536\u7684\u6700\u5927\u5b57\u8282\u6570 maxSize\uff0c\u8fd4\u56de\u63a5\u6536\u7684\u5b57\u7b26\u4e32\nQByteArray QIODevice::read(qint64 maxSize);\n// \u5c06\u5f53\u524d\u53ef\u7528\u64cd\u4f5c\u6570\u636e\u5168\u90e8\u8bfb\u51fa\uff0c\u901a\u8fc7\u8fd4\u56de\u503c\u8fd4\u56de\u8bfb\u51fa\u7684\u5b57\u7b26\u4e32\nQByteArray QIODevice::readAll();\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53d1\u9001\u6570\u636e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"// \u53d1\u9001\u6307\u9488 data \u6307\u5411\u7684\u5185\u5b58\u4e2d\u7684 maxSize \u4e2a\u5b57\u8282\u7684\u6570\u636e\nqint64 QIODevice::write(const char *data, qint64 maxSize);\n// \u53d1\u9001\u6307\u9488 data \u6307\u5411\u7684\u5185\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u5b57\u7b26\u4e32\u4ee5 \\0 \u4f5c\u4e3a\u7ed3\u675f\u6807\u8bb0\nqint64 QIODevice::write(const char *data);\n// \u53d1\u9001\u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\nqint64 QIODevice::write(const QByteArray &byteArray);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"22-\u4fe1\u53f7",children:"2.2 \u4fe1\u53f7"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u4f7f\u7528",(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u8fdb\u884c\u5957\u63a5\u5b57\u901a\u4fe1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u8be5\u7c7b\u5bf9\u8c61\u53d1\u5c04\u51fa",(0,s.jsx)(n.code,{children:"readyRead()"}),"\u4fe1\u53f7\uff0c\u8bf4\u660e\u5bf9\u7aef\u53d1\u9001\u7684\u6570\u636e\u8fbe\u5230\u4e86\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u8c03\u7528",(0,s.jsx)(n.code,{children:"read"}),"\u51fd\u6570\u63a5\u6536\u6570\u636e\u4e86\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"[signal] void QIODevice::readyRead();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8c03\u7528",(0,s.jsx)(n.code,{children:"connectToHost()"}),"\u51fd\u6570\u5e76\u6210\u529f\u5efa\u7acb\u8fde\u63a5\u4e4b\u540e\u53d1\u51fa",(0,s.jsx)(n.code,{children:"connected()"}),"\u4fe1\u53f7\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"[signal] void QAbstractSocket::connected();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u5957\u63a5\u5b57\u65ad\u5f00\u8fde\u63a5\u65f6\u53d1\u51fa",(0,s.jsx)(n.code,{children:"disconnected()"}),"\u4fe1\u53f7\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"[signal] void QAbstractSocket::disconnected();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"3-\u901a\u4fe1\u6d41\u7a0b",children:"3. \u901a\u4fe1\u6d41\u7a0b"}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528Qt\u63d0\u4f9b\u7684\u7c7b\u8fdb\u884c\u5957\u63a5\u5b57\u901a\u4fe1\u6bd4\u4f7f\u7528\u6807\u51c6C API\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1\u8981\u7b80\u5355\uff08\u56e0\u4e3a\u5728\u5185\u90e8\u8fdb\u884c\u4e86\u5c01\u88c5(",(0,s.jsx)(n.a,{href:"/HXLoLi/docs/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/C++/tmp%E4%B8%B6C++%E4%B8%B6memo/C++%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/%E5%AE%9E%E8%B7%B5%E7%89%88%E6%9C%AC/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E4%B8%8E%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/",children:"\u7f51\u7edc\u534f\u8bae\u4e0e\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),")\uff09 Qt\u4e2d\u7684\u5957\u63a5\u5b57\u901a\u4fe1\u6d41\u7a0b\u5982\u4e0b:"]}),"\n",(0,s.jsx)(n.h3,{id:"31-\u670d\u52a1\u5668\u7aef",children:"3.1 \u670d\u52a1\u5668\u7aef"}),"\n",(0,s.jsx)(n.h4,{id:"311-\u901a\u4fe1\u6d41\u7a0b",children:"3.1.1 \u901a\u4fe1\u6d41\u7a0b"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u521b\u5efa\u5957\u63a5\u5b57\u670d\u52a1\u5668",(0,s.jsx)(n.code,{children:"QTcpServer"}),"\u5bf9\u8c61"]}),"\n",(0,s.jsxs)(n.li,{children:["\u901a\u8fc7",(0,s.jsx)(n.code,{children:"QTcpServer"}),"\u5bf9\u8c61\u8bbe\u7f6e\u76d1\u542c\uff0c\u5373\uff1a",(0,s.jsx)(n.code,{children:"QTcpServer::listen()"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u57fa\u4e8e",(0,s.jsx)(n.code,{children:"QTcpServer::newConnection()"}),"\u4fe1\u53f7\u68c0\u6d4b\u662f\u5426\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5982\u679c\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u8c03\u7528",(0,s.jsx)(n.code,{children:"QTcpSocket *QTcpServer::nextPendingConnection()"}),"\u5f97\u5230\u901a\u4fe1\u7684\u5957\u63a5\u5b57\u5bf9\u8c61"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528\u901a\u4fe1\u7684\u5957\u63a5\u5b57\u5bf9\u8c61",(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u548c\u5ba2\u6237\u7aef\u8fdb\u884c\u901a\u4fe1"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"312-\u4ee3\u7801\u7247\u6bb5",children:"3.1.2 \u4ee3\u7801\u7247\u6bb5"}),"\n",(0,s.jsx)(n.p,{children:"\u670d\u52a1\u5668\u7aef & \u5ba2\u6237\u7aef\u7684\u7a97\u53e3\u754c\u9762\u5982\u4e0b\u56fe\u6240\u793a:"}),"\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsx)(n.tr,{children:(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"##container##"})})}),(0,s.jsx)(n.tbody,{children:(0,s.jsx)(n.tr,{children:(0,s.jsx)(n.td,{style:{textAlign:"center"},children:(0,s.jsx)(n.img,{alt:"Clip_2024-09-29_23-39-44.png ##w600##",src:c(57797).A+"",width:"1113",height:"758"})})})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5934\u6587\u4ef6"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"class MainWindow : public QMainWindow {\n    Q_OBJECT\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n    ~MainWindow();\n\nprivate slots:\n    void on_startServer_clicked();\n    void on_sendMsg_clicked();\n\nprivate:\n    Ui::MainWindow *ui;\n    QTcpServer* m_server;\n    QTcpSocket* m_tcp;\n};\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6e90\u6587\u4ef6"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:'MainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui->setupUi(this);\n    setWindowTitle("TCP - \u670d\u52a1\u5668");\n    // \u521b\u5efa QTcpServer \u5bf9\u8c61\n    m_server = new QTcpServer(this);\n    // \u68c0\u6d4b\u662f\u5426\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\n    connect(m_server, &QTcpServer::newConnection, this, [=]() {\n        m_tcp = m_server->nextPendingConnection();\n        ui->record->append("\u6210\u529f\u548c\u5ba2\u6237\u7aef\u5efa\u7acb\u4e86\u65b0\u7684\u8fde\u63a5...");\n        m_status->setPixmap(QPixmap(":/connect.png").scaled(20, 20));\n        // \u68c0\u6d4b\u662f\u5426\u6709\u5ba2\u6237\u7aef\u6570\u636e\n        connect(m_tcp, &QTcpSocket::readyRead, this, [=]() {\n            // \u63a5\u6536\u6570\u636e\n            QString recvMsg = m_tcp->readAll();\n            ui->record->append("\u5ba2\u6237\u7aefSay: " + recvMsg);\n        });\n        // \u5ba2\u6237\u7aef\u65ad\u5f00\u4e86\u8fde\u63a5\n        connect(m_tcp, &QTcpSocket::disconnected, this, [=]() {\n            ui->record->append("\u5ba2\u6237\u7aef\u5df2\u7ecf\u65ad\u5f00\u4e86\u8fde\u63a5...");\n            m_tcp->deleteLater();\n            m_status->setPixmap(QPixmap(":/disconnect.png").scaled(20, 20));\n        });\n    });\n}\n\nMainWindow::~MainWindow() {\n    delete ui;\n}\n\n// \u542f\u52a8\u670d\u52a1\u5668\u7aef\u7684\u670d\u52a1\u6309\u94ae\nvoid MainWindow::on_startServer_clicked() {\n    unsigned short port = ui->port->text().toInt();\n    // \u8bbe\u7f6e\u670d\u52a1\u5668\u76d1\u542c\n    m_server->listen(QHostAddress::Any, port);\n    ui->startServer->setEnabled(false);\n}\n\n// \u70b9\u51fb\u53d1\u9001\u6570\u636e\u6309\u94ae\nvoid MainWindow::on_sendMsg_clicked() {\n    QString sendMsg = ui->msg->toPlainText();\n    m_tcp->write(sendMsg.toUtf8());\n    ui->record->append("\u670d\u52a1\u5668Say: " + sendMsg);\n    ui->msg->clear();\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"32-\u5ba2\u6237\u7aef",children:"3.2 \u5ba2\u6237\u7aef"}),"\n",(0,s.jsx)(n.h4,{id:"321-\u901a\u4fe1\u6d41\u7a0b",children:"3.2.1 \u901a\u4fe1\u6d41\u7a0b"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u521b\u5efa\u901a\u4fe1\u7684\u5957\u63a5\u5b57\u7c7b",(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u5bf9\u8c61"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u7ed1\u5b9a\u7684IP\u548c\u7aef\u53e3\u8fde\u63a5\u670d\u52a1\u5668",(0,s.jsx)(n.code,{children:"QAbstractSocket::connectToHost()"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528",(0,s.jsx)(n.code,{children:"QTcpSocket"}),"\u5bf9\u8c61\u548c\u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"322-\u4ee3\u7801\u7247\u6bb5",children:"3.2.2 \u4ee3\u7801\u7247\u6bb5"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5934\u6587\u4ef6"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:"class MainWindow : public QMainWindow {\n    Q_OBJECT\n\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n    ~MainWindow();\n\nprivate slots:\n    void on_connectServer_clicked();\n    void on_sendMsg_clicked();\n    void on_disconnect_clicked();\n\nprivate:\n    Ui::MainWindow *ui;\n    QTcpSocket* m_tcp;\n};\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6e90\u6587\u4ef6"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C++",children:'MainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui->setupUi(this);\n    setWindowTitle("TCP - \u5ba2\u6237\u7aef");\n\n    // \u521b\u5efa\u901a\u4fe1\u7684\u5957\u63a5\u5b57\u5bf9\u8c61\n    m_tcp = new QTcpSocket(this);\n    // \u68c0\u6d4b\u670d\u52a1\u5668\u662f\u5426\u56de\u590d\u4e86\u6570\u636e\n    connect(m_tcp, &QTcpSocket::readyRead, [=]() {\n        // \u63a5\u6536\u670d\u52a1\u5668\u53d1\u9001\u7684\u6570\u636e\n        QByteArray recvMsg = m_tcp->readAll();\n        ui->record->append("\u670d\u52a1\u5668Say: " + recvMsg);\n    });\n\n    // \u68c0\u6d4b\u662f\u5426\u548c\u670d\u52a1\u5668\u662f\u5426\u8fde\u63a5\u6210\u529f\u4e86\n    connect(m_tcp, &QTcpSocket::connected, this, [=]() {\n        ui->record->append("\u606d\u559c, \u8fde\u63a5\u670d\u52a1\u5668\u6210\u529f!!!");\n        m_status->setPixmap(QPixmap(":/connect.png").scaled(20, 20));\n    });\n\n    // \u68c0\u6d4b\u670d\u52a1\u5668\u662f\u5426\u548c\u5ba2\u6237\u7aef\u65ad\u5f00\u4e86\u8fde\u63a5\n    connect(m_tcp, &QTcpSocket::disconnected, this, [=]() {\n        ui->record->append("\u670d\u52a1\u5668\u5df2\u7ecf\u65ad\u5f00\u4e86\u8fde\u63a5, ...");\n        ui->connectServer->setEnabled(true);\n        ui->disconnect->setEnabled(false);\n    });\n}\n\nMainWindow::~MainWindow() {\n    delete ui;\n}\n\n// \u8fde\u63a5\u670d\u52a1\u5668\u6309\u94ae\u6309\u4e0b\u4e4b\u540e\u7684\u5904\u7406\u52a8\u4f5c\nvoid MainWindow::on_connectServer_clicked() {\n    QString ip = ui->ip->text();\n    unsigned short port = ui->port->text().toInt();\n    // \u8fde\u63a5\u670d\u52a1\u5668\n    m_tcp->connectToHost(QHostAddress(ip), port);\n    ui->connectServer->setEnabled(false);\n    ui->disconnect->setEnabled(true);\n}\n\n// \u53d1\u9001\u6570\u636e\u6309\u94ae\u6309\u4e0b\u4e4b\u540e\u7684\u5904\u7406\u52a8\u4f5c\nvoid MainWindow::on_sendMsg_clicked() {\n    QString sendMsg = ui->msg->toPlainText();\n    m_tcp->write(sendMsg.toUtf8());\n    ui->record->append("\u5ba2\u6237\u7aefSay: " + sendMsg);\n    ui->msg->clear();\n}\n\n// \u65ad\u5f00\u8fde\u63a5\u6309\u94ae\u88ab\u6309\u4e0b\u4e4b\u540e\u7684\u5904\u7406\u52a8\u4f5c\nvoid MainWindow::on_disconnect_clicked() {\n    m_tcp->close();\n    ui->connectServer->setEnabled(true);\n    ui->disconnect->setEnabled(false);\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,n,c)=>{c.d(n,{R:()=>d,x:()=>t});var i=c(96540);const s={},r=i.createContext(s);function d(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(r.Provider,{value:n},e.children)}},39352:(e,n,c)=>{c.d(n,{A:()=>i});const i=c.p+"assets/images/Clip_2024-09-29_22-18-45-e3f5fbd527288bf45a3aec426745df29.png"},57797:(e,n,c)=>{c.d(n,{A:()=>i});const i=c.p+"assets/images/Clip_2024-09-29_23-39-44-3a595d762475b939641d3e28e5c8fe51.png"}}]);