"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[62356],{13297:(n,e,c)=>{c.r(e),c.d(e,{assets:()=>a,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"\u7a0b\u5e8f\u8bed\u8a00/C++/tmp\u4e36C++\u4e36memo/C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/C++\u7248/call\u4e36once/index","title":"call_once","description":"\u5728\u67d0\u4e9b\u7279\u5b9a\u60c5\u51b5\u4e0b\uff0c\u67d0\u4e9b\u51fd\u6570\u53ea\u80fd\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u8c03\u7528\u4e00\u6b21\uff0c\u6bd4\u5982\uff1a\u8981\u521d\u59cb\u5316\u67d0\u4e2a\u5bf9\u8c61\uff0c\u800c\u8fd9\u4e2a\u5bf9\u8c61\u53ea\u80fd\u88ab\u521d\u59cb\u5316\u4e00\u6b21\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528std:","source":"@site/docs/002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/002-tmp\u4e36C++\u4e36memo/005-C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/002-C++\u7248/003-call\u4e36once/index.md","sourceDirName":"002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/002-tmp\u4e36C++\u4e36memo/005-C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/002-C++\u7248/003-call\u4e36once","slug":"/\u7a0b\u5e8f\u8bed\u8a00/C++/tmp\u4e36C++\u4e36memo/C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/C++\u7248/call\u4e36once/","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/tmp\u4e36C++\u4e36memo/C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/C++\u7248/call\u4e36once/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/002-\u7a0b\u5e8f\u8bed\u8a00/001-C++/002-tmp\u4e36C++\u4e36memo/005-C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/002-C++\u7248/003-call\u4e36once/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1745851959000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"this\u4e36thread\u547d\u540d\u7a7a\u95f4","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/tmp\u4e36C++\u4e36memo/C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/C++\u7248/this\u4e36thread\u547d\u540d\u7a7a\u95f4/"},"next":{"title":"C++\u4e92\u65a5\u9501","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/C++/tmp\u4e36C++\u4e36memo/C++\u591a\u8fdb\u7a0b\u4e0e\u591a\u7ebf\u7a0b/C++\u7248/C++\u4e92\u65a5\u9501/"}}');var t=c(74848),o=c(28453);const s={},i="call_once",a={},d=[{value:"\u53c2\u8003\u94fe\u63a5",id:"\u53c2\u8003\u94fe\u63a5",level:2}];function r(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"call_once",children:"call_once"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u67d0\u4e9b\u7279\u5b9a\u60c5\u51b5\u4e0b\uff0c\u67d0\u4e9b\u51fd\u6570\u53ea\u80fd\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u8c03\u7528\u4e00\u6b21\uff0c\u6bd4\u5982\uff1a\u8981\u521d\u59cb\u5316\u67d0\u4e2a\u5bf9\u8c61\uff0c\u800c\u8fd9\u4e2a\u5bf9\u8c61\u53ea\u80fd\u88ab\u521d\u59cb\u5316\u4e00\u6b21\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528",(0,t.jsx)(e.code,{children:"std::call_once()"}),"\u6765\u4fdd\u8bc1\u51fd\u6570\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u53ea\u80fd\u88ab\u8c03\u7528\u4e00\u6b21\u3002\u4f7f\u7528",(0,t.jsx)(e.code,{children:"call_once()"}),"\u7684\u65f6\u5019\uff0c\u9700\u8981\u4e00\u4e2a",(0,t.jsx)(e.code,{children:"once_flag"}),"\u4f5c\u4e3a",(0,t.jsx)(e.code,{children:"call_once()"}),"\u7684\u4f20\u5165\u53c2\u6570\uff0c\u8be5\u51fd\u6570\u7684\u539f\u578b\u5982\u4e0b:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-C++",children:"// \u5b9a\u4e49\u4e8e\u5934\u6587\u4ef6 <mutex>\ntemplate< class Callable, class... Args >\nvoid call_once( std::once_flag& flag, Callable&& f, Args&&... args );\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u53c2\u6570:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"flag"}),"\uff1aonce_flag\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8981\u4fdd\u8bc1\u8fd9\u4e2a\u5bf9\u8c61\u80fd\u591f\u88ab\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u5230"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"f"}),"\uff1a\u56de\u8c03\u51fd\u6570\uff0c\u53ef\u4ee5\u4f20\u9012\u4e00\u4e2a\u6709\u540d\u51fd\u6570\u5730\u5740\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u533f\u540d\u51fd\u6570"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"args"}),"\uff1a\u4f5c\u4e3a\u5b9e\u53c2\u4f20\u9012\u7ed9\u56de\u8c03\u51fd\u6570"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u591a\u7ebf\u7a0b\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0cstd::call_once()\u5185\u90e8\u7684\u56de\u8c03\u51fd\u6570\u53ea\u4f1a\u88ab\u6267\u884c\u4e00\u6b21\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-C++",children:'#include <iostream>\n#include <thread>\n#include <mutex>\nusing namespace std;\n\nonce_flag g_flag;\nvoid do_once(int a, string b)\n{\n    cout << "name: " << b << ", age: " << a << endl;\n}\n\nvoid do_something(int age, string name)\n{\n    static int num = 1;\n    call_once(g_flag, do_once, 19, "luffy");\n    cout << "do_something() function num = " << num++ << endl;\n}\n\nint main()\n{\n    thread t1(do_something, 20, "ace");\n    thread t2(do_something, 20, "sabo");\n    thread t3(do_something, 19, "luffy");\n    t1.join();\n    t2.join();\n    t3.join();\n\n    return 0;\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u793a\u4f8b\u7a0b\u5e8f\u8f93\u51fa\u7684\u7ed3\u679c:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-C++",children:"name: luffy, age: 19\ndo_something() function num = 1\ndo_something() function num = 2\ndo_something() function num = 3\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u901a\u8fc7\u8f93\u51fa\u7684\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\uff0c\u867d\u7136\u8fd0\u884c\u7684\u4e09\u4e2a\u7ebf\u7a0b\u4e2d\u90fd\u6267\u884c\u4e86\u4efb\u52a1\u51fd\u6570",(0,t.jsx)(e.code,{children:"do_something()"}),"\u4f46\u662f",(0,t.jsx)(e.code,{children:"call_once()"}),"\u4e2d\u6307\u5b9a\u7684\u56de\u8c03\u51fd\u6570\u53ea\u88ab\u6267\u884c\u4e86\u4e00\u6b21\uff0c\u6211\u4eec\u7684\u76ee\u7684\u4e5f\u8fbe\u5230\u4e86\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"\u53c2\u8003\u94fe\u63a5",children:"\u53c2\u8003\u94fe\u63a5"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:"https://subingwen.cn/cpp/call_once/",children:"\u7231\u7f16\u7a0b\u7684\u5927\u4e19 call_once"})})]})}function m(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(r,{...n})}):r(n)}},28453:(n,e,c)=>{c.d(e,{R:()=>s,x:()=>i});var l=c(96540);const t={},o=l.createContext(t);function s(n){const e=l.useContext(o);return l.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),l.createElement(o.Provider,{value:e},n.children)}}}]);