"use strict";(self.webpackChunkhx_loli=self.webpackChunkhx_loli||[]).push([[42459],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var a=t(96540);const i={},l=a.createContext(i);function s(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(l.Provider,{value:n},e.children)}},75169:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"\u7a0b\u5e8f\u8bed\u8a00/Java/JavaWeb/JSP/\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u3001Excel\u5bfc\u5165\u5bfc\u51fa/index","title":"index","description":"/ Markdown\u98ce\u683c\u7684\u6837\u5f0f /","source":"@site/docs/002-\u7a0b\u5e8f\u8bed\u8a00/002-Java/004-JavaWeb/001-JSP/006-\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u3001Excel\u5bfc\u5165\u5bfc\u51fa/index.md","sourceDirName":"002-\u7a0b\u5e8f\u8bed\u8a00/002-Java/004-JavaWeb/001-JSP/006-\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u3001Excel\u5bfc\u5165\u5bfc\u51fa","slug":"/\u7a0b\u5e8f\u8bed\u8a00/Java/JavaWeb/JSP/\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u3001Excel\u5bfc\u5165\u5bfc\u51fa/","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/Java/JavaWeb/JSP/\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u3001Excel\u5bfc\u5165\u5bfc\u51fa/","draft":false,"unlisted":false,"editUrl":"https://github.com/HengXin666/HXLoLi/edit/main/docs/002-\u7a0b\u5e8f\u8bed\u8a00/002-Java/004-JavaWeb/001-JSP/006-\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d\u3001Excel\u5bfc\u5165\u5bfc\u51fa/index.md","tags":[],"version":"current","lastUpdatedBy":"Heng_Xin_666","lastUpdatedAt":1745851959000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"AJAS\u548cJSON","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/Java/JavaWeb/JSP/AJAS\u548cJSON/"},"next":{"title":"\u76d1\u542c\u5668\u3001RBAC\u6743\u9650\u6a21\u578b","permalink":"/HXLoLi/docs/\u7a0b\u5e8f\u8bed\u8a00/Java/JavaWeb/JSP/\u76d1\u542c\u5668\u3001RBAC\u6743\u9650\u6a21\u578b/"}}');var i=t(74848),l=t(28453);const s={},r="\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d",c={},o=[{value:"\u6587\u4ef6\u5904\u7406\u7684\u5305",id:"\u6587\u4ef6\u5904\u7406\u7684\u5305",level:2},{value:"\u6587\u4ef6\u4e0a\u4f20",id:"\u6587\u4ef6\u4e0a\u4f20",level:2},{value:"form \u8868\u5355\u4e0a\u4f20",id:"form-\u8868\u5355\u4e0a\u4f20",level:3},{value:"ajax \u6587\u4ef6\u4e0a\u4f20",id:"ajax-\u6587\u4ef6\u4e0a\u4f20",level:3},{value:"\u6587\u4ef6\u4e0b\u8f7d",id:"\u6587\u4ef6\u4e0b\u8f7d",level:2},{value:"<code>EasyExcel</code> \u4ecb\u7ecd",id:"easyexcel-\u4ecb\u7ecd",level:2},{value:"<code>EasyExcel</code> \u751f\u6210 Excel",id:"easyexcel-\u751f\u6210-excel",level:2},{value:"<code>EasyExcel</code> \u89e3\u6790 Excel",id:"easyexcel-\u89e3\u6790-excel",level:2},{value:"<code>EasyExcel</code> \u5bfc\u5165\u5bfc\u51fa",id:"easyexcel-\u5bfc\u5165\u5bfc\u51fa",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",style:"style",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.style,{children:"\n/* Markdown\u98ce\u683c\u7684\u6837\u5f0f */\n\n/* h1\u7684\u6837\u5f0f */\nh1 {\n    color: yellow;\n    margin-top: 1.5em; /* \u9876\u90e8\u95f4\u8ddd */\n    margin-bottom: 0.5em; /* \u5e95\u90e8\u95f4\u8ddd */\n}\n\n/* h2\u7684\u6837\u5f0f */\nh2 {\n    color: rgb(100,233,233);\n    margin-top: 1.25em; /* \u9876\u90e8\u95f4\u8ddd */\n    margin-bottom: 0.5em; /* \u5e95\u90e8\u95f4\u8ddd */\n}\n\n/* h3\u7684\u6837\u5f0f */\nh3 {\n    color: rgb(250, 100, 200);\n    margin-top: 1.25em; /* \u9876\u90e8\u95f4\u8ddd */\n    margin-bottom: 0.5em; /* \u5e95\u90e8\u95f4\u8ddd */\n}\n\n/* h4\u7684\u6837\u5f0f */\nh4 {\n    color: rgb(75,250,75);\n    margin-top: 1.25em; /* \u9876\u90e8\u95f4\u8ddd */\n    margin-bottom: 0.5em; /* \u5e95\u90e8\u95f4\u8ddd */\n}\n\n/* \u6bb5\u843d\u6837\u5f0f */\np {\n    margin-top: 1em; /* \u9876\u90e8\u95f4\u8ddd */\n    margin-bottom: 1em; /* \u5e95\u90e8\u95f4\u8ddd */\n    text-indent: 1.5em; /* \u9996\u884c\u7f29\u8fdb */\n}\n"}),"\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d",children:"\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6587\u4ef6\u5904\u7406\u7684\u5305",children:"\u6587\u4ef6\u5904\u7406\u7684\u5305"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"commons-io.jar"}),"\u5c01\u88c5\u4e86\u5e38\u7528\u7684 IO \u7684\u76f8\u5173\u64cd\u4f5c\uff0c\u63d0\u4f9b\u4e86",(0,i.jsx)(n.code,{children:"IOUtils"}),"\u5de5\u5177\u7c7b\u4f9b\u5f00\u53d1\u4eba\u5458\u4f7f\u7528"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"commons-fileupload.jar"}),"\u6587\u4ef6\u4e0a\u4f20\u7684\u5904\u7406\u5305\uff0c\u56e0\u4e3a\u6587\u4ef6\u4e0a\u4f20\u4e5f\u4f1a\u6d89\u53ca\u5230 IO \u64cd\u4f5c\uff0c\u56e0\u6b64\uff0c\u8be5\u5305\u9700\u8981\u914d\u5408",(0,i.jsx)(n.code,{children:"commons-io.jar"}),"\u4f7f\u7528\u3002"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"FileItemFactory"}),"\u6587\u4ef6\u9879\u5de5\u5382\uff0c\u4e3b\u8981\u63d0\u4f9b\u521b\u5efa\u6587\u4ef6\u9879\u7684\u529f\u80fd"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DiskFileItemFactory"}),"\u78c1\u76d8\u6587\u4ef6\u9879\u5de5\u5382\uff0c\u4e3b\u8981\u7528\u4e8e\u89e3\u6790\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u521b\u5efa\u5bf9\u5e94\u7684\u6587\u4ef6\u9879"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ServletFileUpload"})," ",(0,i.jsx)(n.code,{children:"Servlet"}),"\u6587\u4ef6\u4e0a\u4f20\u5bf9\u8c61\uff0c\u4e3b\u8981\u7528\u4e8e\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ee5\u53ca\u8bf7\u6c42\u4e2d\u7684\u5185\u5bb9\u89e3\u6790\u3002\u89e3\u6790\u65f6\u9700\u8981\u4f7f\u7528\u6587\u4ef6\u9879\u5de5\u5382\u6765\u521b\u5efa\u6587\u4ef6\u9879"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u6587\u4ef6\u4e0a\u4f20",children:"\u6587\u4ef6\u4e0a\u4f20"}),"\n",(0,i.jsx)(n.h3,{id:"form-\u8868\u5355\u4e0a\u4f20",children:"form \u8868\u5355\u4e0a\u4f20"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",metastring:"(jsp)",children:'<form action="upload" method="post" enctype="multipart/form-data">\n    <input type="file" name="file">\n    <input type="submit" value="\u4e0a\u4f20">\n</form>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u540e\u7aef"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package com.HX.jsp.servlet;\n\nimport org.apache.commons.compress.utils.IOUtils;\nimport org.apache.commons.fileupload.FileItem;\nimport org.apache.commons.fileupload.FileItemFactory;\nimport org.apache.commons.fileupload.disk.DiskFileItemFactory;\nimport org.apache.commons.fileupload.servlet.ServletFileUpload;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.*;\nimport java.util.List;\n\n@WebServlet(urlPatterns = "/upload")\npublic class UploadServet extends HttpServlet {\n    private static final String SAVE_PATH = "D:\\\\command\\\\java_cmd\\\\qwqTomCat\\\\Upload";\n\n    @Override\n    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        if (!ServletFileUpload.isMultipartContent(req)) {\n            throw new RuntimeException("\u672a\u53d1\u73b0multipart/form-data"); // \u6ca1\u6709\u4e0a\u4f20\u6587\u4ef6\n        }\n        FileItemFactory factory = new DiskFileItemFactory(); // \u78c1\u76d8\u6587\u4ef6\u9879\u5de5\u5382\uff0c\u4e3b\u8981\u7528\u4e8e\u89e3\u6790\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u521b\u5efa\u5bf9\u5e94\u7684\u6587\u4ef6\u9879\n        ServletFileUpload upload = new ServletFileUpload(factory); // \u6587\u4ef6\u4e0a\u4f20\u5bf9\u8c61\uff0c\u4e3b\u8981\u7528\u4e8e\u5224\u65ad\u8bf7\u6c42\u662f\u5426\u662f\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42\uff0c\u4ee5\u53ca\u8bf7\u6c42\u4e2d\u7684\u5185\u5bb9\u89e3\u6790\n        // \u6587\u4ef6\u4e0a\u4f20\u7684\u5934\u90e8\u4fe1\u606f\u7f16\u7801\u683c\u5f0f\u4e3aUTF-8\n        upload.setHeaderEncoding("UTF-8");\n        // \u6587\u4ef6\u4e0a\u4f20\u7684\u6700\u5927\u5927\u5c0f\u4e3a50M\n        upload.setSizeMax(1024 * 1024 * 50);\n        // \u5355\u4e2a\u6587\u4ef6\u6700\u5927\u5927\u5c0f\u4e3a5M\n        upload.setFileSizeMax(1024 * 1024 * 5);\n        boolean success = true;\n        try {\n            // \u89e3\u6790\u8bf7\u6c42\uff0c\u5f97\u5230form\u8868\u5355\u4e0a\u4f20\u7684\u6bcf\u4e00\u4e2a\u4e0e\u6587\u4ef6\u76f8\u5173\u7684\u9879\n            List<FileItem> fileItems = upload.parseRequest(req);\n\n            for (FileItem item : fileItems) {\n                if (item.isFormField()) { // \u5982\u679c\u662f\u8868\u5355\u5b57\u6bb5\n                    System.out.println(item.getName());\n                } else {\n                    File parent = new File(SAVE_PATH); // \u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u4f1a\u88ab\u4fdd\u5b58\u5230 tomcat \u7684 bin \u91cc\u9762\n                    if (!parent.exists()) {\n                        parent.mkdirs();\n                    }\n                    File file = new File(parent, item.getName());\n                    InputStream is = item.getInputStream();\n                    OutputStream os = new FileOutputStream(file);\n                    // \u4f7f\u7528commons-io\u5305\u63d0\u4f9b\u7684\u5de5\u5177\u7c7b\uff0c\u5c06\u8f93\u5165\u6d41\u4e2d\u7684\u4fe1\u606f\u62f7\u8d1d\u81f3\u8f93\u51fa\u6d41\uff0c\u4e5f\u5c31\u662f\u5199\u5165\u6587\u4ef6\n                    IOUtils.copy(item.getInputStream(), os);\n                    // \u5173\u95ed\u8f93\u5165\u6d41\n                    IOUtils.closeQuietly(is);\n                    // \u5173\u95ed\u8f93\u51fa\u6d41\n                    IOUtils.closeQuietly(os);\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n            success = false;\n        }\n        resp.setCharacterEncoding("UTF-8");\n        resp.setContentType("text/html;charset=utf-8");\n        PrintWriter writer = resp.getWriter();\n        writer.print(success ? "\u4e0a\u4f20\u6210\u529f" : "\u4e0a\u4f20\u5931\u8d25");\n        writer.flush();\n        writer.close();\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"ajax-\u6587\u4ef6\u4e0a\u4f20",children:"ajax \u6587\u4ef6\u4e0a\u4f20"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",metastring:"(jsp)",children:'<input type="file" id="file">\n<input type="button" value="\u4e0a\u4f20" id="uploadBtn">\n<script type="text/javascript">\n    $(() => {\n        $("#uploadBtn").click(() => {\n            let files = $("#file")[0].files;\n            if(files && files.length > 0){\n                // \u6a21\u62df\u8868\u5355\u6570\u636e\n                let formData = new FormData();\n                formData.append("file", files[0]);\n                $.ajax({\n                    url: \'upload\',\n                    type: \'post\',\n                    data: formData,\n                    processData: false, // \u544a\u8bc9jQuery\u4e0d\u8981\u5904\u7406\u6570\u636e\n                    contentType: false, // \u544a\u8bc9jQuery\u4e0d\u8981\u8bbe\u7f6e\u5185\u5bb9\u7684\u7c7b\u578b\n                    success: function (resp) {\n                        alert(resp);\n                    },\n                    error: function (error) {\n                    }\n                })\n            } else {\n                alert("\u8bf7\u9009\u62e9\u4e0a\u4f20\u6587\u4ef6");\n            }\n        });\n    });\n<\/script>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6587\u4ef6\u4e0b\u8f7d",children:"\u6587\u4ef6\u4e0b\u8f7d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",metastring:"(jsp)",children:'<a href="download?name=\u5b66\u4e60.png">\u4e0b\u8f7d: \u5b66\u4e60.png</a>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u540e\u7aef: 1. \u83b7\u53d6\u6587\u4ef6\u540d, 2. \u8bbe\u7f6e\u8fd4\u56de\u7c7b\u578b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package com.HX.jsp.servlet;\n\nimport org.apache.commons.compress.utils.IOUtils;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.*;\nimport java.nio.charset.StandardCharsets;\n\n@WebServlet(urlPatterns = "/download")\npublic class DownloadServet extends HttpServlet {\n    private static final String DOWNLOAD_PATE = "E:\\\\\u56fe\u7247";\n\n    @Override // \u9ed8\u8ba4 <a> \u662f get \u8bf7\u6c42\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String name = req.getParameter("name");              // \u83b7\u53d6\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\n        File file = new File(DOWNLOAD_PATE, name);           // \u5b9a\u4f4d\u4e0b\u8f7d\u7684\u6587\u4ef6\n        byte[] data = name.getBytes(StandardCharsets.UTF_8); // \u83b7\u53d6\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\u7684\u5b57\u8282\u6570\u636e\n        // \u8f6c\u6362\u7f16\u7801\u683c\u5f0f\uff0c\u91cd\u65b0\u6784\u5efa\u5b57\u7b26\u4e32\uff0c\u56e0\u4e3a\u6d4f\u89c8\u5668\u9ed8\u8ba4\u652f\u6301\u7684\u7f16\u7801\u662fISO_8859_1,\u56e0\u6b64\uff0c\u8981\u8f6c\u6362\u4e3a\u8fd9\u79cd\u7f16\u7801\u4e0b\u4e2d\u6587\u624d\u80fd\u6b63\u5e38\u663e\u793a\n        name = new String(data, StandardCharsets.ISO_8859_1);\n        // \u8bbe\u7f6e\u5185\u5bb9\u5904\u7406\u65b9\u6848: \u4ee5\u9644\u4ef6\u7684\u5f62\u5f0f\u5904\u7406\n        resp.setHeader("Content-Disposition", "attachment;filename="+name);\n        OutputStream os = resp.getOutputStream();\n        InputStream is = new FileInputStream(file);\n        IOUtils.copy(is, os);\n        IOUtils.closeQuietly(is);\n        IOUtils.closeQuietly(os);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"excel-\u5904\u7406",children:"Excel \u5904\u7406"}),"\n",(0,i.jsxs)(n.h2,{id:"easyexcel-\u4ecb\u7ecd",children:[(0,i.jsx)(n.code,{children:"EasyExcel"})," \u4ecb\u7ecd"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"EasyExcel"}),"\u662f\u963f\u91cc\u5df4\u5df4\u5f00\u6e90\u7684\u4e00\u4e2a Excel \u5904\u7406\u6846\u67b6\uff0c\u4ee5\u4f7f\u7528\u7b80\u5355\u3001\u8282\u7701\u5185\u5b58\u8457\u79f0\u3002",(0,i.jsx)(n.code,{children:"EasyExcel"}),"\u80fd\u5927\u5927\u51cf\u5c11\u5360\u7528\u5185\u5b58\u7684\u4e3b\u8981\u539f\u56e0\u662f\u5728\u89e3\u6790 Excel \u65f6\u6ca1\u6709\u5c06\u6587\u4ef6\u6570\u636e\u4e00\u6b21\u6027\u5168\u90e8\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u662f\u4ece\u78c1\u76d8\u4e0a\u4e00\u884c\u884c\u8bfb\u53d6\u6570\u636e\uff0c\u9010\u4e2a\u89e3\u6790\u3002"]}),"\n",(0,i.jsxs)(n.h2,{id:"easyexcel-\u751f\u6210-excel",children:[(0,i.jsx)(n.code,{children:"EasyExcel"})," \u751f\u6210 Excel"]}),"\n",(0,i.jsx)(n.p,{children:"\u5b58\u653e\u5b66\u751f\u6570\u636e\u7c7b, \u5e76\u4e14\u548cExcel\u5185\u5bb9\u5173\u8054"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package com.HX.jsp.pojo;\n\nimport com.alibaba.excel.annotation.ExcelProperty;\n\npublic class ExcelStu {\n    // ExcelProperty \u8868\u793a\u5728\u751f\u6210\u7684Excel\u8868\u683c\u4e2d\u7684\u5c5e\u6027, value\u8868\u793a\u8be5\u5c5e\u6027\u5bf9\u5e94\u7684\u8868\u5934\u540d\u79f0, index\u8868\u793a\u8be5\u5c5e\u6027\u6240\u5904\u7684\u5217\u7684\u4f4d\u7f6e\n    @ExcelProperty(value = "\u73ed\u7ea7", index = 0)\n    private String className;\n    @ExcelProperty(value = "\u59d3\u540d", index = 1)\n    private String name;\n    @ExcelProperty(value = "\u5206\u6570", index = 2)\n    private int fraction;\n    // toString / get / set / \u6784\u9020\u51fd\u6570(\u8bb0\u5f97\u8981\u6709\u65e0\u53c2\u6784\u9020, \u4e0b\u9762\u6ca1\u6709\u4f1a\u62a5\u9519) \u7565\n}    \n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5199\u5165"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package com.HX.jsp.excel;\n\nimport com.HX.jsp.pojo.ExcelStu;\nimport com.alibaba.excel.EasyExcel;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class ExcelUtil {\n    private static final String EXCEL_PATH = "E:/\u5b66\u751f\u6210\u7ee9.xlsx";\n\n    public static void main(String[] args) {\n        List<ExcelStu> stus = new ArrayList<>();\n        for(int i = 1; i <= 10; ++i) { // \u641e\u70b9\u5047\u6570\u636e\n            ExcelStu excelStu = new ExcelStu("\u8ba1\u79d1" + i + "\u73ed", "\u5f20" + i, 100 + i);\n            stus.add(excelStu);\n        }\n        EasyExcel.write(EXCEL_PATH, ExcelStu.class) // \u4fdd\u5b58\u7684\u8def\u5f84, \u5199\u5165\u7684\u7c7b\u7684\u7c7b\u578b\n                .sheet("\u7528\u6237\u4fe1\u606f\u8868") // \u8868\u540d\u79f0\n                .doWrite(stus); // \u5199\u5165\u5bb9\u5668\u5185\u5bb9\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u63d0\u53d6\u65b9\u6cd5 + (\u5916\u89c2\u6a21\u5f0f)\u5c01\u88c5\u4e00\u4e0b:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class ExcelUtil {\n    private static final String EXCEL_PATH = "E:/\u5b66\u751f\u6210\u7ee9.xlsx";\n\n    public static void main(String[] args) {\n        List<ExcelStu> stus = new ArrayList<>();\n        for(int i = 1; i <= 10; ++i) {\n            ExcelStu excelStu = new ExcelStu("\u8ba1\u79d1" + i + "\u73ed", "\u5f20" + i, 100 + i);\n            stus.add(excelStu);\n        }\n\n        generateExcel(EXCEL_PATH, "\u5b66\u751f\u6210\u7ee9", ExcelStu.class, stus);\n    }\n\n    /**\n     * \u751f\u6210Excel\u8868\u683c (\u5982\u679c\u8def\u5f84\u76f8\u540c, \u5219\u4e3a\u8986\u76d6\u539f\u5185\u5bb9!)\n     * @param path \u751f\u6210\u7684\u8def\u5f84\n     * @param sheetName \u8868(sheet)\u540d\u79f0\n     * @param clazz \u5b58\u50a8\u7684\u6570\u636e\u7c7b\u578b\n     * @param data \u5b58\u50a8\u7684\u6570\u636e\n     * @param <T>\n     */\n    public static<T> void generateExcel(String path, String sheetName, Class<T> clazz, List<T> data) {\n        EasyExcel.write(path, clazz) // \u4fdd\u5b58\u7684\u8def\u5f84, \u5199\u5165\u7684\u7c7b\u7684\u7c7b\u578b\n                .sheet(sheetName)    // \u8868\u540d\u79f0\n                .doWrite(data);      // \u5199\u5165\u5bb9\u5668\u5185\u5bb9\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"easyexcel-\u89e3\u6790-excel",children:[(0,i.jsx)(n.code,{children:"EasyExcel"})," \u89e3\u6790 Excel"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u89e3\u6790Excel\n// \u8bfb\u53d6\u76d1\u542c\u5668, \u6bcf\u4e00\u884c\u8bfb\u53d6\u52a8\u4f5c\u90fd\u4f1a\u88ab\u76d1\u542c\nReadListener<ExcelStu> readListener = new ReadListener<ExcelStu>() {\n    @Override\n    public void invoke(ExcelStu excelStu, AnalysisContext analysisContext) {\n        System.out.println("\u8bfb\u53d6\u4e86\u4e00\u884c: " + excelStu.toString());\n    }\n\n    @Override\n    public void doAfterAllAnalysed(AnalysisContext analysisContext) {\n        System.out.println("\u8bfb\u53d6\u7ed3\u675f!");\n    }\n};\n\n// \u8bfb\u53d6\u7ed9\u5b9a\u7684Excel, \u8bfb\u53d6\u7684\u5185\u5bb9\u8f6c\u6362\u4e3aExcelStu\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8bfb\u53d6\u65f6\u4f7f\u7528readListener\u8fdb\u884c\u76d1\u542c\nEasyExcel.read(EXCEL_PATH, ExcelStu.class, readListener)\n        .sheet() // sheet()\u65b9\u6cd5, \u4e0d\u6307\u5b9a\u540d\u79f0, \u5219\u8868\u793a\u8bfb\u53d6\u6240\u6709\u7684sheet\n        .doRead(); // doRead() \u8868\u793a\u8868\u793a\u6267\u884c\u8bfb\u53d6\u52a8\u4f5c [\u6ce8: \u9700\u8981ExcelStu\u6709\u65e0\u53c2\u6784\u9020!]\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5c01\u88c5\u4e00\u4e0b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u89e3\u6790Excel\nList<ExcelStu> excelStuList = parseExcel(EXCEL_PATH, null, ExcelStu.class);\n\n/**\n * \u8bfb\u53d6Excel\u8868\u683c\n * @param path \u8bfb\u53d6\u7684\u8def\u5f84\n * @param sheetName \u8bfb\u53d6\u7684\u8868(sheet)\u7684\u540d\u79f0, \u8bfb\u53d6\u5168\u90e8\u5219\u586b null\n * @param clazz \u8bfb\u53d6\u7684\u6570\u636e\u7684\u7c7b\u578b\n * @param <T>\n * @return \u89e3\u6790\u5f97\u5230\u7684\u6570\u636e\n */\npublic static<T> List<T> parseExcel(String path, String sheetName, Class<T> clazz) {\n    List<T> res = new ArrayList<>();\n    // \u8bfb\u53d6\u76d1\u542c\u5668, \u6bcf\u4e00\u884c\u8bfb\u53d6\u52a8\u4f5c\u90fd\u4f1a\u88ab\u76d1\u542c\n    ReadListener<T> readListener = new ReadListener<T>() {\n        @Override\n        public void invoke(T t, AnalysisContext analysisContext) {\n            // System.out.println("\u8bfb\u53d6\u4e86\u4e00\u884c: " + t.toString());\n            res.add(t);\n        }\n\n        @Override\n        public void doAfterAllAnalysed(AnalysisContext analysisContext) {\n            // System.out.println("\u8bfb\u53d6\u7ed3\u675f!");\n        }\n    };\n\n    // \u8bfb\u53d6\u7ed9\u5b9a\u7684Excel, \u8bfb\u53d6\u7684\u5185\u5bb9\u8f6c\u6362\u4e3aExcelStu\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8bfb\u53d6\u65f6\u4f7f\u7528readListener\u8fdb\u884c\u76d1\u542c\n    EasyExcel.read(path, clazz, readListener)\n            .sheet(sheetName) // sheet()\u65b9\u6cd5, \u4e0d\u6307\u5b9a\u540d\u79f0, \u5219\u8868\u793a\u8bfb\u53d6\u6240\u6709\u7684sheet\n            .doRead(); // doRead() \u8868\u793a\u8868\u793a\u6267\u884c\u8bfb\u53d6\u52a8\u4f5c\n    return res;\n}\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"easyexcel-\u5bfc\u5165\u5bfc\u51fa",children:[(0,i.jsx)(n.code,{children:"EasyExcel"})," \u5bfc\u5165\u5bfc\u51fa"]}),"\n",(0,i.jsx)(n.p,{children:"\u56e0\u4e3a\u6211\u4eec\u7f51\u7edc\u662f\u4f7f\u7528io\u6d41\u6765\u4f20\u8f93\u7684, \u6240\u4ee5\u4e0a\u4f20\u548c\u4e0b\u8f7d\u4e5f\u5e94\u8be5\u4f7f\u7528\u6d41"}),"\n",(0,i.jsx)(n.p,{children:"\u6240\u4ee5\u8fd8\u9700\u8981\u5c01\u88c5:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class ExcelUtil {\n    private static final String EXCEL_PATH = "E:/\u5b66\u751f\u6210\u7ee9.xlsx";\n\n    private static final int SHEET_MAX_SIZE = 3; // \u5355\u4e2a\u8868\u7684\u6700\u5927\u5185\u5bb9\u91cf\n\n    public static void main(String[] args) throws IOException {\n        List<ExcelStu> stus = new ArrayList<>();\n        for(int i = 1; i <= 10; ++i) {\n            ExcelStu excelStu = new ExcelStu("\u8ba1\u79d1" + i + "\u73ed", "\u5f20" + i, 100 + i);\n            stus.add(excelStu);\n        }\n\n        writeExcel("\u6210\u7ee9", new FileOutputStream(EXCEL_PATH), ExcelStu.class, stus);\n\n        readExcel(new FileInputStream(new File(EXCEL_PATH)), ExcelStu.class);\n    }\n\n    /**\n     * \u8bfb\u53d6\u8f93\u5165\u6d41\u4e2d\u7684\u6570\u636e\n     * @param is \u8f93\u5165\u6d41\n     * @param clazz \u7c7b\u578b\n     * @return \u8bfb\u53d6\u5230\u7684\u6570\u636e\u7684 ArrayList\n     * @param <T>\n     */\n    public static<T> List<T> readExcel(InputStream is, Class<T> clazz) {\n        List<T> res = new ArrayList<>();\n        // \u8bfb\u53d6\u76d1\u542c\u5668, \u6bcf\u4e00\u884c\u8bfb\u53d6\u52a8\u4f5c\u90fd\u4f1a\u88ab\u76d1\u542c\n        ReadListener<T> readListener = new ReadListener<T>() {\n            @Override\n            public void invoke(T t, AnalysisContext analysisContext) {\n                System.out.println("\u8bfb\u53d6\u4e86\u4e00\u884c: " + t.toString());\n                res.add(t);\n            }\n\n            @Override\n            public void doAfterAllAnalysed(AnalysisContext analysisContext) {\n                System.out.println("\u8bfb\u53d6\u4e00\u4e2asheet\u7ed3\u675f!");\n            }\n        };\n\n        EasyExcel.read(is, readListener).doReadAll();\n\n        return res;\n    }\n\n    /**\n     * \u5c06List\u7684\u6570\u636e\u5199\u5165\u5230\u8f93\u51fa\u6d41\n     * @param sheetName \u8868\u540d\n     * @param os \u8f93\u51fa\u6d41\n     * @param clazz \u4fdd\u5b58\u6570\u636e\u7684\u7c7b\u578b\n     * @param data \u6570\u636e\n     * @param <T>\n     */\n    public static<T> void writeExcel(String sheetName, OutputStream os, Class<T> clazz, List<T> data) throws IOException {\n        ExcelWriter excelWriter = EasyExcel.write(os, clazz).build();\n        int sheet_count = data.size() / SHEET_MAX_SIZE + (data.size() % SHEET_MAX_SIZE == 0 ? 0 : 1); // \u5206\u8868\n        for (int i = 0; i < sheet_count; ++i) {\n            WriteSheet sheet = new WriteSheet();\n            sheet.setSheetNo(i);\n            sheet.setSheetName(sheetName + (i + 1));\n            int start = i * SHEET_MAX_SIZE;\n            int end = (i + 1) * SHEET_MAX_SIZE;\n            if (end > data.size())\n                end = data.size();\n            excelWriter.write(data.subList(start, end), sheet);\n        }\n        excelWriter.finish();\n        os.close();\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4fee\u6539\u4e3a\u4ece\u670d\u52a1\u5668\u4e0b\u8f7dExcel (\u76f4\u63a5\u4ece\u4e4b\u524d\u4e0b\u8f7d\u6587\u4ef6\u7684\u4ee3\u7801\u4e2d\u8fdb\u884c\u4fee\u6539\u4e86)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@WebServlet(urlPatterns = "/download")\npublic class DownloadServet extends HttpServlet {\n    private static final String DOWNLOAD_PATE = "E:\\\\";\n\n    @Override // \u9ed8\u8ba4 <a> \u662f get \u8bf7\u6c42\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String name = req.getParameter("name");           // \u83b7\u53d6\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\n        File file = new File(DOWNLOAD_PATE, name);          // \u5b9a\u4f4d\u4e0b\u8f7d\u7684\u6587\u4ef6\n        byte[] data = name.getBytes(StandardCharsets.UTF_8); // \u83b7\u53d6\u4e0b\u8f7d\u7684\u6587\u4ef6\u540d\u7684\u5b57\u8282\u6570\u636e\n        // \u8f6c\u6362\u7f16\u7801\u683c\u5f0f\uff0c\u91cd\u65b0\u6784\u5efa\u5b57\u7b26\u4e32\uff0c\u56e0\u4e3a\u6d4f\u89c8\u5668\u9ed8\u8ba4\u652f\u6301\u7684\u7f16\u7801\u662fISO_8859_1,\u56e0\u6b64\uff0c\u8981\u8f6c\u6362\u4e3a\u8fd9\u79cd\u7f16\u7801\u4e0b\u4e2d\u6587\u624d\u80fd\u6b63\u5e38\u663e\u793a\n        name = new String(data, StandardCharsets.ISO_8859_1);\n        // \u8bbe\u7f6e\u5185\u5bb9\u5904\u7406\u65b9\u6848: \u4ee5\u9644\u4ef6\u7684\u5f62\u5f0f\u5904\u7406\n        resp.setHeader("Content-Disposition", "attachment;filename="+name);\n        OutputStream os = resp.getOutputStream();\n\n        // \u5e94\u8be5\u662f\u901a\u8fc7\u6570\u636e\u5e93\u64cd\u4f5c\u5f97\u5230 List (\u6b64\u5904\u662f\u6a21\u62df\u4ece\u6570\u636e\u5e93\u83b7\u53d6\u6570\u636e\u7684\u8fc7\u7a0b)\n        List<ExcelStu> stus = ExcelUtil.readExcel(new FileInputStream(file), ExcelStu.class);\n        ExcelUtil.writeExcel("\u6210\u7ee9", os, ExcelStu.class, stus);\n\n//        InputStream is = new FileInputStream(file);\n//        IOUtils.copy(is, os);\n//        IOUtils.closeQuietly(is);\n        IOUtils.closeQuietly(os);\n    }\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);