<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-程序语言/C++/现代C++/现代OpenGL/三维模型的加载与相机控制/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">三维模型的加载与相机控制 | HXLoLi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://HengXin666.github.io/HXLoLi/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://HengXin666.github.io/HXLoLi/img/logo.png"><meta data-rh="true" property="og:url" content="https://HengXin666.github.io/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/三维模型的加载与相机控制"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="三维模型的加载与相机控制 | HXLoLi"><meta data-rh="true" name="description" content="一、回顾三角形大作"><meta data-rh="true" property="og:description" content="一、回顾三角形大作"><link data-rh="true" rel="icon" href="/HXLoLi/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://HengXin666.github.io/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/三维模型的加载与相机控制"><link data-rh="true" rel="alternate" href="https://HengXin666.github.io/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/三维模型的加载与相机控制" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://HengXin666.github.io/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/三维模型的加载与相机控制" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/HXLoLi/blog/rss.xml" title="HXLoLi RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/HXLoLi/blog/atom.xml" title="HXLoLi Atom Feed"><link rel="stylesheet" href="/HXLoLi/assets/css/styles.5448a2bb.css">
<script src="/HXLoLi/assets/js/runtime~main.f4aa7635.js" defer="defer"></script>
<script src="/HXLoLi/assets/js/main.fd09aab3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/HXLoLi/img/logo.png"><link rel="preload" as="image" href="/HXLoLi/default-icons/default_folder.svg"><link rel="preload" as="image" href="/HXLoLi/icons/ISO_C++_Logo.svg"><link rel="preload" as="image" href="/HXLoLi//default-icons/alipay.svg"><link rel="preload" as="image" href="/HXLoLi//img/alipay_qr_code.png"><link rel="preload" as="image" href="/HXLoLi//default-icons/wechat.svg"><link rel="preload" as="image" href="/HXLoLi//img/wechat_qr_code.png"><link rel="preload" as="image" href="/HXLoLi//default-icons/cc.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/HXLoLi/"><div class="navbar__logo"><img src="/HXLoLi/img/logo.png" alt="HXLoLi Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/HXLoLi/img/logo.png" alt="HXLoLi Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">HXLoLi</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/HXLoLi/docs/关于">笔记</a><a class="navbar__item navbar__link" href="/HXLoLi/blog">博客</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">更多</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/HXLoLi/blog/archive">归档</a></li><li><a href="https://github.com/HengXin666/HXLoLi" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/HXLoLi/"><img src="/HXLoLi/img/logo.png" alt="HXLoLi Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/HXLoLi/img/logo.png" alt="HXLoLi Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>HXLoLi</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/HXLoLi/docs/关于">关于</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/计佬常識/数据结构与算法/【algorithm】目録"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>计佬常識</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" style="font-size:14px" href="/HXLoLi/docs/程序语言/C++/【C艹】目录大纲"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>程序语言</div></div></div></a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/【C艹】目录大纲"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/icons/ISO_C++_Logo.svg" style="width:24px;margin-right:5px"></div><div>C++</div></div><div style="flex:1"><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">高性能</span></div></div></a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/HXLoLi/docs/程序语言/C++/【C艹】目录大纲">【C艹】目录大纲</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/tmp丶C++丶memo/C++基础/面向对象/基本语法"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>tmp丶C++丶memo</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++笔记目录"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代C++</div></div><div style="flex:1"><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">现代C++</span><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">C++最佳实践</span></div></div></a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++笔记目录">现代C++笔记目录</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/高性能并行编程与优化/一、学C++从CMake学起"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>高性能并行编程与优化</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++项目实战/什么情况下需要封装get和set"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代C++项目实战</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++元模版/CRTP-静态多态"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代C++元模版</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++网络编程/io丶uring"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代C++网络编程</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++协程/【C++】从开始自制协程库,有手就行"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代C++协程</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代C++QT/小彭老师丶Qt入门系列/简简单单开发个记事本，需要用到Qt哪些功能？"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代C++QT</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/初识OpenGL"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>现代OpenGL</div></div><div style="flex:1"><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">图形学</span><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">渲染</span></div></div></a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/初识OpenGL">初识OpenGL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/三维模型的加载与相机控制">三维模型的加载与相机控制</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/源码阅读/雅兰亭库/C++无宏反射研究"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>源码阅读</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/现代C++/环境搭建/vscode相关"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>环境搭建</div></div></div></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/CMake/认识并编写第一个CMake"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>CMake</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/C++第三方库/Protobuf/protobuf安装"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>C++第三方库</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/C++八嘎日志/链接属性/多文件下模版使用"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>C++八嘎日志</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/C++代码规范/开发规范"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>C++代码规范</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/C++/大项目/大项目/开发笔记/工程介绍"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>大项目</div></div></div></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/Java/🐒Java从入门到开溜🐒"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>Java</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/Python/第三方库/Jupyter丶Notebook/Python安装JupyterNotebook配置使用教程"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>Python</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" tabindex="0" href="/HXLoLi/docs/程序语言/Web前端/Web前端目録"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>Web前端</div></div></div></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/游戏引擎/虚幻引擎/【虚幻】目录"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>游戏引擎</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/DevOps与版本控制/Linux/【Linux】目录"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>DevOps与版本控制</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/中间件/Redis/【Redis】目录"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>中间件</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/数据库/MySQL数据库/とある「MySQL」の禁庫目録"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>数据库</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/刷题日志/做题记录"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>刷题日志</div></div><div style="flex:1"><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">刷题</span><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">就业</span><span style="margin-right:8px;padding-left:5px;padding-right:5px;font-size:12px;border-radius:6px;color:#ffffff;background-color:#990099;box-shadow:2px 2px 4px 1px rgba(255, 255, 255, 0.5);white-space:nowrap">竞赛</span></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/嵌入式/杂项/IC通信"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>嵌入式</div></div></div></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" style="font-size:14px" href="/HXLoLi/docs/Game/MineCraft/服务器/脚本"><div style="display:flex;flex-direction:column"><div style="flex:1;display:flex;align-items:center;flex-direction:row"><div><img src="/HXLoLi/default-icons/default_folder.svg" style="width:24px;margin-right:5px"></div><div>Game</div></div></div></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/HXLoLi/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">程序语言</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">C++</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">现代C++</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">现代OpenGL</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">三维模型的加载与相机控制</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>三维模型的加载与相机控制</h1></header>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="一回顾三角形大作">一、回顾三角形大作<a href="#一回顾三角形大作" class="hash-link" aria-label="一、回顾三角形大作的直接链接" title="一、回顾三角形大作的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11-三角形大作存在的问题">1.1 三角形大作存在的问题<a href="#11-三角形大作存在的问题" class="hash-link" aria-label="1.1 三角形大作存在的问题的直接链接" title="1.1 三角形大作存在的问题的直接链接">​</a></h3>
<p>之前(第一章)的三角形大作, 顶点信息是写死在代码上的, 如果我们要新增一个点, 就需要重新调用一遍 <code>glVertex3f</code>, 非常的不方便! 而且还要重新编译!</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">glBegin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>如何另数据与程序解耦呢?</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12-动态存储">1.2 动态存储<a href="#12-动态存储" class="hash-link" aria-label="1.2 动态存储的直接链接" title="1.2 动态存储的直接链接">​</a></h3>
<p>我们可以把顶点信息存储在 <code>std::vector</code> 中, 这样绘制的时候, 就支持动态数量个顶点啦:</p>
<!-- -->
<!-- -->
<p>这样我们可以实现点击屏幕, 选择3个点, 然后画三角形:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;check/OpenGL.hpp&gt;</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property comment" style="color:hsl(220, 10%, 40%)">// 包括 glad/glad.h</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;GLFW/glfw3.h&gt;</span><span class="token macro property" style="color:hsl(355, 65%, 65%)">     </span><span class="token macro property comment" style="color:hsl(220, 10%, 40%)">// 必须放在 glad/glad.h 后面</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;vector&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">Vertex</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">Vertex</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">show</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glBegin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">mouseBtnCb</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> win</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> btn</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> mods</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 判断是鼠标 &amp;&amp; 左键按下</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">btn </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_MOUSE_BUTTON_LEFT </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span class="token plain"> action </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> xpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 获取鼠标坐标</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetCursorPos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">win</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">xpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 获取窗口大小</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">win</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 映射到 [-1, 1], 除以对应的宽、高, 以保证宽高比</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">static_cast</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> xpos </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 注意因为窗口坐标是左上原点, y 正轴向下, 所以 转换需要 height - ypos</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">static_cast</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 比如 xpos / width 是把 [0, width] -&gt; [0, 1]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// *2 - 1 是把 [0, 1] -&gt; [-1, 1]</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">main</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwInit</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">throw</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">runtime_error</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;failed to initialize GLFW&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwCreateWindow</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">960</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">720</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Example&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token constant" style="color:hsl(29, 54%, 61%)">NULL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token constant" style="color:hsl(29, 54%, 61%)">NULL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwTerminate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">throw</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">runtime_error</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;GLFW failed to create window&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwMakeContextCurrent</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">gladLoadGL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwTerminate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">  </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 由于 glfwInit 在前, 理论上是需要配套的 glfwTerminate 防止泄漏</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">throw</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">runtime_error</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;GLAD failed to load GL functions&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">debug</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;OpenGL version: &quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glGetString</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_VERSION</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 初始化完毕, 打印一下版本号</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_POINT_SMOOTH</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_BLEND</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glBlendFunc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_SRC_ALPHA</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GL_ONE_MINUS_SRC_ALPHA</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glPointSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">64.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSetMouseButtonCallback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> mouseBtnCb</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 设置鼠标事件回调</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwWindowShouldClose</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">show</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSwapBuffers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 双缓冲</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwPollEvents</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13-由点到面-从顶点数组到任意三角形面的数组">1.3 由点到面: 从顶点数组到任意三角形面的数组<a href="#13-由点到面-从顶点数组到任意三角形面的数组" class="hash-link" aria-label="1.3 由点到面: 从顶点数组到任意三角形面的数组的直接链接" title="1.3 由点到面: 从顶点数组到任意三角形面的数组的直接链接">​</a></h3>
<!-- -->
<!-- -->
<p>我们变动其中一个点, 发现:</p>
<p><img decoding="async" loading="lazy" alt="变动点 ##w400##" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtUAAAIICAIAAAAucYXNAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAPsUlEQVR4nO3dyXIbSRZFQVb//z+zF5SxSgQI5BDDG9xXWsqIzNCxuBL08QEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQyz+7fwNw2ufn59cv/vnHAwyQkuOblL4T5JEoAYjPSU1WLxLkkSgBCMWhTGKnEuSRKAHYxflLbjcT5AdFArCG05b0xibII1ECMJyDlQpmJ8gjUQJwhzOUItYnyA+KBOA4JyZ1bE+QR6IE4CmHI3UE7I+nRAmAc5BSsiTII1ECtOLIo5q8CfKDIgEKc8BRUJkEeSRKgBqcZdRUOEEeiRIgHccWZbVKkEeiBIjMCUVlzRPkB0UCxOE8ojgJ8pooAbZw9FCfBDlLlACzOWWoT3/cp0iAsZwptCBBZhAlwGWOD7qQIGuIEuAIJwWNSJBdRAnwg0OBXiRIEIoEmnME0I4ECUuUQB/edjqSIImIEijJi01TEiQ1UQLZeYfpS4JUokggF28srUmQ2kQJhOXlpDX90ZAogQi8h3QnQVAksJ63DiQIT4gSmMoLBh8fEoRjRAmM4l2CPyQI14gSuMBrA/+SIAyhSOAtLwn8RYIwiSiB//I+wE8ShGVECW159OEJCcJGooQOPOXwhP4gFEVCPZ5peE6CEJwoITWPL/xKgpCOKCELTyq8IkHITpEQk+cS3pAg1CNK2M4jCO9JEDoQJazkaYNDJAg9iRIm8WDBURIEPhQJg3iM4AQJAk+JEs7yxMAJ+gOOEyW84OGAcyQI3CFK+OI5gNMkCAykSHryqcMVEgSmEiXl+YDhIgkCi4mSSnyWcJ0Egb0USV4+ObhFgkA0oiQFHxLcJUEgPlESjc8DBpAgkJEo2ciPfp3Pz0/PelX6A1JzOK/3v92/gV78KVWVwwvgFP2xmgSpSoIAHKc/Nvj8/FQhJUkQgIP0xzYSpCQJAnCE/thJgpQkQQDe0h+b2WJKkiAAr+mPECRIPRIE4AX9EYUEqUeCAPxGfwRii6lHggA8pT/CkSAAlKc/IpIglbgCAXikP4KyxVQiQQB+0B+hSZAyJAjAf+mP6CRIGRIE4Jv+SMAWU4YEAfiiP9KQIDVIEIAP/ZGLBKlBggDoj2RsMTVIEKA5/ZGSBAEgNf2RlQTJzhUI0Jn+SMwWk50EAdrSH+lJkNQkCNCT/qhAgqQmQYCG9EcRtpjUJAjQjf4oRYLkJUGAVvRHNRIkLwkC9KE/CrLF5CVBgCb0R1kSBICw9EdlEiQjVyBAB/qjOFtMRhIEKE9/tCBB0pEgQG36owsJko4EAQrTH43YYtKRIEBV+qMdCZKLBAFK0h8dSZBcJAhQj/5oyhaTiwQBitEfrUkQALbQH91JkCxcgQCV6A9sMWlIEKAM/cEfEiQFCQLUoD/4lwRJQYIABegP/mKLSUGCANnpD56QIPFJECA1/cFzEiQ+CQLkpT/4lS0mPgkCJKU/eEOCADCc/uA9CRKZKxAgI/3BIbaYyCQIkI7+4AQJEpYEAXLRH5wjQcKSIEAi+oPTbDFhSRAgC/3BRRIkJgkCpKA/uE6CxCRBgPj0B7fYYmKSIEBw+oMBJEhAEgSITH8whgQB4Dj9wTC2mGhcgQBh6Q8GkyChSBAgJv3BeBIkFAkCBKQ/mMIWE4oEAaLRH0wkQeKQIEAo+oO5JEgcEgSIQ38wnS0mDgkCBKE/WESCBCFBgAj0B+tIEAC+6A+WssVE4AoE2E5/sIEE2U6CAHvpD/aQINtJEGAj/cE2tpjtJAiwi/5gMwmylwQBttAf7CdB9pIgwHr6gxBsMXtJEGAx/UEgEmQjCQKspD+IRYIAdKA/CMcWs4srEGAZ/UFQEmQLCQKsoT+IS4JsIUGABfQHodlitpAgwGz6gwQkyHoSBJhKf5CDBFlPggDz6A/SsMWsJ0GASfQHyUiQxSQIMIP+IB8JApCd/iAlW8xKrkCA4fQHiUmQZSQIMJb+IDcJsowEAQbSH6Rni1lGggCj6A+KkCBrSBBgCP1BHRJkDQkC3Kc/KMUWs4YEAW7SHxQkQRaQIMAd+oOaJMgCEgS4TH9Qli0GICz9QXESZCpXIMA1+oP6JMhUEgS4QH/Qgi1mKgkCnKU/aESCzCNBgFP0B71IkHkkCHCc/qAdW8w8EgQ4SH/QlASZRIIAR+gP+pIgk0gQ4C39QWu2GIAt9Ae4CBnPFQjwmv6Ajw8JMoEEAV7QH/CHLWY4CQL8Rn/AXyTIWBIEeEp/wE8SZCwJAjzSH/CELWYsCQL8oD/gVxJkIAkC/Jf+gFckyEASBPimP+ANWwzAcPoDDpEgQ7gCAb7oDzhKggwhQYAP/QGn2GKGkCCA/oDTJMh9EgSa0x9whQS5T4JAZ/oDLrLF3CdBoC39AbdIkJskCPSkP+AuCXKTBIGG9AcMYIsBOEV/wDAS5DJXINCN/oCRJMhlEgRa0R8wmC3mMgkCfegPmEKCXCNBoAn9AbNIkGskCHSgP2AiW8w1EgTK0x8wnQS5QIJAbfoDVpAgF0gQKEx/wCK2GIBv+gOWkiCnuAKBqvQHrCZBTpEgUJL+gA1sMadIEKhHf8A2EuQ4CQLF6A/YSYIcJ0GgEv0Bm9lijpMgUIb+gBAkyEESBGrQHxCFBDlIgkAB+gMCscUcJEEgO/0B4UgQoDz9ARFJkLdcgUBq+gOCssW8JUEgL/0BoUmQ1yQIJKU/IDoJ8poEgYz0ByRgi3lNgkA6+gPSkCAvSBDIRX9AJhLkBQkCiegPSMYW84IEgSz0B6QkQYDU9AdkJUGecgUCKegPSMwW85QEgfj0B6QnQR5JEAhOf0AFEuSRBIHI9AcUYYt5JEEgLP0BpUiQHyQIxKQ/oBoJ8oMEgYD0BxRki/lBgkA0+gPKkiBAWPoDKpMg31yBQCj6A4qzxXyTIBCH/oAWJMgXCQJB6A/oQoJ8kSAQgf6ARmwxXyQIbKc/oB0J8iFBYDf9AR1JkA8JAlvpD2jKFvMhQWAf/QGtSRBgC/0B3TVPEFcgsIX+ALpvMRIE1tMfwB8SBFhGfwD/kiDAGvoD+EvnLUaCwDL6A3hCggBT6Q/gOQkCzKM/gF+13WIkCMymP4A3JAgwnP4A3uuZIMA8+gM4pOEW4woE5tEfwAkSBBhCfwDnSBDgPv0BnNZti5EgMJz+AC6SIMBl+gO4ToIA1+gP4JZWW4wEgVH0BzCABAFO0R/AGH0SBLhPfwDDNNliXIHAffoDGEyCAG/pD2A8CQK8pj+AKTpsMRIELtMfwEQSBHhKfwBzSRDgkf4Apiu/xUgQOEt/AItIEOCb/gDWqZ0gwHH6A1iq8BbjCgSO0x/ABhIEmtMfwB4SBDrTH8A2VbcYCQJv6Q9gMwkCDekPYD8JAt3oDyCEkluMBIHf6A8gEAkCTegPIJZ6CQI80h9AOMW2GFcg8Eh/AEFJEChMfwBxSRCoSn8AoVXaYiQIfNMfQAISBIrRH0AOEgQq0R9AGmW2GAkC+gNIRoJAAfoDyKdGgkBn+gNIqcAW4wqEzvQHkJgEgaT0B5CbBIGM9AeQXvYtRoLQkP4AipAgkIj+AOqQIJCF/gBKSb3FSBD60B9AQRIEgtMfQE0SBCLTH0BZqbcYqE1/AMVlTBBXIJSnP4D6JAhEoz+AFjJuMRKEwvQH0IgEgSD0B9CLBIEI9AfQTrotRoJQj/4AmpIgsJH+APqSILCL/gBaS7fFQA36AyDNRYgrEMrQHwAfHxIE1tIfAH9k2WIkCAXoD4C/SBBYQH8A/CRBYDb9AfBEii1GgpCX/gD4lQSBSfQHwCsSBGbQHwBvpNhiIBf9AXBI5ARxBUI6+gPgKAkCo+gPgBMibzEShET0B8BpEgRu0h8AV0gQuEN/AFwUdouRIMSnPwBukSBwgf4AuEuCwFn6A2CAsFsMxKQ/AIaJliCuQAhLfwCMJEHgCP0BMFi0LUaCEJD+AJhCgsAL+gNgFgkCv9EfABOF2mIkCHHoD4DpJAj8oD8AVpAg8F/6A2CROFuMBGE7/QGwVJAEgb30B8BqERLEFQh76Q+ADSJsMRKEjfQHwDYShLb0B8BOEoSe9AfAZtu3GAnCevoDIAQJQiv6AyAKCUIf+gMgkL1bjARhGf0BEM72v5QKs+kPgIh2JYgrENbQHwBB7dpiJAgL6A+A0CQIJekPgOgkCPXoD4AEtmwxEoR59AdAGhKEMvQHQCYShBr0B0Ay67cYCcJw+gMgJd9RRmr6AyCrlQniCoSx9AdAYiu3GAnCQPoDID0JQjr6A6ACCUIu+gOgiGVbjAThPv0BUIoEIQX9AVCNBCE+/QFQ0JotRoJwmf4AKMt3lBGW/gCobHaCuALhGv0BUNzsLUaCcIH+AGhBghCK/gDoQoIQh/4AaGTqFiNBOE5/ALQjQdhOfwB0JEHYS38ANDVvi5EgvKU/AFrzHWVsoT8AupuRIK5AeE1/ADBli5EgvKA/APhDgrCM/gDgXxKENfQHAH8ZvsVIEB7pDwCekCBMpT8AeE6CMI/+AOBXY7cYCcI3/QHAGxKE4fQHAO/5mlTG0h8AHDJqi3EFwof+AOAUCcIQ+gOAcyQI9+kPAE4bssVIkM70BwAXSRAu0x8AXCdBuEZ/AHDL/S1GgjSkPwAYQIJwiv4AYAzfUcZx+gOAYe5sMa5AWtEfAAwmQXhLfwAwngThNf0BwBSXtxgJ0oH+AGAiCcJT+gOAuSQIj/QHANNd22IkSGH6A4BFJAjf9AcA6/iOMr7oDwCWOrvFuAIpSX8AsIEEaU5/ALCHBOlMfwCwzaktRoJUoj8A2EyCNKQ/ANhPgnSjPwAI4fgWI0EK0B8ABCJBmtAfAMTiO8o60B8AhHNki3EFkpr+ACAoCVKY/gAgLglSlf4AILS3W4wEyUh/AJCABClGfwCQgwSpRH8AkMbrLUaCJKI/AEhGghSgPwDIR4Jkpz8ASOn4/xdDQPoDgMSeJogrkPj0BwC5SZCM9AcA6T3dYiRIZPoDgCIkSCL6A4A6JEgW+gOAUh63GAkSkP4AoCAJEpz+AKAmCRKZ/gCgLN9RFpb+AKC47wRxBRKH/gCgPgkSjf4AoIXvLUaCRKA/AGhEggShPwDoRYJEoD8AaOdri5EgG+kPAJqSIBv5ua/j36ADBCRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHjh/8y+Rolg9wwQAAAAAElFTkSuQmCC" width="725" height="520" style="width:400px;border-radius:10px"></p>
<p>正方形直接裂开了!, 这可不对, 我们期望的是这两个三角形的顶点都一起动~</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="14-优化-不存储点坐标-存储点索引">1.4 优化: 不存储点坐标, 存储点索引<a href="#14-优化-不存储点坐标-存储点索引" class="hash-link" aria-label="1.4 优化: 不存储点坐标, 存储点索引的直接链接" title="1.4 优化: 不存储点坐标, 存储点索引的直接链接">​</a></h3>
<p>我们希望修改一个点, 然后所有人看到的这个点都修改了. 基于<code>引用</code>的思想.</p>
<p>我们可以分别存储<code>点和三角形</code>, 三角形的顶点是点数组的 <strong>索引</strong>. 这样改一个点数组的元素, 其关联的三角形的所有点都跟着变啦~</p>
<!-- -->
<!-- -->
<!-- -->
<p>效果:</p>
<p><img decoding="async" loading="lazy" alt="新版本效果 ##w400##" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtQAAAHSCAIAAABD/ssnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAALKUlEQVR4nO3YR7JbwRFFwaZC+98yNSBF8wnzALQpk7mAihqeuGMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7Pf9+/fTL4Tz39MPAEBBmuMB8QEA02iOK8QHAEwgO64THwDwPs3xBvEBAC/THJ8QHwBwleaYQnwAwHOyYyLxAQB3aY4VxAcAfKU5lhIfAPCb7NhAfACA5thKfADQl+Y4QnwA0I7mOEt8ANCI7IhAfABQn+YIRXwAUJbmiEl8AFCQ7IhMfABQh+ZIQXwAkJ7myEV8AJCY7MhIfACQj+ZITXwAkIbmqEF8ABCd5ihGfAAQl+woSXwAEI7mqE18ABCF5mhCfABwnuxoRXwAcIzm6El8ALCb5mhOfACwiebgB/EBwHKygz+JDwBW0RzcJD4AmExz8Jj4AGAa2cEV4gOAT2kOXiI+AHiT5uA94gOA12gOPiQ+ALhKdjCF+ADgCc3BXOIDgNs0B4uIDwC+kh0sJT4A+ElzsIf4AOhOc7CZ+ADoS3ZwhPgAaEdzcJb4AOhCcxCE+AAoTnMQjfgAKEt2EJP4AKhGcxCc+AAoQnOQhfgASE92kIv4AMhKc5CU+ABIRnOQnfgAyEFzUIb4AIhOdlCM+AAISnNQlfgAiEVzUJ74AIhCdtCE+AA4THPQjfgAOENz0Jb4ANhNdtCc+ADYRHPAD+IDYC3NAV+ID4AlNAfcIz4AJpMd8Jj4AJhDc8BF4gPgI5oDXiU+AN4kO+A94gPgNZoDPiQ+AC7RHDCL+AB4RHPAdOID4DbZAYuID4C/aA5YTXwAjKE5YCPxAXQnO2Az8QE0pTngFPEB9KI54DjxAXQhOyAI8QEUpzkgGvEB1KQ5ICzxAZSiOSA+8QEUITsgC/EB5KY5IB3xAaSkOSAv8QEkIzsgO/EB5KA5oAzxAYSmOaAe8QFEpDmgMPEBxCI7oDzxAYSgOaAP8QGcpDmgIfEBnCE7oC3xAWylOQDxAeygOYBfxAewluwAvhAfwBKaA7hHfAAzaQ7gKfEBTKA5gOvEB/AR2QG8SnwA79AcwNvEB/ACzQF8TnwAl8gOYBbxATyiOYDpxAdwg+YA1hEfwG+aA9hAfABjyA5gI/EBrWkOYD/xAR1pDuAg8QG9yA7gOPEBLWgOIA7xAZVpDiAg8QEFaQ4gMvEBpcgOID7xARVoDiAR8QGJaQ4gI/EBKckOIC/xAZloDqAA8QEJaA6gEvEBockOoB7xARFpDqAw8QGBaA6gA/EB52kOoBXxASfJDqAh8QEHaA6gM/EB+2gOgCE+YA/ZAfCL+ICFNAfAv8QHzKc5AB4QHzCN5gC4QnzABLID4DrxAe/THABvEB/wMs0B8AnxAS+QHQCfEx/wnOYAmEh8wF2aA2AF8QE3yA6AdcQH/KY5ADYQH6A5ALYSH/SlOQCOEB90JDsADhIfNKI5ACIQH9SnOQBCER9UJjsAAhIfFKQ5ACITH9ShOQBSEB+kpzkAchEfJCY7ADISH+SjOQBSEx+koTkAahAfJCA7ACoRH8SlOQBKEh+EozkAahMfBCI7ADoQH5ynOQBaER8cozkAehIf7KY5AJoTH+wjOwAY4oMNNAcAfxIfrKI5ALhJfDCf7ADgAfHBNJoDgCvEB5/SHAC8RHzwJs0BwHvEBy+THQB8QnxwleYAYArxwROaA4C5xAd3yQ4AVhAffKU5AFhKfPCT5gBgD/GB7ABgK/HRl+YA4Ajx0Y7mAOAs8dGF5gAgCPFRn+wAIBTxUZbmACAm8VGN5gAgOPFRh+wAIAXxkZ7mACAX8ZGV5gAgKfGRjOYAIDvxkYbsAKAG8RGd5gCgGPERlOYAoCrxEY7sAKA28RGF5gCgCfFxmOYAoBvxcYbmAKAt8bGb7ACgOfGxieYAgB/Ex1qaAwC+EB+ryA4AuEl8TKY5AOAx8TGH5gCAi8THp2QHALxEfLxJcwDAe8THazQHAHxIfFyiOQBgFvHxhOwAgLnEx22aAwAWER9/0RwAsJr4+El2AMAe3eNDcwDAZk3jQ3MAwCm94kNzAMBxXeJDdgBAEMXjQ3MAQDQ140NzAEBY1eJDdgBAcEXiQ3MAQBa540NzAEA6WeNDdgBAUsniQ3MAQHY54kNzAEAZoeNDcwBAPUHjQ3YAQFWx4kNzAEB5IeJDcwBAH4fjQ3YAQDdn4kNzAEBbW+NDcwAAO+JDcwAAv6yND9kBAHyxJD40BwBwz8z40BwAwFP/mXVIeQAAV0yLj2/fvs06BQAUNi0+hv4AAC6YGR9DfwAAz0yOj6E/AICH5sfH0B8AwH1L4mPoDwDgjlXxMfQHAHDLwvgY+gMA+Mfa+Bj6AwD42/L4GPoDAPjDjvgY+gMA+L9N8TH0BwAwxtgZH0N/AACb42PoDwBob3d8DP0BAL0diI+hPwCgsTPxMfQHAHR1LD6G/gCAlk7Gx9AfANDP4fgY+gMAmjkfH0N/AEAnIeIDAOgjSnwYPwCgiSjxMfQHAPQQKD6G/gCABmLFx9AfAFBduPgY+gMASosYH0N/AEBdQeNj6A8AKCpufAz9AQAVhY6PoT8AoJzo8TH0BwDUkiA+hv4AgEJyxMfQHwBQRZr4GPoDAErIFB9DfwBAfsniY+gPAEguX3wM/QEAmaWMj6E/ACCtrPEx9AcA5JQ4Pob+AICEcsfH0B8AkE36+Bj6AwBSqRAfQ38AQB5F4gMAyKJOfBg/ACCFOvEx9AcAZFAqPob+AIDwqsXH0B8AEFvB+Bj6AwACqxkfQ38AQFRl42PoDwAIqXJ8DP0BAPEUj4+hPwAgmPrxMfQHAETSIj6G/gCAMLrEx9AfABBDo/gY+gMAAugVH0N/AMBp7eJj6A8AOKpjfAz9AQDnNI2PoT8A4JC+8TH0BwCc0Do+hv4AgO26x8fQHwCwl/gYQ38AwEbiAwDYSnz8ZPwAgD3Ex2/6AwA2EB9/0R8AsJr4+Ep/AMBS4uMG/QEA64iP2/QHACwiPu7SHwCwgvh4RH8AwHTi4wn9AQBziY/n9AcATCQ+LtEfADCL+LhKfwDAFOLjBfoDAD4nPl6jPwDgQ+LjZfoDAD4hPt6hPwDgbeLjTfoDAN4jPt6nPwDgDeLjI/oDAF4lPj6lPwDgJeJjAv0BANeJjzn0BwBcJD4AgK3ExzTGDwC4QnzMpD8A4CnxMZn+AIDHxMd8+gMAHhAfS+gPALhHfKyiPwDgJvGxkP4AgH+Jj7X0BwB8IT6W0x8A8CfxsYP+AIBfxMcm+gMAfhAf++gPABjiYzP9AQDiYzf9AUBz4uMA/QFAZ+LjDP0BQFvi4xj9AUBP4uMk/QFAQ+LjMP0BQDfi4zz9AUAr4iME/QFAH+IDANhKfERh/ACgCfERiP4AoAPxEYv+AKA88RGO/gCgNvERkf4AoDDxEZT+AKAq8RGX/gCgJPERmv4AoB7xEZ3+AKAY8ZGA/gCgEvGRg/4AoAzxkYb+AKAG8ZGJ/gCgAPGRjP4AIDvxkY/+ACA18ZGS/gAgL/GRlf4AICnxkZj+ACAj8ZGb/gAgHfGRnv4AIBfxUYH+ACAR8VGE/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGCR/wHnKKmKIzBtZAAAAABJRU5ErkJggg==" width="724" height="466" style="width:400px;border-radius:10px"></p>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><span class="octicon octicon-note" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-info mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Note</p>
<p>&quot;不是保留顶点本身而是保留顶点的索引&quot;--保留了索引, 就维持住了网格的 <strong>拓扑结构</strong>, 不同面的相邻顶点之间就不是一盘散沙, 而是紧密连接在一起~</p>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="二obj-格式三维模型的加载与绘制">二、OBJ 格式三维模型的加载与绘制<a href="#二obj-格式三维模型的加载与绘制" class="hash-link" aria-label="二、OBJ 格式三维模型的加载与绘制的直接链接" title="二、OBJ 格式三维模型的加载与绘制的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-obj-是什么">2.1 OBJ 是什么?<a href="#21-obj-是什么" class="hash-link" aria-label="2.1 OBJ 是什么?的直接链接" title="2.1 OBJ 是什么?的直接链接">​</a></h3>
<p><strong>OBJ 是一种基于纯文本的 3D 模型存储格式</strong></p>
<blockquote>
<p>OBJ是一种基于纯文本的3D模型存储格式, 用于存储3D模型的点、面、法线等数据。它的优点是它是一种可读性好的格式, 可以直接被文本编辑器打开和编辑, 也被多种3D软件所支持读取和写入。OBJ格式还支持引用外部MTL文件, 从而支持多种材质和纹理映射。他的文件格式相对简单, 容易读取和导出, 即使是 C 语言初学者也很容易写出他的读取器和导出器。</p>
<p>然而, OBJ格式的缺点是它不适合存储复杂的3D数据, 因为纯文本格式不能以最小化的方式表示这些数据, 这使得OBJ格式不适合存储需要高精度和超高面数的3D模型。此外, OBJ格式对于大型3D模型的存储也会变得非常慢和低效, 因为它需要读取和写入大量的文本数据。</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22-认识-obj-文件格式-顶点数据">2.2 认识 OBJ 文件格式: 顶点数据<a href="#22-认识-obj-文件格式-顶点数据" class="hash-link" aria-label="2.2 认识 OBJ 文件格式: 顶点数据的直接链接" title="2.2 认识 OBJ 文件格式: 顶点数据的直接链接">​</a></h3>
<blockquote>
<p>OBJ 文件包含很多行, 每一行都包含一个 <strong>指令</strong>。指令由英文字母开始, 后面跟着几个数字或字符串作为数据, 典型的是 <code>v 指令</code>, 他代表一个顶点, 后面跟着的数据是用空格分割的三个浮点数, 分别代表着顶点的 <strong>x、y、z 坐标</strong>。此外还有 o 指令用于指定当前对象名称, 以 # 开头行的是可选的注释, 注释不会被读取和解析。</p>
</blockquote>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-sh codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"># Blender 3.5.0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># www.blender.org</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">o Cube</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">sh</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="23-顶点解析器">2.3 顶点解析器<a href="#23-顶点解析器" class="hash-link" aria-label="2.3 顶点解析器的直接链接" title="2.3 顶点解析器的直接链接">​</a></h3>
<!-- -->
<!-- -->
<p>非常简单, 读取一整行(<code>std::getline</code>), 然后看看是否有 <code>v </code> 顶点数据, 有就直接流式解析~</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="24-认识-obj-文件格式-面数据">2.4 认识 OBJ 文件格式: 面数据<a href="#24-认识-obj-文件格式-面数据" class="hash-link" aria-label="2.4 认识 OBJ 文件格式: 面数据的直接链接" title="2.4 认识 OBJ 文件格式: 面数据的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="认识面数据 ##w500##" src="/HXLoLi/assets/images/HX_2025-07-31_15-20-55-890bfd810d8da8e8b5593c31b59d1fff.png" width="1122" height="837" style="width:500px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="25-从-obj-文件格式-看多边形网格数据结构">2.5 从 OBJ 文件格式, 看多边形网格数据结构<a href="#25-从-obj-文件格式-看多边形网格数据结构" class="hash-link" aria-label="2.5 从 OBJ 文件格式, 看多边形网格数据结构的直接链接" title="2.5 从 OBJ 文件格式, 看多边形网格数据结构的直接链接">​</a></h3>
<ul>
<li>vertices 是 <code>vector&lt;array&lt;float, 3&gt;&gt;</code>, 每个顶点有三个 float, 分别为 x, y, z 表示顶点坐标。</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-sh codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">v</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.000000</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">sh</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>faces 是 <code>vector&lt;vector&lt;int&gt;&gt;</code>, 每个 n 边形面, 由 n 个顶点的下标(int)构成。</li>
</ul>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">f </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">4</span><span class="token plain">   </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 由 1、2、3、4 号顶点构成一个四边形面</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">f </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain">     </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 由 1、2、3 号顶点构成一个三角形面</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">f </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">4</span><span class="token plain">     </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 由 1、3、4 号顶点构成一个三角形面</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">f </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain">       </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 由 1 号 和 3 号顶点连成一条线段</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="26-obj-格式的其他数据">2.6 OBJ 格式的其他数据<a href="#26-obj-格式的其他数据" class="hash-link" aria-label="2.6 OBJ 格式的其他数据的直接链接" title="2.6 OBJ 格式的其他数据的直接链接">​</a></h3>
<p>OBJ 格式有时候还会包含 <code>法线(vn)</code> 和 <code>纹理坐标(vt)</code></p>
<p><img decoding="async" loading="lazy" alt="vn and vt ##w300##" src="/HXLoLi/assets/images/HX_2025-07-31_16-25-09-4c5b9eedbd8de2d01b341ed92f0e52ea.png" width="603" height="951" style="width:300px;border-radius:10px"></p>
<p>虽说我们不去解析 vn 和 vt 就可以...但可恶的是 f 指令会因此产生变化:</p>
<ul>
<li>原本只有一个整数(v 编号), 会变成由斜杠分割的三个整数(分别为 v、vn、vt 的编号)</li>
</ul>
<blockquote>
<p>由于我们只想要 v 的部分, 只需要斜杠分割的第一个数就行, 例如 6/7/4 我们只需要其中的 6</p>
</blockquote>
<!-- -->
<p>读取到:</p>
<p><img decoding="async" loading="lazy" alt="mk-f3 ##w400##" src="/HXLoLi/assets/images/HX_2025-07-31_16-39-00-e5c93f35c44ec07f094a7fc171cc1281.png" width="961" height="699" style="width:400px;border-radius:10px"></p>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><span class="octicon octicon-tip" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-light-bulb mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Tip</p>
<p>小彭老师说: 这个 OBJ 模型中存在四边形...而我们刚刚的代码只读取了四边形的前三个顶点, 导致显示出来的只是其中一半的三角形</p>
<p>由于 OpenGL 只支持渲染三角形, 不支持四边形, 我们需要在 load_obj 函数中, 检测读到的面片是否为四边形, 如果是则需要把他拆分成两个三角形。</p>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="27-任意多边形拆分成三角形的原理">2.7 任意多边形拆分成三角形的原理<a href="#27-任意多边形拆分成三角形的原理" class="hash-link" aria-label="2.7 任意多边形拆分成三角形的原理的直接链接" title="2.7 任意多边形拆分成三角形的原理的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="任意多边形拆分成三角形的原理 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_16-43-10-54cbb9028a7ae9722f7ce8239a3b8a84.png" width="2071" height="1192" style="width:700px;border-radius:10px"></p>
<!-- -->
<p>效果:</p>
<p><img decoding="async" loading="lazy" alt="mk-fn ##w400##" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA78AAALMCAIAAACjQ5IWAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAWxElEQVR4nO3d3VIbyRKFUTxx3v+VfS7kwBiE2FL/ZWatdTkxxri7qvlUVElvbwAAAAAAAAAAAAAAtf26+hsAWNTv379f/rO/fnl6A1zD8xfgEFvieDt5DXAQj1eAV1wbx9vJa4DXeHoC3NE9jreT1wB3eTgCKxLH28lrYE2efcBA4rgCeQ2M5NEG9COOZ5DXQEeeXEA54pgbeQ0U5MEEnE0csxd5DZzPcwfYmTimDnkN7M5jBXiOOGYSeQ08y1MD+Ic4ho/kNfCJhwKsRRzDvuQ1rMach1HEMVQjr2EYUxo6Eccwj7yGXsxYKEQcA1/JayjFhITziGPgCPIazmS+wW7EMVCTvIYdmU4QUcbAbAobQqYK/CWRAb4S1vCR+QB/SGeA7whoeGcygG4GiGhoeFPPIJ0BcgIazAGWJp0BniWgWZwJwKJ0M8AWGpplGfqsSDoDbCegWZNxz1p0M8COBDQLMuhZiHQGOIKGZimGO6uQzgDHEdCsw1hnPt0McA4NzQqMcoaTzgBnEtCMZ4gzmXQGOJ+AZjbjm5l0M8C1NDRTGdkMJJ0BKhDQjGRYM4puBqhGQzOMAc0c0hmgJgHNJEYzQ0hngMoENGMYyrSnmwG60NAMYBDTm3QG6EVA050RTFe6GaAvDU1fxi4tSWeA7gQ0TRm49COdAWYQ0HRk1NKJbgaYR0PTi/FKG9IZYCoBTSMGKw3oZoAVaGhaMEypTjoDrENAU58xSmnSGWA1ApriDFCK0s0AK9PQlGVoUpF0BkBAU5NxSS26GYB3ApqCDEoKkc4AfKWhKcVwpArpDMB3BDR1GItcTzcDkNDQVGAUcjHpDEBOQHM5Q5ArSWcAniWguZbxxzV0MwBbaGiuYuRxAekMwHYCmksYdpxKNwOwLw3NyQw4ziOdATiCgOZMRhsnkc4AHEdAcxpDjcPpZgDOoaE5gUHGsaQzAGcS0BzNCOMouhmAq2hojmNscQjpDMC1BDQHMbDYn3QGoAIBzRGMKvakmwGoRkOzL+OJ3UhnAGoS0OzIYGIHuhmA+jQ0uzCM2Eo6A9CFgGY7Y4hNpDMAvQhoNjKAeJFuBqAvDc3LDB1eIZ0B6E5A8xrjhufoZgDGENC8wKDhCdIZgHk0NE8xXEhJZwCmEtDkjBV+ppsBWIGGJmGU8APpDMA6BDQ/MkR4RDoDsBoBzWPGB/fpZgBWpqH5jpHBHdIZAAQ0dxkW/EM3A8BHGppPDAj+ks4A8JWA5iOjgT+kMwB8R0DzzlBANwNAREPzpp6RzgCQE9AYAevSzQDwGg29Mvd+UdIZALYQ0Mty45ejmwFgLxp6QW75QnQzABxBQy/FzV6FdAaA4wjodbjT8+lmADiHhl6BezycdAaAMwno8dzgsXQzAFxFQw/m1s4knQHgWgJ6Kvd1Gt0MAHVo6Hnc0Tl0MwDUpKEncS+HkM4AUJmAHsONbE83A0AXGnoAt7A36QwAvQjo7ty/rnQzAPSlofty51qSzgDQnYBuym1rRjcDwCQauh03rA3dDABTaehG3KoepDMAzCagu3CfqtPNALAODV2fO1SadAaA1Qjo4tyeonQzAKxMQ5flxlQknQEAAV2Tu1KLbgYAPtLQ1bgfVehmAOAuAV2Km1GCdAYAHtPQRbgNF9PNAEBOQ1/ODbiSdAYAniWgr+XqX0M3AwBbaOiruO4XkM4AwHYC+hIu+ql0MwCwLw19Mpf7PNIZADiCgD6Ta30G3QwAHE1Dn8NVPpZuBgDOpKGP5voeSDoDAOcT0IdycQ+hmwGAa2nog7is+5POAEAFAvoIrumedDMAUI2G3peruRvpDADUJKB35FLuQDcDAPVp6F24iJvoZgCgFw29kcv3OukMAHQkoLdw7V6hmwGA7jT0a1y1p0lnAGAGAf0Cl+wJuhkAmEdDP8XFSklnAGAqAZ1zpX6mmwGAFWjohGv0A+kMAKxDQP/ov6u/AQAAaEM9AwBAyuL8I7ZtAACrsXnjMWvPAACQUs8AAJBSzwAAkLKv5Vs2PQMAa7L1+QFrzwAAkFLPAACQUs/32bYBAMBX6hkAgH9YRnxAPQMAQEo9AwBAytuR3OG3FQAA3rfuLmvPAACQUs8AAJBSzwAAkLKd5TObngEAbmx9/sraMwAApNQzAACkrMb/w7YNAICPbN74xNozAACk1DMAAKTUMwAApGxk+cumZwCAr2x9/sjaMwAApNQzAACkrMP/YdsGAMB3bN54Z+0ZAABS6hkAAFLqGQAAUrawvL3Z9AwA8BNbn2+sPQMAQEo9AwBAygq8bRsAABGbN96sPQMAQE49AwBASj0DAEBq9c0rNj0DAORsfbb2DAAAKfUMAAAp9QwAAKmld67Y9AwA8KzFtz5bewYAgJR6BgCA1LoL77ZtAAC8ZuXNG9aeAQAgpZ4BACClngEAILXonhWbngEAtlh267O1ZwAASKlnAABIrbjkbtsGAMB2a27esPYMAACp/139DQAAQAO3/Qv/e9/GsObaOwAAPPZx3++vr5uAZ2e0Tc8AAHtZsBvv7Ny4/X+zrwUAAHznwXrrt/ue7egAAGApySaFOzs37v9/Ixratg0AgH2tVonpe25YigYAYJgXllaffsc6u6IBAOju5S0JL77fs6VoAADa2b6PN933/MNXKd/QdjwDABxnnRrcp57/frlKF04xAwCcb3YQ7lzPf77odZdMMQMA1DEvCw+p579f/cTrpZsBAGqa1IQvnhoMeYMOAADOcc5a6rH1fOMNOgAAOMjJGxDOqOd3lqIBANjLJRt3T63nG0vRAAC87NrTbhfU8ztL0QAA5Cq8S8SV9XxjKRoAgAcqRPO7Y9+x7gVbGrravwUAgGF1d/3a8yeWogEAFlcwmt+Vq+d3dkUDAKymcjff1K3nGw0NALCC+t1889/V30Cky9UEAOAFjWKv+trzO4vQAADzNOrmmzb1fKOhAQBmaNfNN+XesS53t6H7/nMAAOaZF2w99j3f1fq6AwAs6Pfv390TrnE9v424AQAAi5iRbc32Pd9lMzQAQGUzuvmm99rzR5PuCgDAGMMirfGpQQAAONmctWcAADiaegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCA1K+7//X3798nfx8AAFDHr1/3O/n+f31AWAMAMMN3ifzoj+z41wtrAACqeSGRH321Hb/WA8IaAIDj7JvIj/6ic/6aB4Q1AACJ0xL50fdw9TfwiLAGAFhNhUR+oPQ394CwvsTj0eymAFCTn18FFU/kB7p+3w+YA085Yuy6BQBU4Gfc5fom8gMD/0kPLDLi64zURS44AKX4OXiyOhf8HGv9ax+oPL4HDMrKlxeAGfy4PNSAy7sXFyKy+2hedghWfi4A0JEfqXtZ9ko+y2Xa6n3sGnNPkdEAbOHH7lPkyo5cQS4mowHIiT8uZwhShYwG4DuimTqMRcqR0QDciGYKMigpTUkDrEYxU5wBSg8yGmA20UwXRirNyGiASUQz7RiydCWjAfoSzfRl7NKejAboQjQzgEHMHDIaoCbRzCRGMwPJaIAKRDMjGdZMJqMBzieamc34ZgkyGuBooplFGOgsR0kD7EUxsyCDnnXJaIDXiGZWZvSDjAaIiGZ4U8/wkYwG+Eo0w0fmA9whowFEM9xlYsAjMhpYjWiGx8wQiMhoYDbRDCFTBZ4jo4FJRDM8y5yBV2hooDvdDK8xc+BFAhroSzrDy0we2ERDA73oZtjIFIKtBDTQhXSG7cwi2IGABuqTzrALEwl2o6GBmnQz7Mh0gj0JaKAa6Qz7MqNgfxoaqEA3wxHMKziEgAauJZ3hIKYWHEhDA+fTzXAoEwyOJaCBM0lnOJo5BmfQ0MDRdDOcw0yDkwho4DjSGU5jssGpNDSwL90MJzPl4GwCGtiLdIbzmXVwDQ0NbKGb4SrmHlxGQAOvkc5wIdMPLqahgZxuhsuZhHA9AQ0kpDNUYB5CFRoa+I5uhjrMRihEQANfSWcoxYSEcjQ0cKOboSDTEioS0IB0hprMTKhLQ8OadDNUZn5CaQIaViOdoThTFBrQ0LAC3QwtmKjQg4CG2aQzdGGuQicaGubRzdCLGQvNCGiYRDpDOyYttKShoTvdDE2ZutCVgIa+pDP0ZfZCbxoaetHN0J05DO0JaOhCOsMApjEMoaGhMt0MY5jMMIeAhpqkM0xiPsM0Ghrq0M0wj1kNAwloqEA6w0gmNoyloeEquhkGM71hMgEN55POMJsZDvNpaDiHboYVmOewBAENR5POsAhTHRaioeEIuhmWYsLDWgQ07Es6w2rMeViRhobtdDOsycyHRQlo2EI6w7JMfliahoZn6WZYnEcArE5AQ046A54CwNubhoaf6GbgxrMA+ENAw3ekM/DO4wD4h4aGj3Qz8ImHAvCZgIYb6Qx89d/V3wAAALShngEAIOV3UsA/bNuAj2zeAD6x9gwAACkvqYG/LDzDV5afgY+sPQN/SGcA+JF6BoBHvLAEPvLbKODtTR/AT+zfAG6sPQMAQMoracDCM0QsPwNv1p4BACDnZTSszsIz5Cw/A54CsDTpDM8S0LA4OzcAACDlBTSsy8IzvMbyM6zM2jMAAKS8eoZFWXiGLSw/w7KsPcOKpDMAvEY9A8DTvASFZfnFEyzHT33Yi/0bsCBrzwAAkPKiGdZi4Rn2ZfkZVmPtGQAAUl4xw0IsPMMRLD/DUkx4WIV0huMIaFiHnRsAAJDyWhmWYOEZjmb5GRZh7RkAAFJeKMN8Fp7hHJafYQXWnmE46QwAO1LPALAPL1ZhBX7HBJP5WQ7ns38DZrP2DAAAKa+PYSwLz3AVy88wmLVnAABIeXEMM1l4hmtZfoaprD0DAEBKPQMAQMrvlWAg2zagAps3YCRrzwAAkFLPAACQUs8AAJBSzwAAkHKgAaZxZBDqcHAQ5rH2DAAAKfUMAAAp9QwAACn1DAAAKacZYBRHBqEaBwdhGGvPAACQUs8AAJBSzwAAkFLPAACQcpQB5nBkEGpycBAmsfYMAAAp9QwAACn1DAAAKfUMAAAp5xhgCEcGoTIHB2EMa88AAJBSzwAAkFLPAACQUs8AAJByiAEmcGQQ6nNwEGaw9gwAACn1DAAAKfUMAAAp9QwAACknGKA9RwahCwcHYQBrzwAAkFLPAACQUs8AAJBSzwAAkHJ8AXpzZBB6cXAQurP2DAAAKfUMAAAp9QwAACn1DAAAKWcXoDFHBqEjBwehNWvPAACQUs8AAJBSzwAAkFLPAACQcnABunJkEPpycBD6svYMAAAp9QwAACn1DAAAKfuuoCWbnqE7W5+hKWvPAACQUs8AAJBSzwAAkFLPAACQcmQB+nFkEGZwcBA6svYMAAAp9QwAACn1DAAAKfUMAAAp5xWgGUcGYRIHB6Eda88AAJBSzwAAkFLPAACQUs8AAJByWAE6cWQQ5nFwEHqx9gwAACn1DAAAKfUMAAAp9QwAACknFaANRwZhKgcHoRFrzwAAkFLPAACQUs8AAJBSzwAAkHJMAXpwZBBmc3AQurD2DAAAKfUMAAAp9QwAACn1DAAAKWcUoAFHBmEFDg5CC9aeAQAgpZ4BACClngEAIKWeAQAg5YACVOfIIKzDwUGoz9ozAACk1DMAAKTUMwAApNQzAACknE6A0hwZhNU4OAjFWXsGAICUegYAgJR6BgCAlHoGAICUegYAgJR6BgCAlHoGAICUN5WEurzZM6zJWz5DZdaeAQAgpZ4BACClngEAIKWeAQAgpZ4BACClngEAIKWeAQAgpZ4BACClngEAIOXTjKAoHzQIK/Nxg1CWtWcAAEipZwAASKlnAABIqWcAAEipZwAASKlnAABIqWcAAEipZwAASHkzdqjIR6UAPjAFarL2DAAAKfUMAAAp9QwAACn1DAAAKfUMAAAp9QwAACn1DAAAKfUMAAAp78QO5fioFODGB6ZAQdaeAQAgpZ4BACClngEAIKWeAQAgpZ4BACClngEAIKWeAQAgpZ4BACClngEAIOVDjKAWHzQIfOTjBqEaa88AAJBSzwAAkFLPAACQUs8AAJBSzwAAkFLPAACQUs8AAJBSzwAAkPIe7FCIj0oBvvKBKVCKtWcAAEipZwAASKlnAABIqWcAAEipZwAASKlnAABIqWcAAEipZwAASKlnAABI+fgiqMIHDQLf8XGDUIe1ZwAASKlnAABIqWcAAEipZwAASKlnAABIqWcAAEh5BxwoxJvWAV95uzooxYSEWgQ08JF0hmrs3AAAgJRXtFCO5WfgxsIzFGRaQkUCGpDOUJOZCUUJaFiZdIayTE6oS0DDmqQzVGZ+QmkCGlYjnaE4UxSqE9CwDukM9Zml0ICAhhVIZ2jBRIUeBDTMJp2hC3MV2hDQMJV0hkZMV+hEQMM80hl6MWOhGQENk0hnaMekhX4ENMwgnaEj8xZaEtDQnXSGpkxd6EpAQ1/SGfoye6ExAQ0dSWdozQSG3gQ09CKdoTtzGCbQ0FCfboYZzGQYTljDmSQyjGeSw6JUNWyhkmFZJj/wD1UNH6lk4BMPBSAlrJlKIgM5zwtgK1VNFyoZ2M5zBDiQsOZ8Ehk4lEcMcAFVzXYqGbiERw9Qi7DmI4kMVOOpBLQksruTxUBTHl7AEtT20dQwsAgPO4DPpPaNIAb4ypMRYJNeqS2IATbyGAU41b61rYYBAAAAAAAAAAAAAAD4x/8B8ISrJ1LBQAgAAAAASUVORK5CYII=" width="959" height="716" style="width:400px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="28-使用-glm-封装好的矢量代替自定义的点面类">2.8 使用 glm 封装好的矢量代替自定义的点面类<a href="#28-使用-glm-封装好的矢量代替自定义的点面类" class="hash-link" aria-label="2.8 使用 glm 封装好的矢量代替自定义的点面类的直接链接" title="2.8 使用 glm 封装好的矢量代替自定义的点面类的直接链接">​</a></h3>
<!-- -->
<!-- -->
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="29-glm-矢量库中的预定义类型一览">2.9 glm 矢量库中的预定义类型一览<a href="#29-glm-矢量库中的预定义类型一览" class="hash-link" aria-label="2.9 glm 矢量库中的预定义类型一览的直接链接" title="2.9 glm 矢量库中的预定义类型一览的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="glm 矢量库中的预定义类型一览 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-06-51-d4c89cb89dd924d35bfcab0c28eccb4e.png" width="1915" height="1042" style="width:700px;border-radius:10px"></p>
<p>常用头文件:</p>
<div>加载中...</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="三复习-opengl-中的坐标系和矩阵">三、复习 OpenGL 中的坐标系和矩阵<a href="#三复习-opengl-中的坐标系和矩阵" class="hash-link" aria-label="三、复习 OpenGL 中的坐标系和矩阵的直接链接" title="三、复习 OpenGL 中的坐标系和矩阵的直接链接">​</a></h2>
<p>对象空间 ➡ 世界矩阵 ➡ 世界空间 ➡ 视角矩阵 ➡ 视角空间 ➡ 投影矩阵 ➡ 裁剪空间 ➡ 光栅化 ➡ 窗口空间</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-local-to-world又称-model-矩阵">3.1 local to world(又称 Model 矩阵)<a href="#31-local-to-world又称-model-矩阵" class="hash-link" aria-label="3.1 local to world(又称 Model 矩阵)的直接链接" title="3.1 local to world(又称 Model 矩阵)的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Model 矩阵 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-26-59-80027a4540859adf80093268a2fdf69a.png" width="2003" height="1136" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32-world-to-view又称-view-矩阵">3.2 world to view(又称 View 矩阵)<a href="#32-world-to-view又称-view-矩阵" class="hash-link" aria-label="3.2 world to view(又称 View 矩阵)的直接链接" title="3.2 world to view(又称 View 矩阵)的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="View 矩阵 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-27-50-8d97746d6fc6aab462bfb1e992a7c705.png" width="1932" height="1101" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="33-view-to-clip又称-projection-矩阵">3.3 view to clip(又称 Projection 矩阵)<a href="#33-view-to-clip又称-projection-矩阵" class="hash-link" aria-label="3.3 view to clip(又称 Projection 矩阵)的直接链接" title="3.3 view to clip(又称 Projection 矩阵)的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Projection 矩阵 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-28-45-1c2f52c7d337e04bc38ad1921e137c56.png" width="1893" height="1113" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="34-opengl-进行裁剪clip操作">3.4 OpenGL 进行裁剪(clip)操作<a href="#34-opengl-进行裁剪clip操作" class="hash-link" aria-label="3.4 OpenGL 进行裁剪(clip)操作的直接链接" title="3.4 OpenGL 进行裁剪(clip)操作的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="OpenGL 进行裁剪(clip)操作 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-29-37-692b9b6bdfc63aa6207f3739b631eb77.png" width="1772" height="1094" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="35-ndc-to-window">3.5 NDC to window<a href="#35-ndc-to-window" class="hash-link" aria-label="3.5 NDC to window的直接链接" title="3.5 NDC to window的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="NDC ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-30-24-46db173ce19078e550a5280b1b7270e0.png" width="1939" height="953" style="width:700px;border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="预判 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-32-32-1c37f3bb8be384d41e119b48022673db.png" width="1799" height="1090" style="width:700px;border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="预判你的预判 ##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-33-16-f74d59b9ea356229ef62e767038be456.png" width="1929" height="984" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="36-总结-我们需要考虑的有-modelviewprojection-矩阵">3.6 总结: 我们需要考虑的有 Model、View、Projection 矩阵<a href="#36-总结-我们需要考虑的有-modelviewprojection-矩阵" class="hash-link" aria-label="3.6 总结: 我们需要考虑的有 Model、View、Projection 矩阵的直接链接" title="3.6 总结: 我们需要考虑的有 Model、View、Projection 矩阵的直接链接">​</a></h3>
<ul>
<li>
<p><strong>Model</strong> 矩阵负责从对象局域坐标系(物体建模时采用的)转换到世界坐标系(场景布置)。</p>
</li>
<li>
<p><strong>View</strong> 矩阵负责把世界坐标系转换到摄像机为中心, 摄像机方向为 z 轴负方向的视角坐标系。</p>
</li>
<li>
<p><strong>Projection</strong> 矩阵负责把视角坐标系的三维坐标, 转换到带有 w 分量的齐次空间, 同时还对 z 轴进行了翻转(变左手系), 得到的四维坐标存入 OpenGL 内置的特殊变量: gl_Position。</p>
</li>
<li>
<p>最终由 OpenGL 内部取出 gl_Position 执行&quot;Perspective Divide&quot;操作: 将 x、y、z 分量同除以 w。此时如果刚才 Projection 矩阵把 w 设为 z, 就会产生&quot;近大远小&quot;的透视效果。</p>
</li>
<li>
<p>随后由 OpenGL 内部取出 x、y 坐标用于确定屏幕上像素点的位置, z 坐标用于深度测试, 并利用硬件加速的光栅化在屏幕上绘制立体图案。</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="##w700##" src="/HXLoLi/assets/images/HX_2025-07-31_17-35-16-9a3586717df533ee6707c240fabd6b0d.png" width="2151" height="500" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="37-model-矩阵---物体局部坐标系到世界坐标系">3.7 Model 矩阵 - 物体局部坐标系到世界坐标系<a href="#37-model-矩阵---物体局部坐标系到世界坐标系" class="hash-link" aria-label="3.7 Model 矩阵 - 物体局部坐标系到世界坐标系的直接链接" title="3.7 Model 矩阵 - 物体局部坐标系到世界坐标系的直接链接">​</a></h3>
<ul>
<li>
<p>OBJ 中的 x、y、z 坐标, 是物体局部坐标系。</p>
</li>
<li>
<p>而多个物体可能包含相同的 x、y、z 坐标, 为了让他们不要叠在一起, 每个物体都有一个 Model 矩阵, 负责把该物体的局部坐标转换为世界坐标。</p>
</li>
<li>
<p>Model 矩阵通常包含: 缩放、旋转、平移三部分, 乘法时顺序相反: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>T</mi><mi>R</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">M = TRS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">TRS</span></span></span></span>。</p>
</li>
<li>
<p><code>平移</code>部分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span> 控制着物体的<code>位置</code>, 可以由 <code>glm::translate(glm::vec3(x, y, z))</code> 创建;</p>
</li>
<li>
<p><code>旋转</code>部分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span> 控制着物体的<code>朝向</code>, 可以由 <code>glm::rotate(angle_radians, axis)</code> 创建;</p>
</li>
<li>
<p><code>缩放</code>部分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span> 控制着物体的<code>大小</code>, 可以由 <code>glm::scale(glm::vec3(sx, sy, sz))</code> 创建。</p>
</li>
<li>
<p>Model 矩阵是一个<strong>协变矩阵</strong>, 负责把三维坐标从局部坐标系转换到世界坐标系。</p>
</li>
<li>
<p>Model 矩阵是 4x4 的齐次矩阵, 其 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span> 分量用于乘以平移的偏移量, 当需要把 Model 矩阵作用于绝对矢量(<strong>位置</strong>)时, 请令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span> 为 1; 当作用于相对矢量(例如<strong>速度</strong>)时, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span> 应为 0。</p>
</li>
<li>
<p>当作用于法线时, 需要乘以的不是 Model 而是 Model 中 3x3 部分的逆转置: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(M^{-1})^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span></span></span></span>。</p>
</li>
<li>
<p>对于附着在物体上与空间无关的属性, 如<strong>纹理 UV</strong>, 则不用乘 Model 矩阵, 保持不变即可。</p>
</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="38-glmtranslate-这些函数的一个坑点">3.8 <code>glm::translate</code> 这些函数的一个坑点<a href="#38-glmtranslate-这些函数的一个坑点" class="hash-link" aria-label="38-glmtranslate-这些函数的一个坑点的直接链接" title="38-glmtranslate-这些函数的一个坑点的直接链接">​</a></h3>
<p>实际上他们不支持 <code>glm::translate(glm::vec3(x, y, z))</code> 这样写。</p>
<p>要 <code>glm::translate(glm::mat4x4(1), glm::vec3(x, y, z))</code> 这样写。</p>
<p>因为 glm 的作者为了所谓的&quot;便民&quot;, 给 <code>glm::translate</code> 强制加上了第一个参数。</p>
<p>然后 <code>glm::translate</code> 不是直接返回他得到的平移矩阵, 而是返回这个平移矩阵从左边乘以那该死的第一个参数后的结果, 他们就觉得这样很&quot;便民&quot;,</p>
<p>例如:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以上两种写法等价。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="39-blender-直观演示">3.9 Blender 直观演示<a href="#39-blender-直观演示" class="hash-link" aria-label="3.9 Blender 直观演示的直接链接" title="3.9 Blender 直观演示的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="1" src="/HXLoLi/assets/images/HX_2025-08-01_11-42-57-7dc92b9db16ef31ee72f32de9bc18eff.png" width="2093" height="1114" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="2" src="/HXLoLi/assets/images/HX_2025-08-01_11-43-26-ab791c8c0c798268847b329ca437e296.png" width="2076" height="1101" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="3" src="/HXLoLi/assets/images/HX_2025-08-01_11-43-54-02f3ce78f404c4053aabb6b948503694.png" width="2010" height="1094" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="310-view-矩阵---使用-glmlookat-函数创建">3.10 View 矩阵 - 使用 <code>glm::lookAt</code> 函数创建<a href="#310-view-矩阵---使用-glmlookat-函数创建" class="hash-link" aria-label="310-view-矩阵---使用-glmlookat-函数创建的直接链接" title="310-view-矩阵---使用-glmlookat-函数创建的直接链接">​</a></h3>
<p><code>glm::lookAt(eye, center, up)</code></p>
<p>接受三个矢量作为参数:</p>
<ul>
<li><code>eye</code> - 眼睛所在位置(绝对点)</li>
<li><code>center</code> - 所观察物体位置(绝对点)通常为 <code>(0, 0, 0)</code></li>
<li><code>up</code> - 上方向(相对方向)通常为 <code>(0, 1, 0)</code></li>
<li>返回 <code>glm::mat4x4</code> 表示 View 矩阵</li>
</ul>
<p>View 矩阵实际上是眼睛本身 Model 矩阵的逆:</p>
<ul>
<li>View 矩阵 - 世界到眼睛</li>
<li>眼睛本身的 Model 矩阵 - 眼睛到世界</li>
</ul>
<p>当场景中已经有个眼睛的模型时, 就可用他的 Model 矩阵求逆得到 View</p>
<p><img decoding="async" loading="lazy" alt="lookAt ##w400##" src="/HXLoLi/assets/images/HX_2025-08-01_11-48-12-fe09e938769a382c8ce8f1cfcd9bf682.png" width="868" height="706" style="width:400px;border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="mkas01" src="/HXLoLi/assets/images/HX_2025-08-01_14-07-14-26d0388f4136dc6757b5526d344517d6.png" width="1949" height="1098" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="mkas02" src="/HXLoLi/assets/images/HX_2025-08-01_14-10-24-3ff41fa01ba851a95c1efaaa94f6aa00.png" width="1975" height="1182" style="border-radius:10px"></p>
<p><code>glm::lookAt</code> 用法:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">5</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">            </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 眼睛位于 z 轴正方向 5 米处</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> center </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">         </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 眼睛所看着的目标物体位于原点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> up </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">             </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 头顶朝向为 y 轴正方向</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">lookAt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 创建 View 矩阵</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><span class="octicon octicon-tip" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-light-bulb mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Tip</p>
<p>这就是从世界坐标系转换到我视角坐标系的 View 矩阵哦</p>
</div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="四投影矩阵与透视原理">四、投影矩阵与透视原理<a href="#四投影矩阵与透视原理" class="hash-link" aria-label="四、投影矩阵与透视原理的直接链接" title="四、投影矩阵与透视原理的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41-projection-矩阵---调用-glmortho-函数创建正交投影">4.1 Projection 矩阵 - 调用 <code>glm::ortho</code> 函数创建正交投影<a href="#41-projection-矩阵---调用-glmortho-函数创建正交投影" class="hash-link" aria-label="41-projection-矩阵---调用-glmortho-函数创建正交投影的直接链接" title="41-projection-矩阵---调用-glmortho-函数创建正交投影的直接链接">​</a></h3>
<p><code>glm::ortho(left, right, bottom, top, zNear, zFar)</code></p>
<blockquote>
<p>构造一个长方体, 长方体内为可视空间, 长方体外的物体会被 OpenGL 裁剪掉。</p>
<p><img decoding="async" loading="lazy" alt="##w500##" src="/HXLoLi/assets/images/HX_2025-08-01_14-21-08-9b1a502ae656a0a7490a43e18910bf79.png" width="882" height="713" style="width:500px;border-radius:10px"></p>
<p>接受六个浮点数作为参数:</p>
<ul>
<li><code>left</code> - 立方体左侧面的 x 坐标, 视角坐标系</li>
<li><code>right</code> - 立方体右侧面的 x 坐标, 视角坐标系</li>
<li><code>bottom</code> - 立方体底面的 y 坐标, 视角坐标系</li>
<li><code>top</code> - 立方体顶面的 y 坐标, 视角坐标系</li>
<li><code>zNear</code> - 立方体最近处离人眼的距离, 即前侧面 z 坐标</li>
<li><code>zFar</code> - 立方体最远处离人眼的距离, 即后侧面 z 坐标</li>
</ul>
<p>用法举例:
<code>glm::ortho(-2.0f, 2.0f, -2.0f, 2.0f, 0.0f, 100.0f);</code></p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42-正交投影的优缺点">4.2 正交投影的优缺点<a href="#42-正交投影的优缺点" class="hash-link" aria-label="4.2 正交投影的优缺点的直接链接" title="4.2 正交投影的优缺点的直接链接">​</a></h3>
<p>正交投影是指将三维空间中的物体投影到一个二维平面上, 使得投影结果保持物体在空间中的形状和尺寸的一种投影方式。</p>
<p>优点:</p>
<ul>
<li>保持物体形状和尺寸: 正交投影不会产生透视效果, 因此可以保持物体在空间中的形状和尺寸, 更适用于需要准确展示物体的尺寸和比例的情况, 原来是正方形的在屏幕上还是正方形, 原来相等的边也是相等的, 例如制图和工业软件中就常用正交投影。</li>
<li>简单直观: 正交投影是一种简单直观的投影方式, 将物体垂直投影到平面上, 可以清晰展示物体的外形和结构, 便于观察和分析。</li>
<li>易于计算和绘制: 正交投影的计算相对简单, 只需通过平行投影将三维物体的顶点坐标投影到二维平面即可, 对于在 z 方向上的投影, 则取出 x、y 坐标分量只需要即可。同时, 绘制投影图形也比较容易, 只需绘制投影线即可。</li>
</ul>
<p>缺点:</p>
<ul>
<li>缺乏透视感: 由于正交投影不考虑透视效果, 所以在投影结果中没有远近的区别, 缺乏立体感和深度感, 不适用于需要展示物体远近距离关系的情况。</li>
<li>信息损失: 由于正交投影将三维物体投影到二维平面上, 会导致一些信息的损失。例如, 物体的侧面和遮挡部分在投影中通常不可见, 只有物体的外轮廓可见, 这可能导致一些细节的丢失。</li>
<li>不适用于特定应用场景: 正交投影适用于一些需要准确展示物体形状和尺寸的场景, 但对于需要展示物体的透视效果或者真实感的场景, 正交投影就不是很合适。例如绘画、建筑设计、室内设计、电影、游戏等领域通常需要使用透视投影来更好地表达三维空间与物体的关系。</li>
</ul>
<p>现实中没有摄像机能达到真正的正交投影(否则你可以用他来看清月球表面的一只蚊子)。</p>
<p>包括人眼在内, 都服从透视投影, 正交投影的画面会非常难以理解, 他仿佛是从无限远处观察的。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43-透视投影的规则-近大远小">4.3 透视投影的规则: 近大远小<a href="#43-透视投影的规则-近大远小" class="hash-link" aria-label="4.3 透视投影的规则: 近大远小的直接链接" title="4.3 透视投影的规则: 近大远小的直接链接">​</a></h3>
<p>透视投影是一种艺术技巧, 旨在通过模拟真实视觉效果, 使物体在画面中看起来有深度和立体感。其中的一个重要规则是 <strong>近大远小</strong>。</p>
<blockquote>
<p>近大远小是指在透视投影中, 离观察者较近的物体看起来较大, 而离观察者较远的物体则看起来较小。这是因为在真实世界中, 当物体离我们更远时, 它们的视角会变小, 表现为物体在视场中的大小缩小。这种现象在透视投影中被模拟出来, 以使画面更加真实。</p>
<p>在绘画或设计中, 近大远小的运用可以使画面更加有深度和逼真感。通过正确地运用透视规则, 绘画师可以使观众感受到画面中物体的远近关系, 增强观看体验。为了实现近大远小的效果, 画家需要根据物体在透视中的位置和距离, 合理地调整它们的大小。</p>
<p>除此之外, 近大远小的规则还适用于建筑设计和摄影等领域。在建筑设计中, 远处的建筑物可以更小, 而近处的建筑物可以更大, 以真实地再现空间的深度。在摄影中, 通过调整焦距和光圈大小等参数, 可以模拟出近大远小的效果。</p>
<p>总之, 透视投影的规则之一是近大远小。通过正确运用这一规则, 艺术家可以创造出逼真的视觉效果, 使观众能够感受到画面中物体的远近关系, 增强观赏体验。</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="44-blender-演示---正交投影-vs-透视投影">4.4 Blender 演示 - 正交投影 vs 透视投影<a href="#44-blender-演示---正交投影-vs-透视投影" class="hash-link" aria-label="4.4 Blender 演示 - 正交投影 vs 透视投影的直接链接" title="4.4 Blender 演示 - 正交投影 vs 透视投影的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-01_14-30-12-f97333fe6f3e4bbb74c85cbe10ffaa07.png" width="2143" height="946" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="45-projection-矩阵---调用-glmfrustum-函数创建透视投影">4.5 Projection 矩阵 - 调用 <code>glm::frustum</code> 函数创建透视投影<a href="#45-projection-矩阵---调用-glmfrustum-函数创建透视投影" class="hash-link" aria-label="45-projection-矩阵---调用-glmfrustum-函数创建透视投影的直接链接" title="45-projection-矩阵---调用-glmfrustum-函数创建透视投影的直接链接">​</a></h3>
<p><code>glm::frustum(left, right, bottom, top, zNear, zFar)</code></p>
<blockquote>
<p>构造一个锥台(梯形), 锥台内为可视空间, 锥台外的物体会被 OpenGL 裁剪掉。</p>
<p><img decoding="async" loading="lazy" alt="frustum ##w500##" src="/HXLoLi/assets/images/HX_2025-08-01_14-36-25-06161648d1259b85d87fbbfc19e3df18.png" width="876" height="658" style="width:500px;border-radius:10px"></p>
<p>接受六个浮点数作为参数:</p>
<ul>
<li><code>left</code> - 锥台前侧面左边的 x 坐标, 视角坐标系</li>
<li><code>right</code> - 锥台前侧面右边的 x 坐标, 视角坐标系</li>
<li><code>bottom</code> - 锥台前侧面底边的 y 坐标, 视角坐标系</li>
<li><code>top</code> - 锥台前侧面顶边的 y 坐标, 视角坐标系</li>
<li><code>zNear</code> - 锥台最近处离人眼的距离, 即前侧面 z 坐标</li>
<li><code>zFar</code> - 锥台最远处离人眼的距离, 即后侧面 z 坐标</li>
</ul>
<p>用法举例:</p>
<p><code>glm::frustum(-0.005f, 0.005f, -0.005f, 0.005f, 0.01f, 100.0f);</code></p>
</blockquote>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><span class="octicon octicon-tip" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-light-bulb mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Tip</p>
<p>锥台(frustum)又称平截头体, 是梯形的三维版本</p>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="46-锥台形的可视空间为什么就能产生近大远小的透视效果">4.6 锥台形的可视空间为什么就能产生&quot;近大远小&quot;的透视效果?<a href="#46-锥台形的可视空间为什么就能产生近大远小的透视效果" class="hash-link" aria-label="4.6 锥台形的可视空间为什么就能产生&quot;近大远小&quot;的透视效果?的直接链接" title="4.6 锥台形的可视空间为什么就能产生&quot;近大远小&quot;的透视效果?的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-01_14-55-38-4ae3fb9e434fec82d9aaaf16c2c34e6a.png" width="1925" height="840" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-01_14-56-46-076f0564d986f0d680eb08ac95161da9.png" width="2118" height="1144" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-01_15-01-09-f5ffae56388a949820f6741a61db00dd.png" width="2141" height="1142" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="47-fovfield-of-view-视野角">4.7 FoV(Field of View, 视野角)<a href="#47-fovfield-of-view-视野角" class="hash-link" aria-label="4.7 FoV(Field of View, 视野角)的直接链接" title="4.7 FoV(Field of View, 视野角)的直接链接">​</a></h3>
<p>将 <code>glm::frustum</code> 得到的梯形可视空间, 两边延伸, 相交的点就是我们的眼睛。这两条直线所交成的夹角, 就是<code>视野角</code>。</p>
<p><img decoding="async" loading="lazy" alt="视野角 ##w500##" src="/HXLoLi/assets/images/HX_2025-08-01_15-08-45-0bc793f8f89096d2fc117ea0822c17d7.png" width="1563" height="763" style="width:500px;border-radius:10px"></p>
<p>视野角越大, 说明视角越开阔, 一个屏幕里能容纳的景物就越多, 单个物体显得越小, 透视效果就越明显。视野角为 0 度时, 透视投影将退化为正交投影。</p>
<p>望远镜就是通过缩小视野角, 增加了小景物的视大小; 猫眼就是通过放大视野角, 压缩景物, 增加了你能看到的视野范围。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="48-横向视野角fovx与纵向视野角fovy">4.8 横向视野角(FoVx)与纵向视野角(FoVy)<a href="#48-横向视野角fovx与纵向视野角fovy" class="hash-link" aria-label="4.8 横向视野角(FoVx)与纵向视野角(FoVy)的直接链接" title="4.8 横向视野角(FoVx)与纵向视野角(FoVy)的直接链接">​</a></h3>
<p>由于屏幕往往不是正方形的, 因此说视野角时, 需要说明是横向(x轴方向)的还是纵向(y轴方向)的视野角。</p>
<p><img decoding="async" loading="lazy" alt="##w500##" src="/HXLoLi/assets/images/HX_2025-08-01_15-12-43-26dc617d9176a71dab46776366d75ab0.png" width="1069" height="940" style="width:500px;border-radius:10px"></p>
<blockquote>
<p>例如对于常见的宽大于高的屏幕, 其横向视野角就会比纵向视野角大一些, 例如对于 16: 9 的屏幕而言, 会大 16 / 9 倍。</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="49-fov-的计算公式">4.9 FoV 的计算公式<a href="#49-fov-的计算公式" class="hash-link" aria-label="4.9 FoV 的计算公式的直接链接" title="4.9 FoV 的计算公式的直接链接">​</a></h3>
<p>如何确定对人眼舒适的视野角? 虽然人眼能看到 180 度, 但你不可能眼睛贴在屏幕上看。为了让显示器显示出来图形的透视, 和你实际感受到的透视匹配, 我们需要根据你眼睛离显示器的距离 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span> 和显示器高度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> 来计算。</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mi>o</mi><msub><mi>V</mi><mi>y</mi></msub><mo>=</mo><mn>2</mn><mi>arctan</mi><mo>⁡</mo><mfrac><mi>h</mi><mrow><mn>2</mn><mo>×</mo><mi>d</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">FoV_y = 2 \arctan{\frac{h}{2 \times d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1408em;vertical-align:-0.7693em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">arctan</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">d</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>
<p>如果人眼观察距离与计算机中渲染所用的视野角不匹配, 那么就会看起来不舒服, 透视显得不真实(过度透视或缺少透视).</p>
<blockquote>
<p>例如小彭老师显示器宽 60 厘米, 高 33.75 厘米。小彭老师眼睛到显示器距离为 50 厘米, 那么他所需的视野角是:</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>o</mi><msub><mi>V</mi><mi>y</mi></msub><mo>=</mo><mn>2</mn><mi>arctan</mi><mo>⁡</mo><mfrac><mn>33.75</mn><mrow><mn>2</mn><mo>×</mo><mn>50</mn></mrow></mfrac><mo>=</mo><mn>37</mn><mtext>度</mtext></mrow><annotation encoding="application/x-tex">FoV_y = 2 \arctan \frac{33.75}{2 \times 50} = 37 度</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">arctan</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">×</span><span class="mord mtight">50</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">33.75</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">37</span><span class="mord cjk_fallback">度</span></span></span></span></p>
<p>反之如果你所玩游戏的 FoV 是固定不让改的, 那么你可以用这个公式从纵向视野角反推你离屏幕所需的舒适距离:</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mfrac><mi>h</mi><mrow><mn>2</mn><mo>×</mo><mi>tan</mi><mo>⁡</mo><mfrac><mrow><mi>F</mi><mi>o</mi><msub><mi>V</mi><mi>y</mi></msub></mrow><mn>2</mn></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">d = \frac{h}{2 \times \tan \frac{FoV_y}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6962em;vertical-align:-0.8161em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.4247em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">×</span><span class="mop mtight"><span class="mtight">t</span><span class="mtight">a</span><span class="mtight">n</span></span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0933em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:0.049em"></span></span><span style="top:-3.6052em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2306em"><span style="top:-2.3em;margin-left:-0.2222em;margin-right:0.1em"><span class="pstrut" style="height:2.5em"></span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3944em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8161em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>例如代入纵向视野角为 40 度时, 我要离屏幕 46.4 厘米远。</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="410-常见的-fovy-取值是-3040-度">4.10 常见的 FoVy 取值是 30～40 度<a href="#410-常见的-fovy-取值是-3040-度" class="hash-link" aria-label="4.10 常见的 FoVy 取值是 30～40 度的直接链接" title="4.10 常见的 FoVy 取值是 30～40 度的直接链接">​</a></h3>
<p>由于不同设备的宽高比不一, 纵向视野和横向视野角度会有所不同, 图形学中常用纵向视野角来表示视野大小。综合考虑一般人的用眼习惯, 游戏中的摄影机纵向视野角都会选择在 35 度左右。</p>
<p>然后横向视野角(FoVx)等于把纵向视野角(FoVy)乘以宽高比(aspect):</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mi>o</mi><msub><mi>V</mi><mi>x</mi></msub><mo>=</mo><mi>F</mi><mi>o</mi><msub><mi>V</mi><mi>y</mi></msub><mo>×</mo><mi>a</mi><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">FoV_x = FoV_y \times aspect</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span></span></span></span></span>
<p>宽高比就是屏幕宽度除以高度的比值:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>s</mi><mi>p</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo>=</mo><mfrac><mi>w</mi><mi>h</mi></mfrac></mrow><annotation encoding="application/x-tex">aspect = \frac{w}{h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>电脑显示屏常见的宽高比都是 16 / 9 = 1.7777。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="411-projection-矩阵---调用-glmperspective-函数创建透视投影">4.11 Projection 矩阵 - 调用 <code>glm::perspective</code> 函数创建透视投影<a href="#411-projection-矩阵---调用-glmperspective-函数创建透视投影" class="hash-link" aria-label="411-projection-矩阵---调用-glmperspective-函数创建透视投影的直接链接" title="411-projection-矩阵---调用-glmperspective-函数创建透视投影的直接链接">​</a></h3>
<p>由于 <code>glm::frustum</code> 的六个参数计算比较困难且不直观, 因此又提供了 <code>glm::perspective</code> 这个更加直观易懂的函数, 他是对 <code>glm::frustum</code> 的封装, 基于视野角和宽高比来求得透视矩阵而不是不直观的顶面矩形 x、y 坐标。</p>
<p><code>glm::perspective(fovy, aspect, zNear, zFar);</code></p>
<blockquote>
<p>构造一个锥台(梯形), 锥台内为可视空间, 锥台外的物体会被 OpenGL 裁剪掉。</p>
<p>接受四个浮点数参数:</p>
<ul>
<li><code>fovy</code> - 纵向视野角</li>
<li><code>aspect</code> - 宽高比 = 显示器的宽 / 显示器的高</li>
<li><code>zNear</code> - 锥台最近处离人眼的距离, 即前侧面 z 坐标</li>
<li><code>zFar</code> - 锥台最远处离人眼的距离, 即后侧面 z 坐标</li>
</ul>
<p>注: <code>zNear</code> 和 <code>zFar</code> 必须均为正数</p>
</blockquote>
<p>代码示例:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 40 度是我们的纵向视野角 FoVy, 为了转换成 glm 函数高贵的弧度制, 需要调用 glm::radians 转换</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">40.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">width </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.01f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">100.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 0.01f 和 100.0f 分别是 zNear 和 zFar 参数, 表示最靠近能看到的物体和最远能看到的物体!</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><span class="octicon octicon-note" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-info mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Note</p>
<p>zNear 不可以为 0, zFar 也不可以一味调大</p>
<p>zNear 到 zFar 之间有很多级, 每一级都是等比例划分的, 近处的分级更密集, 精度更高, 远处的精度就会变差一些。如果两个物体落在同一级上的话 OpenGL 就无法分清他们的前后顺序, 就会发生 Z-fighting 现象。</p>
<p>如果 zNear 和 zFar 的数量级相差太大, 那么深度缓冲的精度就会受损, 导致 Z-fighting 现象更容易发生。</p>
<p>通常来说我们可以用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>z</mi><mi>F</mi><mi>a</mi><mi>r</mi><mi mathvariant="normal">/</mi><mi>z</mi><mi>N</mi><mi>e</mi><mi>a</mi><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(zFar / zNear)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mord mathnormal" style="margin-right:0.13889em">F</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mclose">)</span></span></span></span> 来判断深度缓冲的精度, 这个数值越大说明精度越差。</p>
</div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="412-深度缓冲精度示意图">4.12 深度缓冲精度示意图<a href="#412-深度缓冲精度示意图" class="hash-link" aria-label="4.12 深度缓冲精度示意图的直接链接" title="4.12 深度缓冲精度示意图的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="深度缓冲精度示意图 ##w700##" src="/HXLoLi/assets/images/HX_2025-08-01_15-42-23-0ba97f244948887b2b7e39ad83c97ddc.png" width="1855" height="514" style="width:700px;border-radius:10px"></p>
<blockquote>
<p>每两个线段之间为一档, 每档对应一个 int24 的整数值</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="##w700##" src="/HXLoLi/assets/images/HX_2025-08-01_15-43-53-7582c7d47c99b5b9216f99fe06bf76bb.png" width="1928" height="840" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="413-z-fighting-实例图">4.13 Z-fighting 实例图<a href="#413-z-fighting-实例图" class="hash-link" aria-label="4.13 Z-fighting 实例图的直接链接" title="4.13 Z-fighting 实例图的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="##w700##" src="/HXLoLi/assets/images/HX_2025-08-01_15-45-09-31742b2ea002b54b3b4a9157c0c9e71e.png" width="1975" height="728" style="width:700px;border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="##w700##" src="/HXLoLi/assets/images/HX_2025-08-01_15-48-01-8d50e4b81685b36ad23b79513e61a753.png" width="1981" height="852" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="414-矩阵实现透视投影的原理-除以-w-大法好">4.14 矩阵实现透视投影的原理: 除以 w 大法好<a href="#414-矩阵实现透视投影的原理-除以-w-大法好" class="hash-link" aria-label="4.14 矩阵实现透视投影的原理: 除以 w 大法好的直接链接" title="4.14 矩阵实现透视投影的原理: 除以 w 大法好的直接链接">​</a></h3>
<p>回顾上一课, 矩阵为什么要 4x4?</p>
<p>为什么针对三维矢量的变换, 矩阵却是四维的呢?</p>
<ul>
<li>原因之一就是为了伺候平移, 普通的 3x3 矩阵无法实现坐标原点的平移。</li>
<li>当要变换的三维矢量是绝对矢量时, 加上 w 分量, 为 1, 就可以让绝对矢量叠加上平移量。</li>
<li>当要变换的三维矢量是相对矢量时, 加上 w 分量, 为 0, 就可以让相对矢量不受平移影响。</li>
</ul>
<p>对于透视投影, w 有了额外的作用。</p>
<ul>
<li>规定所有绝对矢量, 从四维空间转换回三维空间时, 需要把他的所有 x、y、z 坐标除以 w 分量, 得到三维坐标。这就是 Perspective Divide(透视除法)。</li>
<li>新坐标: (x / w, y / w, z / w)</li>
<li>对于 w 为 1 的情况, 则无事发生, x、y、z 原封不动保留了。</li>
<li>如果令 w 为 z 呢?</li>
<li>新坐标: (x / z, y / z, 1)</li>
<li>他的 z 坐标, 因为 z / z 变成 1 了! 这可不行, 我们还指望着 z 分量用于深度测试呢! z 值全部变成 1 了, 就没法分清物体前后顺序了。</li>
</ul>
<p>通过塞偏移量修复 z 轴的退化</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># &lt;-- 这里</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">bash</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所以为了防止 z 轴退化, 需要在令 w 为 z 的同时, 令新 z 加上一个偏移量:</p>
<ul>
<li>新坐标: (x / z, y / z, (z + 1) / z)</li>
<li>化简后: (x / z, y / z, 1 / z + 1)</li>
</ul>
<p>但是这样最终新坐标 z’ 的值域变成 1 到无穷大了。</p>
<p>而 24 位有符号整数量化的深度缓冲, 只能接受 z 值为 -1 到 1 的区间, 才能正确地处理前后关系, 超出这个区间就会被 OpenGL 裁剪而不显示。</p>
<p>所以需要&quot;精心&quot;调节 zz、zw 和 wz 这三个参数才能使得规定的 zNear 到 zFar 刚好满满当当映射到整个 -1 到 1 区间。</p>
<p>现实中调用 <code>glm::perspective(near, far, fovy, aspect)</code> 会得到的矩阵:</p>
<p>以下就是 glm 作者&quot;精心&quot;调整后的结果:</p>
<div style="text-align:center"><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi></mrow><mo>⋅</mo><mi>tan</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">y</mi></mrow><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mrow><mi>tan</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">y</mi></mrow><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mfrac><mrow><mtext> </mtext><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mo>+</mo><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mtext> </mtext></mrow><mrow><mtext> </mtext><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mo>−</mo><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mtext> </mtext></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mfrac><mrow><mn>2</mn><mtext> </mtext><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mtext> </mtext><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow></mrow><mrow><mtext> </mtext><mrow><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mo>−</mo><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mtext> </mtext></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">P =
\begin{bmatrix}
\frac{1}{\mathrm{aspect}\cdot \tan(\mathrm{fovy}/2)} &amp; 0 &amp; 0 &amp; 0\\
0 &amp; \frac{1}{\tan(\mathrm{fovy}/2)} &amp; 0 &amp; 0\\
0 &amp; 0 &amp; -\frac{\,\mathrm{far}+\mathrm{near}\,}{\,\mathrm{far}-\mathrm{near}\,} &amp; -1\\
0 &amp; 0 &amp; -\frac{2\,\mathrm{far}\,\mathrm{near}}{\,\mathrm{far}-\mathrm{near}\,} &amp; 0
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.2971em;vertical-align:-2.3985em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.800em" viewBox="0 0 667 4800"><path d="M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v1200 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8985em;"><span style="top:-5.0534em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">aspect</span></span><span class="mbin mtight">⋅</span><span class="mop mtight"><span class="mtight">t</span><span class="mtight">a</span><span class="mtight">n</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathrm mtight" style="margin-right:0.01389em;">fovy</span></span><span class="mord mtight">/2</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.6883em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.2882em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.0048em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3985em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8985em;"><span style="top:-5.0534em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.6883em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">t</span><span class="mtight">a</span><span class="mtight">n</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathrm mtight" style="margin-right:0.01389em;">fovy</span></span><span class="mord mtight">/2</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2882em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.0048em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3985em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8985em;"><span style="top:-5.0534em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.6883em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.2882em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathrm mtight">far</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathrm mtight">near</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathrm mtight">far</span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathrm mtight">near</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.0048em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathrm mtight">far</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathrm mtight">near</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathrm mtight">far</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathrm mtight">near</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3985em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8985em;"><span style="top:-5.0534em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.6883em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.2882em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-1.0048em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3985em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.800em" viewBox="0 0 667 4800"><path d="M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v1200 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></div>
<p>加上这么一堆系数后, 就可以保证 <code>z = near</code> 会被映射到 <code>z’ = -1</code>; <code>z = far</code> 会被映射到 <code>z’ = 1</code>。然后又由于深度缓冲是 24 位的整数, 所以浮点的裁剪空间 z 值 -1 量化后变成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>23</mn></msup></mrow><annotation encoding="application/x-tex">-2^{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">23</span></span></span></span></span></span></span></span></span></span></span></span>, 1 量化变成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>23</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{23}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">23</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>。</p>
<p><img decoding="async" loading="lazy" alt="windous lj" src="/HXLoLi/assets/images/HX_2025-08-01_16-02-57-8b34be2149c07eefd07381cc911cab21.png" width="2205" height="1222" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="415-焦距与fov">4.15 焦距与FoV<a href="#415-焦距与fov" class="hash-link" aria-label="4.15 焦距与FoV的直接链接" title="4.15 焦距与FoV的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="焦距" src="/HXLoLi/assets/images/HX_2025-08-01_16-13-37-d6444013e2b986552880f6a6ac661ad6.png" width="2120" height="1081" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" alt="xvsd" src="/HXLoLi/assets/images/HX_2025-08-01_16-14-13-c5e427262fddc6316ef342cdce71626f.png" width="2052" height="1118" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="416-变焦应用经典案例-希区柯克变焦">4.16 变焦应用经典案例: 希区柯克变焦<a href="#416-变焦应用经典案例-希区柯克变焦" class="hash-link" aria-label="4.16 变焦应用经典案例: 希区柯克变焦的直接链接" title="4.16 变焦应用经典案例: 希区柯克变焦的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="希区柯克变焦 ####" src="/HXLoLi/assets/images/HX_2025-08-01_16-16-20-02ed31bd60e3178245b50278ce3c504a.gif" width="517" height="229" style="border-radius:10px"></p>
<p>缩小焦距, 这会增大 FoV, 让拍摄目标看起来变得更小。</p>
<p>同时缩小离要拍摄目标的距离, 这会让拍摄目标看起来变得更大。</p>
<p>如果距离和焦距缩小的速度相等, 就会相互抵消, 让拍摄目标视大小不变的情况下, 让周围景物的透视强度发生快速变化, 产生悬疑, 惊悚, 或是强调拍摄目标的效果。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="五矩阵与法线在固定管线中的使用">五、矩阵与法线在固定管线中的使用<a href="#五矩阵与法线在固定管线中的使用" class="hash-link" aria-label="五、矩阵与法线在固定管线中的使用的直接链接" title="五、矩阵与法线在固定管线中的使用的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-第四节的代码实现">5.1 第四节的代码实现<a href="#51-第四节的代码实现" class="hash-link" aria-label="5.1 第四节的代码实现的直接链接" title="5.1 第四节的代码实现的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">// Perspective Divide - 除以 w 的实现</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec4 pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">show</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glBegin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> obj </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ObjParser res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">parser</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;./obj/monkey.obj&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 透视投影矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">40.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">w </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.01f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">100.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 视角 (相机位置、目标、上方向)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">5</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 视角矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">lookAt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 世界矩阵 (这里是单位变换)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// MVP 组合: 局部顶点 -&gt; 世界 -&gt; 相机 -&gt; 裁剪空间</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 mvp </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> vertices </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getVertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getTriangles</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> a </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> b </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> c </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 计算裁剪空间坐标后做透视除法得到 NDC, 再送给固定管线绘制</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">mvp </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">mvp </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">mvp </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行效果:</p>
<p><img decoding="async" loading="lazy" alt="##w300##" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAt4AAAHZCAIAAAA+G6stAAAACXBIWXMAAA7EAAAOxAGVKw4bAAANs0lEQVR4nO3dSXLjSBBFQUr3vzN7obbSTIFADj8y3Ve9lBkyYI8BoOt2AwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgNZeZv8BQLT7/f7vv19e3DGA7txogNvtc4I8S7IADbmhwEau9Mc5qgV4lrsGrGZ8f5yjWoAfuTVAVVUS5FmSBTbnFgDRVu2Pc1QL7MCcQwQJcoVkgZWYZxhHf4ynWqAcQwvtSZB8kgViGU44SX+sSrXAXCYQ/iBBeCNZYAyTBr8SJXwnUKA3MwY/ECU8JlCgH9MFX+kSjlAn0InRgk90CcepE+jBXME7XcKz1Ak0Z6jgf7qEc9QJtGWi4HbTJVyjTqAh4wS6hAbUCbRiltidLqEVdQJNGCS2pktoS53AdaaIfekSelAncJERYlO6hH7UCVxhftiRLqE3dQKnGR62o0sYQ53AOSaHvegSRlIncIKxYSO6hPHUCTzLzLALXcIs6gSeYmDYgi5hLnUCx73O/gMAAN4JedZnZUICixM4yKiwOF1CDnUCR5gTVqZLSKNO4E+GhGXpEjKpE3jMhLAmXUIydQIPGA8WpEvIp07gN2aD1egSqlAn8CODwVJ0CbWoE/jOVLAOXUJF6gS+MBIsQpdQlzqBj8wDK9AlVKdO4B/DQHm6hDWoE3hjEqhNl7ASdQI3aUJpuoT1qBMwA1SlS1iVOmFzBoCSdAlrUyfszOmnHl3CDtQJ23qd/QcAALxT5RRjZcI+LE7Yk3NPJbqE3agTNuTQU4YuYU/qhN048dSgS9iZOmErjjvpRAm8EShswkEnmi6Bj9QJO3DKyaVL4Dt1wvIccULpEviNOmFtzjdxRAkcIVBYlZNNFl0Cx6kTluRYE0SXwLPUCetxpkmhS+AcdcJiHGjmEyVwnUBhGY4yk+kSaEWdsAbnmJl0CbSlTliAQ8w0ugR6UCdU5wQzgSiB3gQKdTm7jKZLYAx1QlEOLkPpEhhJnVCRU8sgogRmESjU4rwygi6BudQJhTisdKdLIIE6oQonlb50CeRQJ5TgmNKLKIFMAoVwDihd6BJIpk5I5nTSni6BfOqEWI4mjekSqEKdkMm5pBlRAhUJFNI4kbShS6AudUIUx5EGdAlUp07I4SxylS6BNagTQrzO/gMAAN5JEwAgiDQBAIJIEwAgiJeeuMQ7sLASb8KSwCnkDEUCa9MoTOTw8RxRAvsQKEzh2HGIIoGdaRRGctr4gygB3ggUxnDO+JkiAX6jUejK8eIrUQIcIVDoxMHinSgBniVQaM6RQpEADWgUWnGStiZKgLYECtc5QztSJEBvGoXTHJ29iBJgJIHCCQ7NFhQJMJdG4Tj/8jAAEESaAABBbNh24ZkOMIunOTzF1iSCbgA4zS10MUp2vj+HqskPDqMLzDLmJmY3swwXcrKLxXB8FKUJMMuwO5U6WYOrOFm/Yvg+ouoEGG/kvUiarMFVnEkrALSlThbgNVgAIIi6nMbKBKAHi5PqXL85dAlAP+qkNA90AIAgunICKxOA3ixO6nLlRtMlAGOok6I80AEAgijKoaxMAEayOKnI1gQACCInx7EyARjP4qQcF2wQXQIwizqpxQMdACCIkBzBygRgLouTQlyq7nQJQAJ1UoUHOgBAEAnZl5UJQA6LkxJsTQCAIPqxIysTgDQWJ/lcoV50CUAmdRLOAx0AIIhy7MLKBCCZxUky16Y9XQKQT53E8kAHAAiiGRuzMgGowuIkk60JABBEMLZkZQJQi8VJIJekGV0CUJE6SeOBDgAQRCq2YWUCUJfFSRQXowFdAlCdOsnhSrShTgDq0iVRvGsCAASRJgBAEGkCAASRJgBAEGkCAATxTnIzPtIBqMjnOWlsTQCAINIEAAgiTQCAIB6wteR1E4BavGgSyNYEAAgiTQCAINIEAAjiGVtjXjcBqMKLJplsTQCAINIEAAgiTQCAIB6zted1E4B8XjSJZWsCAASRJgBAEGkCAATxpK0Lr5sAJPOiSTJbEwAgiDQBAIJIEwAgiIdtvXjdBCCTF03C2ZoAAEGkCQAQxFKrI890ANJ4mpPP1gQACCJNAIAg0gQACOKRW19eNwHI4UWTEmxNAIAg0gQACCJNAIAgnrp153UTgAReNKnC1gQACCJNAIAg0gQACOLB2wheNwGYy4smhdiaAABBpAkAEESaAABBPHsbxOsmALN40aQWWxMAIIg0AQCC2HGN45kOwHie5pTjgo0mUADGECVFuWxzCBSAfkRJaS7eNOoEoAddUp3rN5lAAWhFlKzBVZxPnQBcp0uW4UKmECgA54iSxbicQdQJwLN0yXpc0SzqBOA4XbIkFzWRQAF4TJQszKUNpU4AfqNL1ubqRhMoAB+Jkh24xunUCcAbXbIJl7kGgQLsTJRsxcUuQ50Ae9Ilu3G9K1EnwG50yYZc8noECrADUbItF74kdQKsTZfszLUvTKAA6xElOAG1qRNgJbqEmzRZgDoB1qBLeOMcLEKgAHWJEj5yGtahToCKdAlfOBCrEShAFaKEHzkWC1InQD5dwm+cjDWpEyCZLuEBh2NlAgVII0r4kyOyOHUC5NAlHOGUbEGgAHOJEo5zVrYjU4Ax5AjnODe7UypAK1qEJhwjPlEqwHFahB6cKh5RKsBHWoQBHDKeI1ZgH0KEKRw7LpleKr/dOqf/YfBA7LnVIiRwCmmp+Y314o1y+o0evkg70lqEQA4lHf15Gx12W9QozJVz1LUI+ZxRNiJQGE8KwLPMDNsRKIwhSuAck8O+NAo9KBK4yAixO4FCK6IEmjBI8D+NwjmKBNoyUfCJQOE4UQI9mCv4mUbhN4oEujJg8IhA4SNRAgMYMzhEo+xMkcBI5g2eIFB2I0pgPFMHTxMoOxAlMIvZgzPUydp0CUxk/OAkdbIqXQJzmUA4T52sR5fAdK+z/wAAgHd+H8AlFicrsTKBBOYQrlIna9AlEMIoQgPqpDpdAjlMI7ShTurSJRDFQEIz6qQiXQJpzCS0pE5q0SUQyFhCY+qkCl0CmUwmtKdO8ukSiOV/uQYABPG7AbqwOElmZQLJzCf0ok4y6RIIZ0ShI3WSRpdAPlMKfamTHLoESjCo0J06SaBLoAqzCiOok7l0CRRiXGEQdTKLLoFaTCyMo07G0yVQjqGFodTJSLoEKvJ/gwUAgvhJAaNZnIxhZQJFGV2YQJ30pkugLtMLc6iTfnQJlGaAYRp10oMugerMMMykTtrSJbAAX+gAAEH8woBprEx6sDiB6mxNAIAg0gQACGLzCXN4mtOPZzpQmq0JABDEbwuYwMqkN4sTqMvWBAAI4ocFjGZlMobFCRRlawIABJEmAEAQC08YytOckTzTgYpsTQCAIH5SwDhWJuNZnEA5tiYAQBC/J2AQK5NZLE6gFlsTACCIHxMwgpXJXBYnUIitCQAQRJoAAEEsOaE7T3MSeKYDVdiaAABB/IyAvqxMclicQAm2JgBAEL8hoCMrkzQWJ5DP1gQACCJNAIAgdpvQi6c5mTzTgXC2JgBAEL8eoAsrk2QWJ5DM1gQACOKnA7RnZZLP4gRi2ZoAAEGkCQAQRJoAAEGkCQAQxItg0Jh3YKvwJixksjUBAIJIEwAgiDQBAIJIEwAgiDQBAIJIEwAgiG/noCVfDtfi+2EIZGsCAASRJgBAEGkCAASRJgBAEGkCAASRJgBAEB/OQTO+HK7I98OQxtYEAAgiTQCAINIEAAgiTQCAINIEAAji1XRow+c5dflIB6LYmgAAQaQJABBEmgAAQaQJABBEmgAAQaQJABDEJ3PQgC+Hq/P9MOSwNQEAgkgTACCINAEAgkgTACCINAEAgngpHa7yec4afKQDIWxNAIAg0gQACCJNAIAg0gQACCJNAIAg0gQACOJjObjEl8Mr8f0wJLA1AQCCSBMAIIg0AQCCSBMAIIg0AQCCSBMAIIgv5eA8Xw6vx/fDMJ2tCQAQRJoAAEGkCQAQRJoAAEGkCQAQxLvocJLPc1blIx2Yy9YEAAgiTQCAINIEAAgiTQCAINIEAAgiTQCAINIEAAgiTQCAINIEAAgiTQCAINIEAAgiTQCAINIEAAgiTQCAIP7tbzjjfr/P/hPo6OXFvRGmsTUBAIJIEwAgiDQBAIJIEwAgiDQBAIJIEwAgiDQBAIJIEwAgiDQBAIJIEwAgiDQBAIJIEwAgiDQBAIJIEwAgiH/4G552v99n/wl09/Li9ghz2JoAAEGkCQAQRJoAAEGkCQAQRJoAAEGkCQAQRJoAAEGkCQAQRJoAAEGkCQAQRJoAAEGkCQAQxL9fBWf4F/7W5t/2g4mMH5ykTlalS2AuD3QAgCB+HMB5FifrsTKB6QwhXKJOVqJLIIEHOgBAED8R4CqLkzVYmUAIowgNqJPqdAnkMI3QhjqpS5dAFO+aAABB/FaAZixOKrIygTRmErqQKcnkCCQzn9CdTEkgR6AKswqjKZUxtAgUZXRhMqXSihaBNZhkyKJUjtMisCSDDdGUykdaBHZgzqGS3UpFi8CGjD2soHqySBDgH7cDWFxOtegP4Ah3CthUv2SRIMAV7iDAV0eqRX8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsIP/AMmJBW3W5nTRAAAAAElFTkSuQmCC" width="734" height="473" style="width:300px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52-升级我们的数据结构---支持法线和纹理坐标暂时只用到法线">5.2 升级我们的数据结构 - 支持法线和纹理坐标(暂时只用到法线)<a href="#52-升级我们的数据结构---支持法线和纹理坐标暂时只用到法线" class="hash-link" aria-label="5.2 升级我们的数据结构 - 支持法线和纹理坐标(暂时只用到法线)的直接链接" title="5.2 升级我们的数据结构 - 支持法线和纹理坐标(暂时只用到法线)的直接链接">​</a></h3>
<!-- -->
<!-- -->
<p>同时也要修改解析代码:</p>
<!-- -->
<!-- -->
<p><img decoding="async" loading="lazy" alt="函数含义 ##w800##" src="/HXLoLi/assets/images/HX_2025-08-04_09-55-56-13ef062b0714bd62faf43b81d1c5fbd1.png" width="2008" height="328" style="width:800px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="53-什么是法线">5.3 什么是法线<a href="#53-什么是法线" class="hash-link" aria-label="5.3 什么是法线的直接链接" title="5.3 什么是法线的直接链接">​</a></h3>
<p>要理解面的法线, 就要从直线的方向向量说起:</p>
<p>要确定一条直线的朝向很容易。在直线上任意两点之间连成一条矢量, 这条矢量称为直线的 <strong>方向向量</strong>, 可以唯一确定一条直线, 通常用符号 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span> 来表示。</p>
<p>但也存在问题: 方向矢量的方向表示了直线的方向, 那么这条矢量可长可短呀? 为了统一起见, 我们规定所有方向向量必须<code>归一化(normalize)</code>, 也就是把矢量长度强制设为 1。</p>
<p>但还是存在可上可下的问题, 例如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">-d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord">−</span><span class="mord mathnormal">d</span></span></span></span> 同样都是归一化的、和直线平行的方向向量。</p>
<p>所以通常认为方向向量表示的是一条射线, 而不是直线。</p>
<p>直线的方向, 可以用一根与 <strong>直线平行的方向向量</strong> 来唯一确定。</p>
<p>那么如何确定一个面的朝向? 向量是一维的, 怎么来表示二维的面的朝向?</p>
<p>为了方便, 我们可以用一条<code>垂直于平面的直线</code>, 称为法线, 来唯一地表示一个平面。</p>
<p>法线是平面的固有属性, 所以我们可以用法线的方向向量来表示平面, 称为平面的法向向量。</p>
<p>法向向量, 我通常直接简称法线, 定义就是&quot;一个垂直于面的单位矢量&quot;, 同样为了避免歧义这个矢量长度必须为 1, 即需要归一化(normalize)。</p>
<p><img decoding="async" loading="lazy" alt="##w700##" src="/HXLoLi/assets/images/HX_2025-08-04_10-17-32-11c72e295872869487198e9fe0fc6deb.png" width="1975" height="1124" style="width:700px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="54-像素点亮度的计算就是基于法线的">5.4 像素点亮度的计算就是基于法线的<a href="#54-像素点亮度的计算就是基于法线的" class="hash-link" aria-label="5.4 像素点亮度的计算就是基于法线的的直接链接" title="5.4 像素点亮度的计算就是基于法线的的直接链接">​</a></h3>
<p>空间中的三角形面也具有法线。OpenGL 要想计算光照, 就需要用到法线, 这根单位矢量。</p>
<p>光照模型具有很多种, 其中一种 Lambert 模型是这样规定的:</p>
<p>反射出来被我们看到的颜色 = 物体固有颜色 * 法线与入射光线方向的点积</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo>=</mo><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo>×</mo><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><mo>−</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">color = basecolor \times dot(N, -I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">co</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.02778em">or</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal">seco</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.02778em">or</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">)</span></span></span></span></span>
<p>对于太阳光这种平行光源, 入射光方向是固定的, 但是物体表面不同地方的三角形面片, 法线是不同的, 例如图中的求, 这样就会产生的明暗变化的效果。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="55-知识点-顶点法线-vs-面法线">5.5 知识点: 顶点法线 vs 面法线<a href="#55-知识点-顶点法线-vs-面法线" class="hash-link" aria-label="5.5 知识点: 顶点法线 vs 面法线的直接链接" title="5.5 知识点: 顶点法线 vs 面法线的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-26-20-5ac3777d8da783f9da4457079d73ad4c.png" width="1894" height="1021" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-26-47-895b25f2e0285ab0e4507afe7a659f15.png" width="1891" height="1039" style="border-radius:10px"></p>
<p>从面法线到顶点法线, 计算方法就是求邻居面法线的平均值(使用 scatter 法)</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">Face</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> vert_index</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 face_normal</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">Vertex</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 position</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 vert_normal</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">Face</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">Vertex</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> vert </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vert</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vert_normal </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> face </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vert_index</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vert_normal </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> face</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">face_normal</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> vert </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vert</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vert_normal </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vert</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vert_normal</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>更准确的计算顶点法线需要用面的 asin 系数加权平均</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">vector3D </span><span class="token function" style="color:hsl(207, 82%, 66%)">triangleNormalFromVertex</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> face_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> vertex_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// This assumes that A-&gt;B-&gt;C is a counter-clockwise ordering</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vector3D A </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> mesh</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">face</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">face_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vertex</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">vertex_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vector3D B </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> mesh</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">face</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">face_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vertex</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vertex_id </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">%</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vector3D C </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> mesh</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">face</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">face_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">vertex</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vertex_id </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">%</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    vector3D N </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">B </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> A</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> C </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> A</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> sin_alpha </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">length</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">N</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">length</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">B </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> A</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">length</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">C </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> A</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">N</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">asin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">sin_alpha</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 加权系数和三角形的&quot;狭长程度&quot;有关</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">   </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 如果是三角形一个很小的锐角, 那么这个三角形面法线对顶点法线的贡献就减小</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 可以理解为贡献大小与这个面邻居所占 360 度角度中的多少角正比</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">computeNormals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vertex v in mesh</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        vector3D </span><span class="token function" style="color:hsl(207, 82%, 66%)">N</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> NumOfTriangles</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">mesh</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">face</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">contains</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 他没用 scatter 法, 复杂度变成 O(n^2) 了嘿嘿</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> VertexID </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">index_of_v_in_triangle</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// Can be 0,1 or 2</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                N </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> N </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">triangleNormalFromVertex</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> VertexID</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        N </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">N</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">add_N_to_normals_for_vertex_v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">N</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-36-17-e212267307aa3a17b634819a16582a46.png" width="1909" height="1084" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-36-56-479c488c258c495b4cd4cb23aba74c0f.png" width="2079" height="1095" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="56-obj-中的法线">5.6 OBJ 中的法线<a href="#56-obj-中的法线" class="hash-link" aria-label="5.6 OBJ 中的法线的直接链接" title="5.6 OBJ 中的法线的直接链接">​</a></h3>
<p>OBJ 中的法线是按照&quot;顶点索引大法好&quot;来的, 两种都能兼容</p>
<p>OBJ 既支持顶点法线也支持面法线。为了同时兼容两种情况, 法线是按照面上指定的编号(每组斜杠分割的三个数字的最后一个数)去索引 vn 数组得出的。</p>
<p>例如下面中一个面的四个角落, 都索引了 vn 数组相同的 1 号位置的法线。所以这就是一个面法线的模型, 如果你发现一个 OBJ 模型同一个 f 的四个角落最后的 vn 部分索引和最前面的 v 部分索引相同, 例如:</p>
<div class="language-obj codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-obj codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">f 1/1/1 2/2/2 3/3/3 4/4/4</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">obj</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>那说明这个模型采用的是顶点法线, 他可能是想表现一些非常光滑的东西比如球体。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="57-法线之殇-对于带有不均匀缩放的变换矩阵-直接与其相乘会得到错误结果">5.7 法线之殇: 对于带有不均匀缩放的变换矩阵, 直接与其相乘会得到错误结果<a href="#57-法线之殇-对于带有不均匀缩放的变换矩阵-直接与其相乘会得到错误结果" class="hash-link" aria-label="5.7 法线之殇: 对于带有不均匀缩放的变换矩阵, 直接与其相乘会得到错误结果的直接链接" title="5.7 法线之殇: 对于带有不均匀缩放的变换矩阵, 直接与其相乘会得到错误结果的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-39-38-13464729cdd7f43e166f74ba4ccf1b21.png" width="1977" height="933" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-40-13-6ebc4d9c45cad7979c070271dbdac6d8.png" width="1956" height="1084" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="58-启用一大坨-opengl-高级功能">5.8 启用一大坨 OpenGL 高级功能<a href="#58-启用一大坨-opengl-高级功能" class="hash-link" aria-label="5.8 启用一大坨 OpenGL 高级功能的直接链接" title="5.8 启用一大坨 OpenGL 高级功能的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">       </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 深度测试, 防止前后物体不分</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_MULTISAMPLE</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">      </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 多重采样抗锯齿 (MSAA)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_BLEND</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">            </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用 Alpha 通道 (透明度)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glBlendFunc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_SRC_ALPHA</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GL_ONE_MINUS_SRC_ALPHA</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 标准 Alpha 混合: src*alpha + dst*(1-alpha)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_LIGHTING</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">         </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用固定管线光照 (古代特性)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_LIGHT0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">           </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用 0 号光源 (古代特性)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_COLOR_MATERIAL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">   </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用材质颜色追踪 (古代特性)</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="59-gl_blend-特性介绍">5.9 GL_BLEND 特性介绍<a href="#59-gl_blend-特性介绍" class="hash-link" aria-label="5.9 GL_BLEND 特性介绍的直接链接" title="5.9 GL_BLEND 特性介绍的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-54-52-73624f79d9f4a2c58d64a7111a977521.png" width="1947" height="982" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="510-glblendfunc-可以自定义混合公式">5.10 glBlendFunc 可以自定义混合公式<a href="#510-glblendfunc-可以自定义混合公式" class="hash-link" aria-label="5.10 glBlendFunc 可以自定义混合公式的直接链接" title="5.10 glBlendFunc 可以自定义混合公式的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-56-20-267e5e2daef3db7d9aa26e718e0ebb59.png" width="2033" height="948" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="511-msaa-的原理-不是非黑即白-而是在三角形边缘添加适当透明度">5.11 MSAA 的原理: 不是非黑即白, 而是在三角形边缘添加适当透明度<a href="#511-msaa-的原理-不是非黑即白-而是在三角形边缘添加适当透明度" class="hash-link" aria-label="5.11 MSAA 的原理: 不是非黑即白, 而是在三角形边缘添加适当透明度的直接链接" title="5.11 MSAA 的原理: 不是非黑即白, 而是在三角形边缘添加适当透明度的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_10-59-51-117df414761d5f75f2249fdaa0acb536.png" width="2009" height="884" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_11-00-16-8b2b21899e12cd98154ec4f62531b374.png" width="2108" height="1050" style="border-radius:10px"></p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_11-00-41-de3cf4bc396f6071e97b832c307178ba.png" width="2109" height="1036" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="512-ssaa-和-msaa-的区别">5.12 SSAA 和 MSAA 的区别<a href="#512-ssaa-和-msaa-的区别" class="hash-link" aria-label="5.12 SSAA 和 MSAA 的区别的直接链接" title="5.12 SSAA 和 MSAA 的区别的直接链接">​</a></h3>
<p>之前说过 OpenGL 的渲染管线, 分为光栅化和着色两步。</p>
<p>光栅化包括三角形的边缘判定和深度测试, 负责确定三角形在屏幕中的位置。</p>
<p>着色会调用着色器并行计算每个像素点的颜色, 以符合光学规律实现立体感效果。</p>
<p>SSAA 不仅光栅化会采样 4 次(效果是让三角形的边缘不会锯齿), 还会对物体的颜色采样 4 次(效果是当贴图具有高频细节时, 让贴图上的细节不会锯齿或摩尔纹), 调用 4 次着色器, 开销非常大。</p>
<p>而 MSAA 只会让光栅化采样 4 次, 不会让着色器计算 4 次, 因此相对高效很多。但代价是只能让三角形边缘不锯齿, 而着色器如果会产生非常密的纹理, 那就没法规避锯齿和摩尔纹。</p>
<p>不过因为纹理贴图的摩尔纹问题现在已经可以通过 GPU 内置的 mipmap 技术解决了(后面课程会讲), 所以 MSAA 抗锯齿还是非常实用的。</p>
<ul>
<li>mipmap + MSAA: 我俩是散装 SSAA!</li>
</ul>
<p><img decoding="async" loading="lazy" alt="vs" src="/HXLoLi/assets/images/HX_2025-08-04_11-02-18-e1590188002eb91a2c9ce1ec7a6cf1b9.png" width="1873" height="1021" style="border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="513-运行">5.13 运行<a href="#513-运行" class="hash-link" aria-label="5.13 运行的直接链接" title="5.13 运行的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="效果 ##w400##" src="/HXLoLi/assets/images/HX_2025-08-04_11-13-23-3e23c8bc14129bb2fb416910c6eab54d.png" width="564" height="457" style="width:400px;border-radius:10px"></p>
<p>对比: 禁用深度缓冲</p>
<p><img decoding="async" loading="lazy" alt="禁用 ##w400##" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkMAAAHWCAIAAAD7GBqhAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAUeUlEQVR4nO3dP6wtx13A8Xl/jbEULGFhp4BnCbtBkXHFKwKiSJsGWQgKRJcCiQqE5CYUuImEoEKiSIdSgJBF4zaNA0SmgqcgS7GRcFLERkHClpzo+T37UWx8fHzOvefu2Z2dmd/M51NdP8n37t2zO98zu3P2pgQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwvmu1NwAG9cKdW7uv773zoOKWQHRKBtvaL9a5FA7mUDLIYE2ulhE52FEymCt7rl57+amU0le/8eO831bkGI2SwaGNinUuhYOZlIxBbXE9cFmxzpW9cEnkCE7J6FzcYp1L4RiWktGDjRZctFmsc21RuCRytETJiESxMlI4uqFkNGfTFe1jRmu+jfI2ETk2omRUo1iBKBwtUzIqyNgwxaorY+H0jMWUjKJ+5zce/6/3Hi74HxUrlmWF+9Wnb/7Tv/00+8bQPSWjnDkZU6y+XVk4MWMBJaOQg4wpFvv2CydmnEvJKOEHf/vF2ptAML/yRz+qvQmEcb32BtC/f/yTX6y9CcTjsGE+JWNbxiMWc/Awk5KxISMRKzmEmEPJ2IoxiCwcSFzJig82sT/63H3+dsUtIa433vpo9/Xv/vX/VtwSGmdORn7eRJOdg4oTlIzMjDhsxKHFZZSMnIw1bMoBxoWUjGyMMhTgMOOYkpGH8YViHGwcUDIyMLJQmEOOfUrGWsYUqnDgsaNkrGI0oSKHHxMlAyA2JWM574ipzkFI8rQqFps5gnhUFWvsP7DqBM+yGpw5GUt4I0xTHJCDUzLOZtSgQQ7LkSkZ5zFe0CwH57CUjDMYKWicQ3RMSsZcxghCcKAOSMmYxehAIA7X0ViFz9XWjAtrVuF/9Rs/PviX115+avF3o4y8r9rMVfgXsjR/HErGFVa+vV1csuMB8TLyVkuB12hNyZKYDUPJOGX9VZplJZs/RF5G3vKq9YqsLFkSszEoGZfKcrNhQcnWD5qXkbc5mtr/60uWxGwASsbFct0zP7dk2w2jx4Rt0vI+z1KyJGa9UzIuUCVjJcfTiZJNGt/zYsaVrMLnUJUVzOUH01o/tDXj7HlL8zumZHzOOBmjLjEjIyXjMwNmbPCIDrjzxaxLSkZNg4cEBwBZKBk/U/69aiOjWCObUV4jv3j5zTAt64+SkdLAGaMFYsZKSoaMUZ+YsYaSjU7GUpObtLUGf2UxYzElG9dLdx9/6e7jhX9ogwMo7Sh/eFQ5C8hOyQZV5extOWMtb1t2Lf+yVbZNzKJTshHtztu33n243U85eFRVy6MnTTk4VNb8ibsr7U4BMQtNyYYznbFvvfvwrXcffv2lL5T5oSEyFmIj1wvxaxbbyK+/9IXpXEhiFpmSDWR3S2DTqdixEEMnrSl82OxipmcRKdkoylxRPCZjLFYlZsnkLCAlG8L+FcWSPzdcxsJt8LnC/YLlY+ZKY0RK1r8qVxRTwEGTNpU/kMQsHCXrWa0bYymlV179oPBPzKXjAMf91cofTm6bxaJk3ap1RTFFzhjNqhIzk7MolKxPtaZiqYuMxZ27nNDBL1Xl0BKzEJSsQzJGr8SMC92svQHkVLFhScYo4pVXPyj2if6d/Zi9+sZPC/90rnSt9gaQzbkZyzgcdNmw115+Kvv3/Pt/+cn+f/7Z7/1CSukv/+H9/X/8/S//fPaf28GlxWNVDuDnn7mZxKw95mSdeOnu46ZiTTmI1rEpY9MX+zG78H/cIm/R1Z2ciVlTzMnCW3xFMcso0HfGZk7LrozWsV3Gdg5mZnPMzFuXE7KdWoexyVlTzMlic2OssAXROnacsXQ0M1u8MaPN3qrMzFJKb7378PlnbpqcNcKcLLCVVxRXnv9Txv7gt342bn7rOxmG+KbsfrW8LszYzoKZ2RwdvzrTr5blYF7m+Wduill1ShbV+htji0/+g9P+eMQPN25uFK1jpzM22Shmxzp4mQ5+hVyH9LnErDoliyfXFcUFp/1lJ/zpErQzYhYr1oXmZGxSLGYXivJ6XbadGQ/s+dw2q0vJgsm4RvGsE/70qT6/EMVGybrROjY/Y5O6MTvW4At3epMyHt7zmZzVomSR5F1qP/9Un3OeLyhHrsGxtWgdOzdjk9ZidqziKzjnR+c9wmcSsyqULIwX7tzK+w3nnOdnneFrijJzTGw/WseWZWzSfsyOFXgpzypo9uN8jnvvPMj7DTlNyQLY4lPPV57ey87tXKX51nd+EjFax9ZkbBIxZscyvqDLJoIbHfAnmJyV5AnCrXvhzq0B/yyLjOX9JtVVf0Gr/FGY7NdRuMyN2hvAKdudCb/9a49d+O+vvPrB62/eX/xt7/3ggbN3krFAX/7Sz/3rfy5/UXqy5s7c62/ef/3N+5cd+WsO+xOefvLGe+9/ssV3Zp+ri+3aNAnHF1syvmmt/ga8ru1mUX1caVws4/rJTY//Y26bbc3Tqsh/Dh+POOO0bdOLgQueaBXXpuv+p2O+ymOu2IKSja7M/YPLRqXOClfgnlZ/Mav4Qexaz2wkOyUbV/VlHamvwhVbmhE0Zu08OmSfyVkf3Cdrl6UTx5otXPkVhs3GrM1i1eU+2daUrFEydpYoD1TMy+MZAxGzTSlZWwQsrwKFq/t5rwIxU6y8JG0LStYKDSspV+Fa+NhyrpgpVkl6lpeSVSZgTTmrcC1kbHJWzBSrKZKWhZJVo2GBHBeunYxNjmOmWIHo2UpKVpqA9eE//uaLtTfhc379j39UexPIQNKWUbJyNKw/LfRMw/qjZ+dSshI0rG+1eqZhfdOz+ZRsQwI2lJI907ChSNqVlGwTGjasrXumYcPSsxOULCcBY7JFzzSMiaQdU7I8NIxjuXqmYRzTs31KtoqAcaU1PdMwriRpSclWUjJmOrdnGsZMSpaUbCUl4yxzeqZhnEXJkpKtJ2ac67KeaRjnkrFJ5yV74c6trV9pJWOZ/Z5pGMsUGN9CxLLnkl3ZmCyvkJIBtZQZxNqPWbclWxmY+a+ckgG1FBupGo+Zkp3t+BUVM6C8kmORklXQflqeeOzah/cf1d4KoAkhBoSWY3az9gaM64nHLn4b0f4BDSxz2VnPStdrb0B+7U/IklwBe0IMCC0Prb2VrOV9DRBaswNsbyWLLsRbM2AZJ/hGuipZs+8XAPrQ5jDbT8na3L8AnWlwsO2nZACMqZOSNfgeAaBXrQ25nZQMgGH1ULLW3h3MZBUTkMIOBU0NvDdqb8BaTe3Ncz34OD34ON2+eW3/X4CO7Z/vH95/FPqUf/rJG++9/0ntrUipjzlZdB/efzS9KQv61gyYb3eyO98ziv0QsNATsmM3b1x7+LGDG3rW32newpOFA19d7CxjKaVPHqWbN6590tVBDnymv4ylNq4xehZ+Wx5+/OjmjWvTF7W3BcjGeb2pqFcX+5uQ7UxH/MRxD9ENckbXvcZoxUdz9o/1/XMACGeQjFUXcqDseEK2c9Aw5wDEMuApXHFaFm9ONkLG0hjHPQxikNO54uAcr2TjGOToh745kQsIVrJBJmQ7zgEIbbRTuNYQHek+2WgZ27F+F2IZ/Jwtf8Ms2JwMAA6EKdmwE7I08Ds7iGvk07b8cB2mZIMb+ayAcJywhcW4TzbyhAwgopJ3ywKUTMYAIioWM1cXAYit9TmZCRlAXGWmZU2XTMYAoisQs6ZLlsQMILIyczL3yQCITckAiE3JAIhNyQCITckAiK31tYvJ8kWAmDzjAwBmUTIAYlMyAGILcJ8suVUGEE3Jv+piTgZAbEoGQGxKBkBsMe6TJbfKAOIoeZMsmZMBEJ2SARCbkgEQW5j7ZMmtMoAICt8kS+ZkAESnZADEpmQAxBbpPllyqwygbeVvkiVzMgCiUzIAYlMyAGILdp8suVUG0KoqN8mSORkA0SkZALHFu7qYXGAEaE+tS4vJnAyA6JQMgNiUDIDYQt4nS26VAbSk4k2yZE4GQHRKBkBsSgZAbFHvkyW3ygDaUPcmWTInAyA6JQMgNiUDILbA98mSW2UAtVW/SZbMyQCITskAiE3JAIgt9n2y5FYZQD0t3CRL5mQARKdkAMQW/upicoERoIZGLi2mPko20TOAMtpp2KSfkk30DGA7rTVs0lvJkpgBbKPNjKUuSzbRM4Bcmm3YpNu1i/feeXC920wDFHL9WusZSx3PyXZefPbWJ49qbwRANNevpX//79YbNum/ZCmlF5+9lVLSM4A5pgtaUTKWBilZ+jRmSc8ALre7KRMoY2mckk30DOBCQRs2GatkaS9mSc8A9hqWYmYsDViyiZ4BdNCwyaAlS2IGjK2bjKWRSzbRM2A0PTVsMnrJ0udjlvQM6NfB8yL6yFhSsslBzJKeAX05fuZRNxlLSrZPz4D+9N2wiZJ9znHMkp4BMV347Nn+MpaU7EJ6BoQ2TsMmSnaxC2OW9Axo22V/A6TjjCUlO0HMgFjGzFhSsivpGdC+YRs2UbKrXRazpGdAbSf+pPAgGUtKNp+eAU3RsB0lO8OJmCU9A0o50bA0XsaSkp3rdMySngFbOt2wNGTGkpIt4wNnQEWjfVzsSkq2kIfoA3X190j7xZRslRefvSVjQC3Xr43esImSZfPCnStuoQFkce8d9focJduKsAG5SNdpSlaIsAHzSddZlKwOYQP2SdcaStYKbYNx6FZeStao6mG77EyrvmFwQrPHrXRtSsliyH4erjyvqo8LcKC1Q1q6SlKykK4864qdRZJGXe0c6tJVkZKRgZ5RnnKwo2Rko2eUoWEcUDLykzS2IGBcRsnYip6Ri4ZxmpKxOUljGQFjJiWjED1jPg3jLEpGadsl7Z//4pemL37zz/9nox8xsgK7V8BY5mbtDWA402i16RRN0jLa7cxNaRhrKBl17EYuSWuTgBGIklFZgSlakrTZygQsaRhZuU9GQ9b3bP5ALGn7Su43DSO767U3AD5jjOuel5gtKBltMdJ1zIvLRpSM5tx758Hd527X3gpyuvvcbRljO0pGi773QzHrx93nbn/vhzLGhpSMFn33+x8ti9mf/t3/bbE9TBbs3ilj3/3+R1tsD0yswqdR09h397nbb7x9xiD4xtsfTaPtX/3hk1tt2ZCmvXrWa5FkjFKUjHYti9lEz3JZPM2VMYpxdZGm7WK27H+/bBT2YbIDl+2QNRlLn758sDVzMlr3zW9/+LWvPDGNjCZnxaxsWErpm9/+MN/mwCnmZASwGxPXTM4sBplpzb6SMapQMmJYH7NkZeMMa3aRjFGL5y4Syde+8sT0xenLjFfWbsFVyu6t3GkyRkXmZESy+4Ctz003Zfdy+AQ0VVjxQSTTWrgv/fKt9OnoaXZV1/5bCmvuqcWcjGCmx3/s/tPkrCIZoxFKRjwrY2Yad6EFz+/YfS1j1KVkhHQwbh7ETKuyO9ilBztcxqhLyYjqYI2cy4zFHOxqixWpTskI7Dhmerap4z0sY7RAyYjteCQVs40c71gZoxE+GU0Pdp+YnsNdtMuc9SZAxmiHORk9MKoWZofTFCWjE54uUYxdTWuUjE4cfMiMjfjoGA1SMvphhC3ATqZBSkZX3L/ZlN1Lm5SM3hhtN2LH0iyr8OnT6XX5FuIfO70EX8ZomTkZfdKqjOxMGqdkdOiFO7eS8TeTaTdOuxTapGT0TMxWsgMJQcno3IVjsWczHrhwh8gYUSgZvTm+DuYT0wsc7zQXGGmWktG/D+8/qr0J8dhpBKJkdOWyeYMLZWe5bHeZltEmJWMUYjaTHUU4PhlNP+bMGPaXNhiyJ+fuk3vvuO9IW8zJGIt6nWDnEJSSMRzj9YXsFuJSMjpx1mIEo/aBs3aIdR+0RskY1Btvf+Tz0Smlu8/d1nWis+KDHpgllGfdB+0wJwMgNnMywjMhq8W0jEaYkwEQmzkZsZmQ1WVaRgvMyQCITckAiM3VRQJzabEFLjBSnTkZALGZkxGVCVk7TMuoy5wMgNjMyQjJhKw1pmVUZE4GQGxKBkBsri4Sj0uLbXKBkVrMyQCIzZyMYEzIWmZaRhXmZADEZk5GJCZk7TMtozxzMgBiUzIAYlMyAGJTMgBis+KDMCz3iMKiDwozJwMgNiUDIDYlAyA2JQMgNiUDIDYlAyA2q/CJwRL8WCzEpyRzMgBiUzIAYlMyAGJTMgBiUzIAYlMyAGKzCp8ALMGPyEJ8ijEnAyA2JQMgNiUDIDYlAyA2JQMgNmsXaZ2Fi3FZvkgZ5mQAxKZkAMSmZADEpmQAxKZkAMSmZADEZhU+TbMEPzoL8SnAnAyA2JQMgNiUDIDYlAyA2JQMgNisXaRdFi72wfJFtmZOBkBsSgZAbEoGQGxKBkBsSgZAbEoGQGxW4dMoS/B7YiE+mzInAyA2JQMgNiUDIDYlAyA2JQMgNiUDIDar8GmRJfj9sRCf7ZiTARCbkgEQm5IBEJuSARCbkgEQm7WLNMfCxV5ZvshGzMkAiE3JAIhNyQCITckAiE3JAIhNyQCITckAiE3JAIhNyQCITckAiE3JAIhNyQCITckAiE3JAIjNX3WhLf6kS9/8YRe2YE4GQGxKBkBsSgZAbEoGQGxKBkBsSgZAbEoGQGxKBkBsSgZAbEoGQGxKBkBsSgZAbEoGQGxKBkBs/qoLDfEnXUbgD7uQnTkZALEpGQCxKRkAsSkZALEpGQCxKRkAsSkZALEpGQCxKRkAsSkZALEpGQCxKRkAsXmCMG3xEOG+eXwwW1AymiNmvZIxNuLqIgCxmZPRItOy/piQsR0lo1Fi1hMZY1OuLgIQmzkZ7TIt64MJGVtTMpomZtHJGAUoGa0Ts7hkjDLcJwMgNnMyAjAti8iEjGKUjGBUrWXqRRVKRmCq1gL1ojolox/CVoZ00Rolo1vClot00TglYxTCNp90EYuSMShh2yddhKZkkNJ4YZMueqJkcEr0wikWI1AyWKidyMkVg1MyyGy7wikWXEjJoJw5kZMrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgIj+H+0pSGbzhhUAAAAAAElFTkSuQmCC" width="579" height="470" style="width:400px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="514-gl_multisample-的作用">5.14 GL_MULTISAMPLE 的作用<a href="#514-gl_multisample-的作用" class="hash-link" aria-label="5.14 GL_MULTISAMPLE 的作用的直接链接" title="5.14 GL_MULTISAMPLE 的作用的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="##w600##" src="/HXLoLi/assets/images/HX_2025-08-04_11-15-25-c21ca5e1c4cca64812b1b9cf2acdad08.png" width="1641" height="951" style="width:600px;border-radius:10px"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="515-glenable-系列函数">5.15 glEnable 系列函数<a href="#515-glenable-系列函数" class="hash-link" aria-label="5.15 glEnable 系列函数的直接链接" title="5.15 glEnable 系列函数的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLenum cap</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glDisable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLenum cap</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">GLboolean </span><span class="token function" style="color:hsl(207, 82%, 66%)">glIsEnabled</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLenum cap</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>用法举例:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">glDisable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 暂时关闭深度测试</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">assert</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">glIsEnabled</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 绘制游戏 HUD 界面, 不参与深度测试 (比如物品栏/血量条)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 重新恢复深度测试</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">assert</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glIsEnabled</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="516-对古代opengl中是mvp部分进行优化">5.16 对古代OpenGL中是MVP部分进行优化<a href="#516-对古代opengl中是mvp部分进行优化" class="hash-link" aria-label="5.16 对古代OpenGL中是MVP部分进行优化的直接链接" title="5.16 对古代OpenGL中是MVP部分进行优化的直接链接">​</a></h3>
<p>注意到, 我们之前的代码:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">show</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glBegin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> obj </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ObjParser res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">parser</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;./obj/monkey.obj&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">40.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">w </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.01f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">100.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 视角</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">5</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">lookAt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> vertices </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getVertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> uvs </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getUvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> normals </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getNormals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getFaces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> v_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             v_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             v_z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vt_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> uvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             vt_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> uvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             vt_z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> uvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vn_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             vn_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             vn_z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glNormal3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">transpose</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">inverse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat3x3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> vn_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glTexCoord2fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vt_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glTexCoord2fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vt_y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v_y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glTexCoord2fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vt_z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective_divide</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v_z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>view * model</code>被重复计算太多次了, 并且 VM 总是出现在一起.</p>
<p>所以我们其实不必提供单独的 view 和 model 矩阵, 可以把他们两个提前乘起来。</p>
<ul>
<li>
<p>提供 <code>MODELVIEW</code> 矩阵 - <code>view * model</code></p>
</li>
<li>
<p>提供 <code>PROJECTION</code> 矩阵 - <code>projection</code></p>
</li>
<li>
<p>对于法线矢量, 会应用 <code>MODELVIEW</code> 的 3x3 部分的逆转置。</p>
</li>
<li>
<p>对于位置坐标, 会应用 <code>MODELVIEW</code> 然后 PROJECTION, 然后做 Perspective Divide。</p>
</li>
</ul>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><span class="octicon octicon-tip" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-light-bulb mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Tip</p>
<p>为什么名为 modelview, 实际乘法顺序却是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>i</mi><mi>e</mi><mi>w</mi><mo>×</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">view \times model</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span></span></span></span>?</p>
<p>和上一期的 SRT 一样, model、view、projection 也是一个固定的应用顺序, 简称 MVP。</p>
<p>但是由于 OpenGL 用的是列矢量。矢量元素纵向排列, 矢量需要在矩阵的右边做乘法。</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>×</mo><mi>v</mi><mi>i</mi><mi>e</mi><mi>w</mi><mo>×</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>×</mo><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">projection \times view \times model \times pos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">ro</span><span class="mord mathnormal" style="margin-right:0.05724em">j</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">os</span></span></span></span></span>
<p>就导致虽然我想要的应用顺序是 MVP, 但我却需要从右往左写, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>×</mo><mi>V</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">P \times V \times M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span>。</p>
<p>所以 MV 部分自然就是需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">V \times M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span> 这个相反的顺序了。</p>
<blockquote>
<p>相反地, DirectX 用的是行矢量。矢量元素横向排列, 矢量需要在矩阵的左边做乘法, 那么 DirectX 的用户就要以正顺序写 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>V</mi><mo>×</mo><mi>P</mi></mrow><annotation encoding="application/x-tex">M \times V \times P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span>。</p>
</blockquote>
</div>
<p>优化后:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">show</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> obj </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ObjParser res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">parser</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;./obj/monkey.obj&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 构造矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">40.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">w </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.01f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">100.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">5</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">lookAt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> center</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 viewModel </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// ModelView</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 加载投影矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glMatrixMode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_PROJECTION</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glLoadMatrixf</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 其后续计算不需要写 perspective</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                                                </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// OpenGL内部会自动补上这个计算</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                                                </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// ps: glm 矩阵内部的存储方式就是列主序, 和 glLoadMatrixf 所要求的相同</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 加载模型视图矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glMatrixMode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_MODELVIEW</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glLoadMatrixf</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">viewModel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 法线变换矩阵(只需算一次)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat3 normalMatrix </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">transpose</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">inverse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">viewModel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 开始绘制</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glBegin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> vertices </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getVertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> uvs </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getUvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> normals </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getNormals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getFaces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> v_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> v_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> v_z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vt_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> uvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vt_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> uvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vt_z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> uvs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vn_x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vn_y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> vn_z </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第一个顶点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glNormal3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">normalMatrix </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> vn_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glTexCoord2fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vt_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v_x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第二个顶点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// glNormal3fv(glm::value_ptr(normalMatrix * vn_y));</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glTexCoord2fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vt_y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v_y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第三个顶点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// glNormal3fv(glm::value_ptr(normalMatrix * vn_z));</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glTexCoord2fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">vt_z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v_z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="517-手动计算法线">5.17 手动计算法线<a href="#517-手动计算法线" class="hash-link" aria-label="5.17 手动计算法线的直接链接" title="5.17 手动计算法线的直接链接">​</a></h3>
<p>小问题: 如果 OBJ 模型没有提供法线信息怎么办?</p>
<p>没有法线就无法实现光照和立体效果; 我们可以手动计算法线: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>A</mi><mi>B</mi><msub><mi>C</mi><mtext>平面</mtext></msub></mrow></msub><mo>=</mo><mover accent="true"><mrow><mi>A</mi><mi>B</mi></mrow><mo>⃗</mo></mover><mo>×</mo><mover accent="true"><mrow><mi>A</mi><mi>C</mi></mrow><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">n_{ABC_{平面}} = \vec{AB} \times \vec{AC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6809em;vertical-align:-0.2503em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.0715em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">平面</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.0833em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2355em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.9663em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2355em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span></p>
<!-- -->
<!-- -->
<p>你可能注意到, 为什么有时候显示全是灰色的呢? (尝试给法线加上负号. 然后运行观察)</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="518-法线方向的问题-我们有必要人为规定面的正方向">5.18 法线方向的问题: 我们有必要人为规定面的&quot;正方向&quot;<a href="#518-法线方向的问题-我们有必要人为规定面的正方向" class="hash-link" aria-label="5.18 法线方向的问题: 我们有必要人为规定面的&quot;正方向&quot;的直接链接" title="5.18 法线方向的问题: 我们有必要人为规定面的&quot;正方向&quot;的直接链接">​</a></h3>
<p>之前在法线的定义那里我们说过, 同一个平面, 可能有两个法线! 为了去除这种模棱两可, 对于一个三角形, 我们必须规定哪一面是朝外的哪一面是朝里的!</p>
<p>回顾刚刚的三角形法线计算公式: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mi>B</mi><mo>×</mo><mi>A</mi><mi>C</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">n = ||AB×AC||</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mord">∣∣</span></span></span></span></p>
<p>观察下方这两个三角形, 他们其实是完全一样的, 只是顶点的顺序有所不同。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    A             A</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">   </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> \           </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  B </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> C         C </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> B</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是, 按照我们的法线计算公式, 就会发现这两个仅仅只是顶点顺序发生变化的三角形, 法线居然是相反的!</p>
<p>为了光照的计算结果正确, 我们要求法线必须是朝向摄像头一面的。如果法线背对着我们, 算出来的颜色就会变成一片漆黑! 如果一个物体的表面都像下面蓝色的那个三角形, 法线算出来是背对着摄像头的, 那么物体就一片漆黑, 没有符合光学规律的立体感了。</p>
<p><strong>规定: 逆时针方向为面的正方向</strong></p>
<blockquote>
<p>因此一个三角形, 只有一面是能够看的, 另一面的光照计算会是完全错误的。你可能在想, 有没有一种办法, 例如在着色器里自动检测法线是否反了, 让他自动翻转, 这样一个三角形的两面都能正常渲染, 不会漆黑?</p>
<p>不过我们第一课就说过了, 图形学是画皮的艺术, 所谓的三维模型只有一张皮! 这张皮的内外是很明确的, 不可能有人站在这个猴子的内部从内往外看(否则就叫穿模)。</p>
<p>所以不妨在建模的时候, 就始终保证三角形&quot;能看的&quot;那一面朝外, 称之为三角形面的&quot;正方向&quot;。一个封闭内部的&quot;实心&quot;模型, 他朝外的部分是很明确的, 建模工具中创建的物体都会满足这个规范, 导出为 OBJ 时, 其 f 命令后跟的顶点顺序, 也是保证&quot;正方向&quot;朝外的。</p>
<p>总之, 图形学界都不约而同达成了一个约定:</p>
<p>&quot;在摄像头方向看去, 三个顶点顺序呈逆时针方向排布的, 为面的正方向。所有三维软件都应该保证模型朝外的面是逆时针顶点顺序, 否则可能导致打开模型后颜色不正常。&quot;</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="519-面剔除功能-gl_cull_face">5.19 面剔除功能: GL_CULL_FACE<a href="#519-面剔除功能-gl_cull_face" class="hash-link" aria-label="5.19 面剔除功能: GL_CULL_FACE的直接链接" title="5.19 面剔除功能: GL_CULL_FACE的直接链接">​</a></h3>
<p>既然逆时针(Counter-clockwise)面为正面, 那么顺时针(Clockwise)就是背面, 反正法线和光照模型永远算不对, 破罐子破摔, 又深居在模型内部, 永远不需要出头露面了。</p>
<p>尽管只有逆时针的面, 光照计算是正确的, 但绘制时 OpenGL 却不管不顾, 都会一股脑给你绘制上。这给深度测试带来了不必要的负担: 同一个物体的正面和背面都会被绘制, 背面由于深度值(Z)更高, 又一定会被深度测试剔除。哎, 可恶的顺时针面, 明明永远在模型内部摸鱼, 永远不会被绘制出来, 却白白占用了我们宝贵的深度测试算力。</p>
<p>有没有一种办法, 能让 OpenGL 自动忽视所有在当前摄像机方向看起来是顺时针的面来节省性能? 这就需要启用 GL_CULL_FACE 这个称为面剔除的特性。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">// 开启面剔除</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_CULL_FACE</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glCullFace</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_BACK</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glFrontFace</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_CCW</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><span class="octicon octicon-tip" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-light-bulb mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Tip</p>
<p>注意: 剔除的条件只看顶点的顺逆时针, 和法线无关, 法线是你自己计算的</p>
</div>
<p>要注意, <code>GL_CULL_FACE</code> 的作用是剔除&quot;三个顶点顺序为顺时针&quot;的面, 而和法线无关, 如果你加载了某个无良模型师傅做的&quot;顺时针为正面&quot;的模型, 那么你在我们刚刚的函数 <code>compute_normal</code> 里加个负号并无济于事! 要把&quot;顺时针模型&quot;转换成图形学界通用的&quot;逆时针模型&quot;, 你需要做的只是把面数组中 B 和 C 顶点的&quot;索引&quot;翻一下:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">// 在 load_obj 中, 如果你加载的是约定&quot;顺时针为正面&quot;的模型, 就需要翻转 b 和 c 变量</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">isFackingClockwiseAuthor</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">uvec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">  </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 无良模型师傅</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">uvec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">  </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 正常模型师傅</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>另外, 如果你的圈子都是喜欢顺时针的无良模型师傅, 那么也可以 <code>glFrontFace(GL_CW)</code>, 告诉 OpenGL 顺时针才是你想保留的正面, 默认状态是 <code>GL_CCW</code>, 逆时针为正面。</p>
<p><img decoding="async" loading="lazy" src="/HXLoLi/assets/images/HX_2025-08-04_14-23-29-bd6a0abde5912f81adf3120453c1d611.png" width="2026" height="1086" style="border-radius:10px"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="六法线进阶之平滑渲染">六、法线进阶之平滑渲染<a href="#六法线进阶之平滑渲染" class="hash-link" aria-label="六、法线进阶之平滑渲染的直接链接" title="六、法线进阶之平滑渲染的直接链接">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="61-古代-opengl-启用平滑渲染模式">6.1 古代 OpenGL 启用平滑渲染模式<a href="#61-古代-opengl-启用平滑渲染模式" class="hash-link" aria-label="6.1 古代 OpenGL 启用平滑渲染模式的直接链接" title="6.1 古代 OpenGL 启用平滑渲染模式的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">glShadeModel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_SMOOTH</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 切换到平滑渲染模式</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">glShadeModel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_FLAT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">   </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 切换到平直渲染模式</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>默认状态为平直模式 <code>GL_FLAT</code>。</p>
<p>绘制三角形时:</p>
<ul>
<li>若为 <code>GL_SMOOTH</code> <code>模式, glNormal3f</code> 可以指定三次, 每个顶点都可以有独立的顶点法线。</li>
<li>若为 <code>GL_FLAT</code> <code>模式, glNormal3f</code> 每个三角形只能指定一次, 含义为面法线。</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="62-平直渲染gl_flatvs-平滑渲染gl_smooth">6.2 平直渲染(GL_FLAT)vs 平滑渲染(GL_SMOOTH)<a href="#62-平直渲染gl_flatvs-平滑渲染gl_smooth" class="hash-link" aria-label="6.2 平直渲染(GL_FLAT)vs 平滑渲染(GL_SMOOTH)的直接链接" title="6.2 平直渲染(GL_FLAT)vs 平滑渲染(GL_SMOOTH)的直接链接">​</a></h3>
<p><img decoding="async" loading="lazy" alt="##w500##" src="/HXLoLi/assets/images/HX_2025-08-04_15-32-11-aaa11ea793e91f00e1ece25ad5d91ecc.png" width="789" height="368" style="width:500px;border-radius:10px"></p>
<p>左边是平直, 右边是平滑.</p>
<!-- -->
<!-- -->
<p>桥豆麻袋! 这个亮度是不是不对?</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="63-mv-矩阵含有缩放时-需要开启-gl_normalize">6.3 MV 矩阵含有缩放时, 需要开启 GL_NORMALIZE<a href="#63-mv-矩阵含有缩放时-需要开启-gl_normalize" class="hash-link" aria-label="6.3 MV 矩阵含有缩放时, 需要开启 GL_NORMALIZE的直接链接" title="6.3 MV 矩阵含有缩放时, 需要开启 GL_NORMALIZE的直接链接">​</a></h3>
<p>因为 OpenGL 会傻乎乎的给模型的法线乘以 MV 矩阵的逆转置, 但是乘了以后忘记归一化!</p>
<p>我们刚刚的 Model 矩阵部分有缩小至 0.7 倍, 因此 Model 的逆转置是放大至 1.42 倍。</p>
<p>这导致我们的法线被傻乎乎的 OpenGL 乘以逆转置后长度由正常的 1 变成 1.42 了!</p>
<p>从而计算光照时, 由于光照计算公式中有 dot(N, -I) 项, 这个公式算出来亮度正确的前提是 N 必须是已经归一化的, 然而我们恰恰不是归一化的, 所以变成 dot(1.42 N, -I) 导致算出来亮度高了 1.42 倍!</p>
<p>因此我们可以开启 <code>GL_NORMALIZE</code>(古代特供)这个开关, 让 OpenGL 对乘以了 MV 逆转置后的法线进行一个归一化操作, 保证进入固定管线的 N 总是归一化的。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_NORMALIZE</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这样, 成功在同一个窗口中正确显示两个不同上色模式的猴子头~</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="七glfw-鼠标事件回调实现相机角度控制">七、GLFW 鼠标事件回调实现相机角度控制<a href="#七glfw-鼠标事件回调实现相机角度控制" class="hash-link" aria-label="七、GLFW 鼠标事件回调实现相机角度控制的直接链接" title="七、GLFW 鼠标事件回调实现相机角度控制的直接链接">​</a></h2>
<p><del>回调函数大家都知道是什么东西, 这里就不介绍了</del></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="71-设置鼠标点击回调函数">7.1 设置鼠标点击回调函数<a href="#71-设置鼠标点击回调函数" class="hash-link" aria-label="7.1 设置鼠标点击回调函数的直接链接" title="7.1 设置鼠标点击回调函数的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">mouse_button_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> button</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> mods</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后在主函数里使用 <code>glfwSetMouseButtonCallback</code> 注册这个回调函数:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSetMouseButtonCallback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> mouse_button_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以后每当用户在窗口 window 中点击了鼠标, GLFW 就会自动帮你调用你注册的这个 <code>mouse_button_callback</code> 函数, 并且往他的参数中传递了一些关于鼠标的信息:</p>
<ul>
<li><code>button</code> 用户按下了鼠标上哪一个键, 例如 <code>GLFW_MOUSE_BUTTON_LEFT</code> 表示鼠标左键。</li>
<li><code>action</code> 会告诉你鼠标这个按键是被按下(<code>GLFW_PRESS</code>)还是抬起(<code>GLFW_RELEASE</code>)。</li>
<li><code>mods</code> 点击时的键盘&quot;修饰符&quot;, 例如 Ctrl、Shift、Alt 等, 可以实现 Ctrl+鼠标点击。</li>
<li><code>window</code> 告诉你事件发生在哪个窗口上, 反正我们只有一个主窗口所以不用考虑。</li>
</ul>
<p>本期所有用到的函数:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">/**</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @brief 鼠标移动回调</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param window GLFW 窗口指针</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param xpos 鼠标当前的 X 坐标</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param ypos 鼠标当前的 Y 坐标</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">cursor_pos_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> xpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">/**</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @brief 鼠标按键回调</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param window GLFW 窗口指针</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param button 鼠标按键(如 GLFW_MOUSE_BUTTON_LEFT)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param action 按键动作(GLFW_PRESS 或 GLFW_RELEASE)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param mods   修饰键(如 GLFW_MOD_SHIFT)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">mouse_button_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> button</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> mods</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">/**</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @brief 鼠标滚轮回调</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param window GLFW 窗口指针</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param xoffset 滚轮水平方向偏移</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param yoffset 滚轮垂直方向偏移</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">scroll_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> xoffset</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> yoffset</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">/**</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @brief 键盘按键回调</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param window GLFW 窗口指针</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param key 按键代码(如 GLFW_KEY_A)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param scancode 系统扫描码</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param action 按键动作(GLFW_PRESS 或 GLFW_RELEASE)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param mods   修饰键(如 GLFW_MOD_CONTROL)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">key_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> key</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> scancode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> mods</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">/**</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @brief 窗口大小改变回调</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param window GLFW 窗口指针</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param width 新窗口宽度</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> * @param height 新窗口高度</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"> */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">framebuffer_size_callback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="72-glfw-是在什么地方调用回调">7.2 GLFW 是在什么地方调用回调?<a href="#72-glfw-是在什么地方调用回调" class="hash-link" aria-label="7.2 GLFW 是在什么地方调用回调?的直接链接" title="7.2 GLFW 是在什么地方调用回调?的直接链接">​</a></h3>
<div class="markdown-alert markdown-alert-tip">
<p class="markdown-alert-title"><span class="octicon octicon-tip" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-light-bulb mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Tip</p>
<p>有些同学可能担心&quot;回调函数&quot;会不会是在另一个线程里异步的调用的, 那在回调函数里修改相机参数岂不是很危险?</p>
<p>不会! GLFW 保证回调函数总是在主线程, 并且不会在 <code>render</code> 进行到一半的时候调用</p>
</div>
<p>所有你设置的 <code>Callback</code> 函数都是在这个 <code>glfwPollEvents</code> 里面被调用的! 所以都是在主线程调用的, 没有任何问题</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:hsl(286, 60%, 67%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwWindowShouldClose</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glClear</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_COLOR_BUFFER_BIT </span><span class="token operator" style="color:hsl(207, 82%, 66%)">|</span><span class="token plain"> GL_DEPTH_BUFFER_BIT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 清空画布</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">show</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name boolean" style="color:hsl(29, 54%, 61%)">true</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">show</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name boolean" style="color:hsl(29, 54%, 61%)">false</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSwapBuffers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 双缓冲</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwPollEvents</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// &lt;-- 轮询事件中, 调用回调</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="73-介绍摄像头控制的五种模式">7.3 介绍摄像头控制的五种模式<a href="#73-介绍摄像头控制的五种模式" class="hash-link" aria-label="7.3 介绍摄像头控制的五种模式的直接链接" title="7.3 介绍摄像头控制的五种模式的直接链接">​</a></h3>
<ol>
<li>orbit(环绕模式)</li>
<li>drift(转头模式)</li>
<li>pan(平移模式)</li>
<li>zoom(缩放模式)</li>
<li>hitchcock(变焦模式)</li>
</ol>
<div class="markdown-alert markdown-alert-note">
<p class="markdown-alert-title"><span class="octicon octicon-note" style="--oct-icon:url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; class=&#x27;octicon octicon-info mr-2&#x27; viewBox=&#x27;0 0 16 16&#x27; version=&#x27;1.1&#x27; width=&#x27;16&#x27; height=&#x27;16&#x27; aria-hidden=&#x27;true&#x27;%3E%3Cpath d=&#x27;M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z&#x27;%3E%3C/path%3E%3C/svg%3E&quot;)"></span>Note</p>
<p>这些都是摄像机的变换, 物体的全局坐标是 <strong>不变</strong> 的!</p>
</div>
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<!-- -->
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="八回家作业">八、回家作业<a href="#八回家作业" class="hash-link" aria-label="八、回家作业的直接链接" title="八、回家作业的直接链接">​</a></h2>
<p><img decoding="async" loading="lazy" alt="hw" src="/HXLoLi/assets/images/HX_2025-08-05_11-33-37-19b30f66fb14441597834c1eb5d38180.png" width="2146" height="1099" style="border-radius:10px"></p>
<p>代码:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux" style="border-top-left-radius:0px;border-top-right-radius:0px"><pre tabindex="0" class="prism-code language-cpp codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187 codeBlockLinesWithNumbering_OFgW"><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;check/OpenGL.hpp&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;glm/vec3.hpp&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;glm/gtc/type_ptr.hpp&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;fstream&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;stdexcept&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;vector&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token macro property directive-hash" style="color:hsl(355, 65%, 65%)">#</span><span class="token macro property directive keyword" style="color:hsl(286, 60%, 67%)">include</span><span class="token macro property" style="color:hsl(355, 65%, 65%)"> </span><span class="token macro property string" style="color:hsl(95, 38%, 62%)">&lt;HXTest.hpp&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> __init__ </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">setlocale</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">LC_ALL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;zh_CN.UTF-8&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> cwd </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">filesystem</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">current_path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">debug</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;当前工作路径是:&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> cwd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">filesystem</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">current_path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;../../../src/08-OpenGL&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">debug</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;切换到路径:&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">filesystem</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">current_path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">filesystem</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">filesystem_error</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">error</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;Error:&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">what</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">namespace</span><span class="token plain"> HX </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 摄像机类</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">CameraState</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">5</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 相机坐标</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">     </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 相机看向的目标点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 upVector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">   </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 上方向 (相机本地坐标系的y正方向(相机屏幕的上方向))</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 keepUpAxis </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> focalLen </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">40.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> filmHeight </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">24.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> filmWidth </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">32.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1920</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1080</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 环绕模式: 环绕着目标物体旋转, 所以 orbit 的旋转枢轴是 lookat;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">orbit</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 获取鼠标的水平和竖直分量</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> angle_X_inc </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> angle_Y_inc </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 旋转原点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> rotation_pivot </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 环绕着目标物体</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 指向目标点的单位方向向量</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> front_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 右向量 (指向目标点的单位方向向量 和 上方向 的叉积)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> right_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 新的上方向是 右向量 和 指向目标点的单位方向向量 的叉积</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        upVector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">/*</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">        front_vector(指向目标点方向向量) 和 upVector(相机本地坐标系的y正方向向量) 是共面的</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">        对其叉积, 得到 右向量</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">        然后 右向量 再和 front_vector(指向目标点方向向量) 叉积</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">        得到新的 upVector(相机本地坐标系的y正方向向量)</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">        此时 front_vector(x)、upVector(y)、右向量(z) 互相垂直, 形成空间直角坐标系</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token comment" style="color:hsl(220, 10%, 40%)">*/</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第一次旋转: 鼠标左右 对应是 照相机本地坐标系 以 y 轴 &quot;旋转&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 rotation_matrixX </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">angle_X_inc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第二次旋转: 鼠标上下 对应是 照相机本地坐标系 以 z 轴 &quot;旋转&quot; (俯仰)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 rotation_matrixY </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> angle_Y_inc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 先平移到 rotation_pivot 为中心的坐标系, 绕中心旋转, 然后平移回来(经典 T R T^{-1})</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> transformation</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> rotation_pivot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> rotation_matrixY </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> rotation_matrixX</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">rotation_pivot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 更新眼睛和物体的位置坐标(其实只需要更新眼睛就行, lookat 作为枢轴是不会变的)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">transformation </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">transformation </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 计算出新的上矢量和最初的上矢量偏移了多少(通过点积求重合程度)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> right_o_up </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">dot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> keepUpAxis</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// &quot;右&quot;点积&quot;旧上&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> right_handness </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">dot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">keepUpAxis</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// &quot;右&quot;和&quot;旧上&quot;点积的 acos 是&quot;右&quot;和&quot;旧上&quot;的夹角, asin 是&quot;新上&quot;和&quot;旧上&quot;的夹角</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> angle_Z_err </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">asin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_o_up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 如果摄像头整个都已经颠倒了, 那么修正也往颠倒的下方向去修正而不是试图180度大转弯</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        angle_Z_err </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">atan</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_handness</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 把上矢量(up)绕着前矢量(front)旋转误差的度数, 就可以一直保持摄像头朝上, 不歪脖子</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 rotation_matrixZ </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> angle_Z_err</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        upVector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat3x3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">rotation_matrixZ</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// drift(转头模式): 摄像头自身在旋转, 所以 drift 的旋转枢轴是 eye</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">drift</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 而且由于鼠标右移是用户要把物体向右移动, 需要反方向向左旋转摄像头, 所以 delta 要翻转方向(乘以 -1)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        delta </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">1.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        delta </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">atan</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">filmHeight </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> focalLen</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 获取鼠标的水平和竖直分量</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> angle_X_inc </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> angle_Y_inc </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 旋转原点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> rotation_pivot </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 环绕着摄像机</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 指向目标点的单位方向向量</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> front_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 右向量 (指向目标点的单位方向向量 和 上方向 的叉积)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> right_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 新的上方向是 右向量 和 指向目标点的单位方向向量 的叉积</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        upVector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第一次旋转: 基于鼠标横轴</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 rotation_matrixX </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">angle_X_inc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 第二次旋转: 基于鼠标纵轴</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 rotation_matrixY </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> angle_Y_inc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 先平移到 rotation_pivot 为中心的坐标系, 绕中心旋转, 然后平移回来(经典 T R T^{-1})</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> transformation </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> rotation_pivot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> rotation_matrixY </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> rotation_matrixX</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">rotation_pivot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 更新眼睛和物体的位置坐标(其实只需要更新眼睛就行, lookat 作为枢轴是不会变的)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">transformation </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">transformation </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 计算出新的上矢量和最初的上矢量偏移了多少(通过点积求重合程度)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> right_o_up </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">dot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> keepUpAxis</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// &quot;右&quot;点积&quot;旧上&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> right_handness </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">dot</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">keepUpAxis</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// &quot;右&quot;和&quot;旧上&quot;点积的 acos 是&quot;右&quot;和&quot;旧上&quot;的夹角, asin 是&quot;新上&quot;和&quot;旧上&quot;的夹角</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> angle_Z_err </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">asin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_o_up</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 如果摄像头整个都已经颠倒了, 那么修正也往颠倒的下方向去修正而不是试图180度大转弯</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        angle_Z_err </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">atan</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_handness</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 把上矢量(up)绕着前矢量(front)旋转误差的度数, 就可以一直保持摄像头朝上, 不歪脖子</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 rotation_matrixZ </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> angle_Z_err</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        upVector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">mat3x3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">rotation_matrixZ</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// pan(平移模式)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">pan</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        delta </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">2.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 从摄像头到目标的方向向量 (屏幕正方向)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> front_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> right_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> upVector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> fixed_up_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">right_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> front_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> delta3d </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> right_vector </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> fixed_up_vector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> delta3d</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        lookat </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> delta3d</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// zoom(缩放模式)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">zoom</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> inv_zoom_factor </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">exp</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.2f</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> inv_zoom_factor </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// hitchcock(变焦模式)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">hitchcock</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> inv_zoom_factor </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">exp</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.2f</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">eye </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> inv_zoom_factor </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        focalLen </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> inv_zoom_factor</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 相机 视角矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 </span><span class="token function" style="color:hsl(207, 82%, 66%)">view_matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">lookAt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            eye</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain">            </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 相机坐标点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            lookat</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 相机&quot;看向&quot;的目标点(视线穿过的点)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            upVector    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// &quot;上&quot;方向的参考向量, 用来确定相机的旋转朝向(通常是世界坐标里的近似全局向上, 比如 (0,1,0) )</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 投影矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 </span><span class="token function" style="color:hsl(207, 82%, 66%)">projection_matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> fov </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">atan</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">filmHeight </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> focalLen</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> aspect </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">width </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain">height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">fov</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> aspect</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.01f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">100.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 按键状态</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">MouseState</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">bool</span><span class="token plain"> leftClickPress </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">false</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">bool</span><span class="token plain"> rightClickPress </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">false</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 获取鼠标当前位置</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 </span><span class="token function" style="color:hsl(207, 82%, 66%)">get_cursor_pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> xpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetCursorPos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">xpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> xpos </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">vec2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">struct</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">ObjParser</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">parser</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">string_view path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">ifstream file</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">data</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">size</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token plain">file</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">is_open</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">unlikely</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">error</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;打开文件:&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;失败!&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">throw</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">runtime_error</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">data</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">string line</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">getline</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">file</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> line</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> head </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> line</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">substr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">head </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;v &quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 解析顶点</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">istringstream s</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">line</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">substr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                s </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;&gt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;&gt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;&gt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                _vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">move</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">head </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;f &quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 解析面</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">istringstream s</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">line</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">substr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">size_t</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> idx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">getline</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> head</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token char" style="color:hsl(95, 38%, 62%)">&#x27; &#x27;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                    std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">size_t i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                    std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">istringstream</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">head</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;&gt;</span><span class="token plain"> i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                    idx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">size_t i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> idx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">size</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                    _trinales</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">idx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> idx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> idx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        file</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">close</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">info</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;加载:&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;完成!&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">getVertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">noexcept</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> _vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">getFaces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">noexcept</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> _trinales</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">private</span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> _vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">uvec3</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> _trinales</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// namespace HX</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">CameraState camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">MouseState mouse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 lastpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 当前鼠标位置</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 手动计算法线</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 </span><span class="token function" style="color:hsl(207, 82%, 66%)">compute_normal</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">noexcept</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> ab </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> b </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> ac </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> c </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">ac</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> ab</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 手动计算法线 asin 系数</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 </span><span class="token function" style="color:hsl(207, 82%, 66%)">compute_normal_biased</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3 c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">noexcept</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> ab </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> b </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> ac </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> c </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> n </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">cross</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">ac</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> ab</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> nLen </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">length</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">nLen </span><span class="token operator" style="color:hsl(207, 82%, 66%)">!=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        n </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">asin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">nLen </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">length</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">ab</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">length</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">ac</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> nLen</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> n</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">template</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">bool</span><span class="token plain"> IsSmooth </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(29, 54%, 61%)">false</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 是否为平滑模式</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">void</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">show</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> obj </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ObjParser res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">parser</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;./obj/opencvpart.obj&quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">w</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">h</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 perspective </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">projection_matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> vertices </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getVertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">static</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> normals </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vector</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">constexpr</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">IsSmooth</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> faces </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getFaces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">resize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">size</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> faces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> a </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                     b </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                     c </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                HX_NO_WARNINGS_BEGIN</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">size_t i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                    res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">compute_normal_biased</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                HX_NO_WARNINGS_END</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> it </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                it </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">normalize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">it</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getFaces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> a </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                     b </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                     c </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">push_back</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">compute_normal</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 视角</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">view_matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 viewModel </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> view </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// ModelView</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 加载投影矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glMatrixMode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_PROJECTION</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glLoadMatrixf</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">perspective</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 加载模型视图矩阵</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glMatrixMode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_MODELVIEW</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glLoadMatrixf</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">viewModel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glBegin</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_TRIANGLES</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">size_t i </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">const</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain"> v </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> obj</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">getFaces</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> a </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             b </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             c </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> vertices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">z</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">constexpr</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">IsSmooth</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glNormal3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glNormal3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glNormal3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glNormal3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">normals</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token function" style="color:hsl(207, 82%, 66%)">glVertex3fv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">value_ptr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token operator" style="color:hsl(207, 82%, 66%)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnd</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">main</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">initOpenGL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    log</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">hxLog</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">debug</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">&quot;OpenGL version: &quot;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glGetString</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_VERSION</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_POINT_SMOOTH</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glPointSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">64.0f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_DEPTH_TEST</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">       </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 深度测试, 防止前后物体不分</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_MULTISAMPLE</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">      </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 多重采样抗锯齿 (MSAA)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_BLEND</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">            </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用 Alpha 通道 (透明度)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glBlendFunc</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_SRC_ALPHA</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GL_ONE_MINUS_SRC_ALPHA</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 标准 Alpha 混合: src*alpha + dst*(1-alpha)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_LIGHTING</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">         </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用固定管线光照 (古代特性)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_LIGHT0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">           </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用 0 号光源 (古代特性)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_COLOR_MATERIAL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">   </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 启用材质颜色追踪 (古代特性)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glEnable</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_NORMALIZE</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 法线归一化</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 绑定鼠标移动回调</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSetCursorPosCallback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> xpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> ypos</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 获取窗口大小</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetWindowSize</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain">  </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">width</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;</span><span class="token plain">height</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 映射到 [-1, 1], 除以对应的宽、高, 以保证宽高比</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> x </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">static_cast</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> xpos </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 注意因为窗口坐标是左上原点, y 正轴向下, 所以 转换需要 height - ypos</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> y </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">static_cast</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> ypos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">/</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 pos </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// @todo 设置光源</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 计算变化量: 是本次鼠标移动和上一次移动的变化量, 而不是和按下鼠标那一刻相比!</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">auto</span><span class="token plain"> delta </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">fract</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">pos </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> lastpos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.5f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2.f</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 按键状态</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">mouse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">rightClickPress</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">drift</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">mouse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">leftClickPress</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetKey</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GLFW_KEY_LEFT_SHIFT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS </span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">             </span><span class="token operator" style="color:hsl(207, 82%, 66%)">||</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetKey</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GLFW_KEY_RIGHT_SHIFT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">pan</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">                camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">orbit</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        lastpos </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> pos</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 绑定鼠标点击事件</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSetMouseButtonCallback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> btn</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">int</span><span class="token plain"> mods</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">btn</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">case</span><span class="token plain"> GLFW_MOUSE_BUTTON_LEFT</span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            mouse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">leftClickPress </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> action </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">break</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">case</span><span class="token plain"> GLFW_MOUSE_BUTTON_RIGHT</span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            mouse</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">rightClickPress </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> action </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">break</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">default</span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">break</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 绑定鼠标滚轮事件</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSetScrollCallback</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">maybe_unused</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> GLFWwindow</span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> xoffset</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">double</span><span class="token plain"> yoffset</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> deltax </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> xoffset </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">?</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> xoffset </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">?</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> deltay </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> yoffset </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">?</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> yoffset </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">?</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec2 </span><span class="token function" style="color:hsl(207, 82%, 66%)">delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">deltax</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> deltay</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetKey</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GLFW_KEY_LEFT_SHIFT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS </span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">         </span><span class="token operator" style="color:hsl(207, 82%, 66%)">||</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwGetKey</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> GLFW_KEY_RIGHT_SHIFT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> GLFW_PRESS</span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">hitchcock</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            camera</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token function" style="color:hsl(207, 82%, 66%)">zoom</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">delta</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">using</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">namespace</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">chrono</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> k </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.618f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> xDown </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> k </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">sqrt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">3.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">float</span><span class="token plain"> hOpencv </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> k </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">while</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token operator" style="color:hsl(207, 82%, 66%)">!</span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwWindowShouldClose</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">CHECK_GL</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token function" style="color:hsl(207, 82%, 66%)">glClear</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">GL_COLOR_BUFFER_BIT </span><span class="token operator" style="color:hsl(207, 82%, 66%)">|</span><span class="token plain"> GL_DEPTH_BUFFER_BIT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 清空画布</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glColor3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4 model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">hOpencv </span><span class="token operator" style="color:hsl(207, 82%, 66%)">*</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">60.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">show</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name boolean" style="color:hsl(29, 54%, 61%)">true</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glColor3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">hOpencv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">xDown</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">180.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">show</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name boolean" style="color:hsl(29, 54%, 61%)">true</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glColor3f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">mat4x4</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">1.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">translate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token operator" style="color:hsl(207, 82%, 66%)">-</span><span class="token plain">hOpencv</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> xDown</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        model </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">rotate</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">radians</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">240.f</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> glm</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">vec3</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">1</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token generic-function function" style="color:hsl(207, 82%, 66%)">show</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token generic-function generic class-name boolean" style="color:hsl(29, 54%, 61%)">true</span><span class="token generic-function generic class-name operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwSwapBuffers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)">// 双缓冲</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        </span><span class="token function" style="color:hsl(207, 82%, 66%)">glfwPollEvents</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token plain">this_thread</span><span class="token double-colon punctuation" style="color:hsl(220, 14%, 71%)">::</span><span class="token function" style="color:hsl(207, 82%, 66%)">sleep_for</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token number" style="color:hsl(29, 54%, 61%)">0.01</span><span class="token plain">s</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span></span><br></span></code></pre><div class="buttonGroup_6DOT"><span class="languageName_x0G5">cpp</span><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/HengXin666/HXLoLi/edit/main/docs/002-程序语言/001-C++/003-现代C++/008-现代OpenGL/003-三维模型的加载与相机控制/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>Heng_Xin_666</b> <!-- -->于 <b><time datetime="2025-08-05T06:37:24.000Z" itemprop="dateModified">2025年8月5日</time></b> <!-- -->更新</span></div></div></footer></article><div style="display:flex;justify-content:flex-end;margin-top:20px">请作者喝奶茶:<div class="icon-container" style="margin-left:10px"><img src="/HXLoLi//default-icons/alipay.svg" alt="Alipay Icon" class="icon"><img src="/HXLoLi//img/alipay_qr_code.png" alt="QR Code" class="qr-code"></div><div class="icon-container" style="margin-left:10px"><img src="/HXLoLi//default-icons/wechat.svg" alt="Alipay Icon" class="icon"><img src="/HXLoLi//img/wechat_qr_code.png" alt="QR Code" class="qr-code"></div></div><div style="display:flex;justify-content:flex-end"><span style="font-size:12px">本文遵循 <img src="/HXLoLi//default-icons/cc.svg" alt="CC" style="width:14px"> <span class="tailwind"><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="relative inline-block transition-all duration-300 text-fuchsia-400 hover:text-pink-700" target="_blank" rel="noopener noreferrer">CC 4.0 BY-SA<span class="absolute right-0 bottom-0 h-0.5 bg-purple-700 w-0 transition-all duration-500"></span><span class="absolute left-0 bottom-0 h-0.5 bg-purple-700 w-0"></span></a></span> 版权协议, 转载请标明出处</span></div><div><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/HXLoLi/docs/程序语言/C++/现代C++/现代OpenGL/初识OpenGL"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">初识OpenGL</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/HXLoLi/docs/程序语言/C++/现代C++/源码阅读/雅兰亭库/C++无宏反射研究"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">无宏反射</div></a></nav></div></div><div>Loading Comments...</div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar theme-doc-toc-desktop"><div class="tailwind"><div class="text-fuchsia-400" style="border-left:1px solid var(--ifm-toc-border-color)"><div class="ml-4 -mb-2" style="border-bottom:1.5px solid var(--ifm-toc-border-color)">0<!-- -->%</div></div></div><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一回顾三角形大作" class="table-of-contents__link toc-highlight">一、回顾三角形大作</a><ul><li><a href="#11-三角形大作存在的问题" class="table-of-contents__link toc-highlight">1.1 三角形大作存在的问题</a></li><li><a href="#12-动态存储" class="table-of-contents__link toc-highlight">1.2 动态存储</a></li><li><a href="#13-由点到面-从顶点数组到任意三角形面的数组" class="table-of-contents__link toc-highlight">1.3 由点到面: 从顶点数组到任意三角形面的数组</a></li><li><a href="#14-优化-不存储点坐标-存储点索引" class="table-of-contents__link toc-highlight">1.4 优化: 不存储点坐标, 存储点索引</a></li></ul></li><li><a href="#二obj-格式三维模型的加载与绘制" class="table-of-contents__link toc-highlight">二、OBJ 格式三维模型的加载与绘制</a><ul><li><a href="#21-obj-是什么" class="table-of-contents__link toc-highlight">2.1 OBJ 是什么?</a></li><li><a href="#22-认识-obj-文件格式-顶点数据" class="table-of-contents__link toc-highlight">2.2 认识 OBJ 文件格式: 顶点数据</a></li><li><a href="#23-顶点解析器" class="table-of-contents__link toc-highlight">2.3 顶点解析器</a></li><li><a href="#24-认识-obj-文件格式-面数据" class="table-of-contents__link toc-highlight">2.4 认识 OBJ 文件格式: 面数据</a></li><li><a href="#25-从-obj-文件格式-看多边形网格数据结构" class="table-of-contents__link toc-highlight">2.5 从 OBJ 文件格式, 看多边形网格数据结构</a></li><li><a href="#26-obj-格式的其他数据" class="table-of-contents__link toc-highlight">2.6 OBJ 格式的其他数据</a></li><li><a href="#27-任意多边形拆分成三角形的原理" class="table-of-contents__link toc-highlight">2.7 任意多边形拆分成三角形的原理</a></li><li><a href="#28-使用-glm-封装好的矢量代替自定义的点面类" class="table-of-contents__link toc-highlight">2.8 使用 glm 封装好的矢量代替自定义的点面类</a></li><li><a href="#29-glm-矢量库中的预定义类型一览" class="table-of-contents__link toc-highlight">2.9 glm 矢量库中的预定义类型一览</a></li></ul></li><li><a href="#三复习-opengl-中的坐标系和矩阵" class="table-of-contents__link toc-highlight">三、复习 OpenGL 中的坐标系和矩阵</a><ul><li><a href="#31-local-to-world又称-model-矩阵" class="table-of-contents__link toc-highlight">3.1 local to world(又称 Model 矩阵)</a></li><li><a href="#32-world-to-view又称-view-矩阵" class="table-of-contents__link toc-highlight">3.2 world to view(又称 View 矩阵)</a></li><li><a href="#33-view-to-clip又称-projection-矩阵" class="table-of-contents__link toc-highlight">3.3 view to clip(又称 Projection 矩阵)</a></li><li><a href="#34-opengl-进行裁剪clip操作" class="table-of-contents__link toc-highlight">3.4 OpenGL 进行裁剪(clip)操作</a></li><li><a href="#35-ndc-to-window" class="table-of-contents__link toc-highlight">3.5 NDC to window</a></li><li><a href="#36-总结-我们需要考虑的有-modelviewprojection-矩阵" class="table-of-contents__link toc-highlight">3.6 总结: 我们需要考虑的有 Model、View、Projection 矩阵</a></li><li><a href="#37-model-矩阵---物体局部坐标系到世界坐标系" class="table-of-contents__link toc-highlight">3.7 Model 矩阵 - 物体局部坐标系到世界坐标系</a></li><li><a href="#38-glmtranslate-这些函数的一个坑点" class="table-of-contents__link toc-highlight">3.8 <code>glm::translate</code> 这些函数的一个坑点</a></li><li><a href="#39-blender-直观演示" class="table-of-contents__link toc-highlight">3.9 Blender 直观演示</a></li><li><a href="#310-view-矩阵---使用-glmlookat-函数创建" class="table-of-contents__link toc-highlight">3.10 View 矩阵 - 使用 <code>glm::lookAt</code> 函数创建</a></li></ul></li><li><a href="#四投影矩阵与透视原理" class="table-of-contents__link toc-highlight">四、投影矩阵与透视原理</a><ul><li><a href="#41-projection-矩阵---调用-glmortho-函数创建正交投影" class="table-of-contents__link toc-highlight">4.1 Projection 矩阵 - 调用 <code>glm::ortho</code> 函数创建正交投影</a></li><li><a href="#42-正交投影的优缺点" class="table-of-contents__link toc-highlight">4.2 正交投影的优缺点</a></li><li><a href="#43-透视投影的规则-近大远小" class="table-of-contents__link toc-highlight">4.3 透视投影的规则: 近大远小</a></li><li><a href="#44-blender-演示---正交投影-vs-透视投影" class="table-of-contents__link toc-highlight">4.4 Blender 演示 - 正交投影 vs 透视投影</a></li><li><a href="#45-projection-矩阵---调用-glmfrustum-函数创建透视投影" class="table-of-contents__link toc-highlight">4.5 Projection 矩阵 - 调用 <code>glm::frustum</code> 函数创建透视投影</a></li><li><a href="#46-锥台形的可视空间为什么就能产生近大远小的透视效果" class="table-of-contents__link toc-highlight">4.6 锥台形的可视空间为什么就能产生&quot;近大远小&quot;的透视效果?</a></li><li><a href="#47-fovfield-of-view-视野角" class="table-of-contents__link toc-highlight">4.7 FoV(Field of View, 视野角)</a></li><li><a href="#48-横向视野角fovx与纵向视野角fovy" class="table-of-contents__link toc-highlight">4.8 横向视野角(FoVx)与纵向视野角(FoVy)</a></li><li><a href="#49-fov-的计算公式" class="table-of-contents__link toc-highlight">4.9 FoV 的计算公式</a></li><li><a href="#410-常见的-fovy-取值是-3040-度" class="table-of-contents__link toc-highlight">4.10 常见的 FoVy 取值是 30～40 度</a></li><li><a href="#411-projection-矩阵---调用-glmperspective-函数创建透视投影" class="table-of-contents__link toc-highlight">4.11 Projection 矩阵 - 调用 <code>glm::perspective</code> 函数创建透视投影</a></li><li><a href="#412-深度缓冲精度示意图" class="table-of-contents__link toc-highlight">4.12 深度缓冲精度示意图</a></li><li><a href="#413-z-fighting-实例图" class="table-of-contents__link toc-highlight">4.13 Z-fighting 实例图</a></li><li><a href="#414-矩阵实现透视投影的原理-除以-w-大法好" class="table-of-contents__link toc-highlight">4.14 矩阵实现透视投影的原理: 除以 w 大法好</a></li><li><a href="#415-焦距与fov" class="table-of-contents__link toc-highlight">4.15 焦距与FoV</a></li><li><a href="#416-变焦应用经典案例-希区柯克变焦" class="table-of-contents__link toc-highlight">4.16 变焦应用经典案例: 希区柯克变焦</a></li></ul></li><li><a href="#五矩阵与法线在固定管线中的使用" class="table-of-contents__link toc-highlight">五、矩阵与法线在固定管线中的使用</a><ul><li><a href="#51-第四节的代码实现" class="table-of-contents__link toc-highlight">5.1 第四节的代码实现</a></li><li><a href="#52-升级我们的数据结构---支持法线和纹理坐标暂时只用到法线" class="table-of-contents__link toc-highlight">5.2 升级我们的数据结构 - 支持法线和纹理坐标(暂时只用到法线)</a></li><li><a href="#53-什么是法线" class="table-of-contents__link toc-highlight">5.3 什么是法线</a></li><li><a href="#54-像素点亮度的计算就是基于法线的" class="table-of-contents__link toc-highlight">5.4 像素点亮度的计算就是基于法线的</a></li><li><a href="#55-知识点-顶点法线-vs-面法线" class="table-of-contents__link toc-highlight">5.5 知识点: 顶点法线 vs 面法线</a></li><li><a href="#56-obj-中的法线" class="table-of-contents__link toc-highlight">5.6 OBJ 中的法线</a></li><li><a href="#57-法线之殇-对于带有不均匀缩放的变换矩阵-直接与其相乘会得到错误结果" class="table-of-contents__link toc-highlight">5.7 法线之殇: 对于带有不均匀缩放的变换矩阵, 直接与其相乘会得到错误结果</a></li><li><a href="#58-启用一大坨-opengl-高级功能" class="table-of-contents__link toc-highlight">5.8 启用一大坨 OpenGL 高级功能</a></li><li><a href="#59-gl_blend-特性介绍" class="table-of-contents__link toc-highlight">5.9 GL_BLEND 特性介绍</a></li><li><a href="#510-glblendfunc-可以自定义混合公式" class="table-of-contents__link toc-highlight">5.10 glBlendFunc 可以自定义混合公式</a></li><li><a href="#511-msaa-的原理-不是非黑即白-而是在三角形边缘添加适当透明度" class="table-of-contents__link toc-highlight">5.11 MSAA 的原理: 不是非黑即白, 而是在三角形边缘添加适当透明度</a></li><li><a href="#512-ssaa-和-msaa-的区别" class="table-of-contents__link toc-highlight">5.12 SSAA 和 MSAA 的区别</a></li><li><a href="#513-运行" class="table-of-contents__link toc-highlight">5.13 运行</a></li><li><a href="#514-gl_multisample-的作用" class="table-of-contents__link toc-highlight">5.14 GL_MULTISAMPLE 的作用</a></li><li><a href="#515-glenable-系列函数" class="table-of-contents__link toc-highlight">5.15 glEnable 系列函数</a></li><li><a href="#516-对古代opengl中是mvp部分进行优化" class="table-of-contents__link toc-highlight">5.16 对古代OpenGL中是MVP部分进行优化</a></li><li><a href="#517-手动计算法线" class="table-of-contents__link toc-highlight">5.17 手动计算法线</a></li><li><a href="#518-法线方向的问题-我们有必要人为规定面的正方向" class="table-of-contents__link toc-highlight">5.18 法线方向的问题: 我们有必要人为规定面的&quot;正方向&quot;</a></li><li><a href="#519-面剔除功能-gl_cull_face" class="table-of-contents__link toc-highlight">5.19 面剔除功能: GL_CULL_FACE</a></li></ul></li><li><a href="#六法线进阶之平滑渲染" class="table-of-contents__link toc-highlight">六、法线进阶之平滑渲染</a><ul><li><a href="#61-古代-opengl-启用平滑渲染模式" class="table-of-contents__link toc-highlight">6.1 古代 OpenGL 启用平滑渲染模式</a></li><li><a href="#62-平直渲染gl_flatvs-平滑渲染gl_smooth" class="table-of-contents__link toc-highlight">6.2 平直渲染(GL_FLAT)vs 平滑渲染(GL_SMOOTH)</a></li><li><a href="#63-mv-矩阵含有缩放时-需要开启-gl_normalize" class="table-of-contents__link toc-highlight">6.3 MV 矩阵含有缩放时, 需要开启 GL_NORMALIZE</a></li></ul></li><li><a href="#七glfw-鼠标事件回调实现相机角度控制" class="table-of-contents__link toc-highlight">七、GLFW 鼠标事件回调实现相机角度控制</a><ul><li><a href="#71-设置鼠标点击回调函数" class="table-of-contents__link toc-highlight">7.1 设置鼠标点击回调函数</a></li><li><a href="#72-glfw-是在什么地方调用回调" class="table-of-contents__link toc-highlight">7.2 GLFW 是在什么地方调用回调?</a></li><li><a href="#73-介绍摄像头控制的五种模式" class="table-of-contents__link toc-highlight">7.3 介绍摄像头控制的五种模式</a></li></ul></li><li><a href="#八回家作业" class="table-of-contents__link toc-highlight">八、回家作业</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/HengXin666/HXLoLi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item">
                <a href="https://hengxin666.github.io/cppreference-zh-cn/" target="_blank" rel="noreferrer noopener" style="display: flex; align-items: center; gap: 3px; text-decoration: none; color: inherit; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;">
                  <img src="/HXLoLi/icons/ISO_C++_Logo.svg" alt="cppreference" width="36" height="36" style="flex-shrink: 0;">
                  <span style="font-size: 16px; font-weight: 600; position: relative; top: -1.75px;">cppreference</span>
                </a>
              </li><li class="footer__item">
                <a href="https://docusaurus.io" target="_blank" rel="noreferrer noopener">
                  <img src="/HXLoLi/default-img/buildwith.png" alt="build with docusaurus" width="120" height="50">
                </a>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">版权所有 © 2025 - 2025 HXLoLi, Inc. 由 Docusaurus 构建.</div></div></div></footer></div>
</body>
</html>